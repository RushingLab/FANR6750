<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 4: Completely randomized ANOVA • FANR6750</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 4: Completely randomized ANOVA">
<meta property="og:description" content="FANR6750">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FANR6750</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2024.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/01_intro_to_stats/01_intro_to_stats.html">Lecture 1: Introduction to statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/02_intro_to_lm/02_intro_to_lm.html">Lecture 2: Introduction to linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/03_inference/03_inference.html">Lecture 3: Principles of inference</a>
    </li>
    <li>
      <a href="../articles/lectures/04_t-test/04_t-test.html">Lecture 4: Linear models part 1: categorical predictor w/ 2 levels</a>
    </li>
    <li>
      <a href="../articles/lectures/05_nht/05_nht.html">Lecture 5: Null hypothesis significance testings</a>
    </li>
    <li>
      <a href="../articles/lectures/06_power/06_power.html">Lecture 6: Statistical power</a>
    </li>
    <li>
      <a href="../articles/lectures/07_anova/07_anova.html">Lecture 7: Linear models part 2: categorical predictor &gt; 2 levels</a>
    </li>
    <li>
      <a href="../articles/lectures/08_mult_comp/08_mult_comp.html">Lecture 8: Multiple Comparisons</a>
    </li>
    <li>
      <a href="../articles/lectures/09_regression/09_regression.html">Lecture 9: Multiple Regression</a>
    </li>
    <li>
      <a href="../articles/lectures/10_interactions/10_interactions.html">Lecture 10: Interactions</a>
    </li>
    <li>
      <a href="../articles/lectures/11_assumptions/11_assumptions.html">Lecture 11: Evaluating assumptions</a>
    </li>
    <li>
      <a href="../articles/lectures/12_model_selection/12_model_selection.html">Lecture 12: Model selection</a>
    </li>
    <li>
      <a href="../articles/lectures/13_random_effects/13_random_effects.html">Lecture 13: Random effects</a>
    </li>
    <li>
      <a href="../articles/lectures/14_nested/14_nested.html">Lecture 14: Nested designs</a>
    </li>
    <li>
      <a href="../articles/lectures/15_split-plot/15_split-plot.html">Lecture 15: Split-plot designs</a>
    </li>
    <li>
      <a href="../articles/lectures/16_repeated_measures/16_repeated_measures.html">Lecture 16: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lectures/17_glm/17_glm.html">Lecture 17: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/18_logistic_regression/18_logistic_regression.html">Lecture 18: Logistic regression</a>
    </li>
    <li>
      <a href="../articles/lectures/19_poisson_regression/19_poisson_regression.html">Lecture 19: Poisson regression</a>
    </li>
    <li>
      <a href="../articles/lectures/20_zero_inflation/20_zero_inflation.html">Lecture 20: Zero-inflated regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab01_intro_to_R.html">Lab 1: Introduction to R</a>
    </li>
    <li>
      <a href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to projects and RMarkdown</a>
    </li>
    <li>
      <a href="../articles/lab03_t-tests.html">Lab 3: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab04_ANOVA.html">Lab 4: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab05_multiple_regression.html">Lab 5: Multiple Regression</a>
    </li>
    <li>
      <a href="../articles/lab06_interactions.html">Lab 6: Interactions</a>
    </li>
    <li>
      <a href="../articles/lab07_linear_model_assumptions.html">Lab 7: Evaluating assumptions</a>
    </li>
    <li>
      <a href="../articles/lab08_model_selection.html">Lab 8: Model selection</a>
    </li>
    <li>
      <a href="../articles/lab09_nested.html">Lab 9: Nested designs</a>
    </li>
    <li>
      <a href="../articles/lab10_split_plot.html">Lab 10: Split-plot designs</a>
    </li>
    <li>
      <a href="../articles/lab11_repeated_measures.html">Lab 11: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lab12_glm_lr.html">Lab 12: Logistic regression</a>
    </li>
    <li>
      <a href="../articles/lab13_glm_pr.html">Lab 13: Poisson regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework.html">Assignment instructions</a>
    </li>
    <li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/RMarkdown.html">R Markdown reference</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Creating publication-quality graphics</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="lab04_ANOVA_files/kePrint-0.0.1/kePrint.js"></script><link href="lab04_ANOVA_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 4: Completely randomized ANOVA</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2024</h4>
            
      
      
      <div class="hidden name"><code>lab04_ANOVA.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="lab-3">Lab 3<a class="anchor" aria-label="anchor" href="#lab-3"></a>
</h3>
<ol style="list-style-type: decimal">
<li>t-tests</li>
</ol>
<ul>
<li><p>One sample t-tests</p></li>
<li><p>Two sample t-tests</p></li>
<li><p>Samples vs tails</p></li>
<li><p>Paired t-tests</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="todays-topics">Today’s topics<a class="anchor" aria-label="anchor" href="#todays-topics"></a>
</h3>
<ol style="list-style-type: decimal">
<li>One way ANOVA as a linear model</li>
</ol>
<ul>
<li><p>Using lm()</p></li>
<li><p>Using aov()</p></li>
<li><p>Performing an ANOVA by hand</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p>Plotting group means and CI’s</p></li>
<li><p>Multiple comparisons</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="one-way-anova-as-a-linear-model">One-way ANOVA as a linear model<a class="anchor" aria-label="anchor" href="#one-way-anova-as-a-linear-model"></a>
</h2>
<div class="section level5">
<h5 id="scenario">Scenario<a class="anchor" aria-label="anchor" href="#scenario"></a>
</h5>
<ul>
<li><p>We have independent samples from <span class="math inline">\(a
&gt; 2\)</span> groups</p></li>
<li><p>We assume a common variance</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="questions">Questions<a class="anchor" aria-label="anchor" href="#questions"></a>
</h5>
<ul>
<li><p>Do the means differ and by how much (what are the effect
sizes?)</p></li>
<li><p>Which means differ from each other?</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="null-hypothesis">Null hypothesis<a class="anchor" aria-label="anchor" href="#null-hypothesis"></a>
</h5>
<ul>
<li><span class="math inline">\(H_0 : \mu_1 = \mu_2 = \mu_3 = . . . =
\mu_a\)</span></li>
</ul>
<p>OR</p>
<ul>
<li><span class="math inline">\(H_0 : \alpha_1 = \alpha_2 = \alpha_3 = .
. . = \alpha_a = 0\)</span></li>
</ul>
</div>
<div class="section level5">
<h5 id="alternative-hypothesis">Alternative hypothesis<a class="anchor" aria-label="anchor" href="#alternative-hypothesis"></a>
</h5>
<ul>
<li><span class="math inline">\(H_A: \mu_i \ne \mu_j \space\text{for
some i, j in (1, . . ., a)}\)</span></li>
</ul>
</div>
<div class="section level5">
<h5 id="formulation-as-a-linear-model">Formulation as a linear model<a class="anchor" aria-label="anchor" href="#formulation-as-a-linear-model"></a>
</h5>
<p>Just as we have seen in the last lab, many of the analyses that we
will perform this semester can be thought of in multiple ways. A one-way
ANOVA can be formulated as a linear model:</p>
<p><span class="math display">\[
y_{ij} = \mu + \alpha_i + \epsilon_{ij} \ \ \ \ \ \text{where} \ \ \ \ \
\epsilon_{ij} \sim \text{N}(0,\sigma)
\]</span></p>
<p><strong>Can you define each term in the context of the data? Why did
we need to add additional sub-scripting to the observation and residual
terms?</strong></p>
</div>
<div class="section level3">
<h3 id="exercise-1">Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<p>The dataset below comes from a pilot study implemented by the US
Forest Service. The service is interested in purchasing a number of
chainsaws to use for various projects and fieldwork. Due to safety
concerns, the service is hoping to select the chainsaw brand (A, B, C,
or D) which has the lowest average kickback angle. Kickback, which
refers to the sudden upward motion of the saw’s guide bar when the saw
strikes a hard object, is one of the leading causes of injuries during
chainsaw work. While the service would like to prioritize safety, their
secondary objective is to find a reasonably priced brand. The brands
range in price (D,B,A,C) with Brand D being the most expensive.</p>
<ol style="list-style-type: decimal">
<li>Load the sawdata dataset and examine the data</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sawdata"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Chainsaw  A  B  C  D</span></span>
<span><span class="co">#&gt; 1        1 42 38 52 29</span></span>
<span><span class="co">#&gt; 2        2 36 50 54 35</span></span>
<span><span class="co">#&gt; 3        3 33 44 48 31</span></span>
<span><span class="co">#&gt; 4        4 39 37 49 36</span></span>
<span><span class="co">#&gt; 5        5 43 47 54 32</span></span></code></pre></div>
<p>You may notice that something seems different about this dataset than
the previous ones we have looked at over the last few weeks. This is
because the data are in what is called ‘wide format’. This means that
each level of the grouping variable (in this case chainsaw brand) has
gotten its own column in the dataframe. While wide format is often
convenient for reports because it allows you to more easily see trends
in a table, long format is more useful for succinctly storing data and
for use in most analyses.</p>
<ol start="2" style="list-style-type: decimal">
<li>Convert the dataframe from wide format to long format<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="va">sawdata</span> <span class="op">&lt;-</span> <span class="va">sawdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span><span class="op">)</span>,</span>
<span>                         names_to<span class="op">=</span> <span class="st">'Brand'</span>,</span>
<span>                         values_to<span class="op">=</span> <span class="st">'angle'</span><span class="op">)</span></span>
<span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Visualize the data</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sawdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Brand</span>, y <span class="op">=</span> <span class="va">angle</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span><span class="st">"Kickback angle"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab04_ANOVA_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="two-anova-functions-in-r-aov-and-lm">Two ANOVA functions: in <code>R</code>: <code>aov()</code> and
<code>lm()</code><a class="anchor" aria-label="anchor" href="#two-anova-functions-in-r-aov-and-lm"></a>
</h3>
<ul>
<li><p><code>R</code> has 2 common functions for doing ANOVA:
<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> and <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code></p></li>
<li><p>We will use both in this class</p></li>
</ul>
<div class="section level4">
<h4 id="crude-characterization">Crude characterization<a class="anchor" aria-label="anchor" href="#crude-characterization"></a>
</h4>
<table class="table table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
aov()
</th>
<th style="text-align:center;">
lm()
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Emphasis
</td>
<td style="text-align:center;">
ANOVA tables
</td>
<td style="text-align:center;">
Linear models
</td>
</tr>
<tr>
<td style="text-align:center;">
Typical use
</td>
<td style="text-align:center;">
Designed experiments
</td>
<td style="text-align:center;">
Regression analysis
</td>
</tr>
<tr>
<td style="text-align:center;">
Multiple error strata?
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
No
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="using-lm">Using <code>lm()</code><a class="anchor" aria-label="anchor" href="#using-lm"></a>
</h3>
<ol start="4" style="list-style-type: decimal">
<li>Perform the analysis using the lm() function</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">angle</span><span class="op">~</span> <span class="va">Brand</span>, data<span class="op">=</span> <span class="va">sawdata</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = angle ~ Brand, data = sawdata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt;   -6.2   -2.8    0.5    2.8    6.8 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    38.60       1.80   21.39  3.4e-13 ***</span></span>
<span><span class="co">#&gt; BrandB          4.60       2.55    1.80  0.09027 .  </span></span>
<span><span class="co">#&gt; BrandC         12.80       2.55    5.02  0.00013 ***</span></span>
<span><span class="co">#&gt; BrandD         -6.00       2.55   -2.35  0.03184 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.03 on 16 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.784,  Adjusted R-squared:  0.743 </span></span>
<span><span class="co">#&gt; F-statistic: 19.3 on 3 and 16 DF,  p-value: 1.45e-05</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt;    (Intercept) BrandB BrandC BrandD</span></span>
<span><span class="co">#&gt; 1            1      0      0      0</span></span>
<span><span class="co">#&gt; 2            1      1      0      0</span></span>
<span><span class="co">#&gt; 3            1      0      1      0</span></span>
<span><span class="co">#&gt; 4            1      0      0      1</span></span>
<span><span class="co">#&gt; 5            1      0      0      0</span></span>
<span><span class="co">#&gt; 6            1      1      0      0</span></span>
<span><span class="co">#&gt; 7            1      0      1      0</span></span>
<span><span class="co">#&gt; 8            1      0      0      1</span></span>
<span><span class="co">#&gt; 9            1      0      0      0</span></span>
<span><span class="co">#&gt; 10           1      1      0      0</span></span>
<span><span class="co">#&gt; 11           1      0      1      0</span></span>
<span><span class="co">#&gt; 12           1      0      0      1</span></span>
<span><span class="co">#&gt; 13           1      0      0      0</span></span>
<span><span class="co">#&gt; 14           1      1      0      0</span></span>
<span><span class="co">#&gt; 15           1      0      1      0</span></span>
<span><span class="co">#&gt; 16           1      0      0      1</span></span>
<span><span class="co">#&gt; 17           1      0      0      0</span></span>
<span><span class="co">#&gt; 18           1      1      0      0</span></span>
<span><span class="co">#&gt; 19           1      0      1      0</span></span>
<span><span class="co">#&gt; 20           1      0      0      1</span></span>
<span><span class="co">#&gt; attr(,"assign")</span></span>
<span><span class="co">#&gt; [1] 0 1 1 1</span></span>
<span><span class="co">#&gt; attr(,"contrasts")</span></span>
<span><span class="co">#&gt; attr(,"contrasts")$Brand</span></span>
<span><span class="co">#&gt; [1] "contr.treatment"</span></span></code></pre></div>
<p><strong>Can you interpret each estimate? Why are only the last three
brands shown (what happened to Brand A)? What does each p-value
represent and what hypothesis are they testing?</strong></p>
</div>
<div class="section level3">
<h3 id="using-aov">Using <code>aov()</code><a class="anchor" aria-label="anchor" href="#using-aov"></a>
</h3>
<ol start="5" style="list-style-type: decimal">
<li>Perform the analysis using the aov() function</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aov1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">angle</span> <span class="op">~</span> <span class="va">Brand</span>, data <span class="op">=</span> <span class="va">sawdata</span><span class="op">)</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>View the ANOVA table</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Brand        3    943   314.2    19.3 1.4e-05 ***</span></span>
<span><span class="co">#&gt; Residuals   16    260    16.3                    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p><strong>What can we conclude from this ANOVA table? Does there appear
to be more or less information (or just different) provided here than
when we used the lm() function?</strong></p>
<p>The default output from <code>summary</code> is fine for viewing in
the console but what if you want to include the ANOVA table in a report
or paper? You could manually create a table and copy/paste the values,
but that’s a pain. Luckily, there is a handy package called
<code>broom</code> that turns the output from many model functions into
cleaned-up data frames<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   term         df sumsq meansq statistic    p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Brand         3  943.  314.       19.3  0.000<span style="text-decoration: underline;">014</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Residuals    16  260.   16.3      <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>In R Markdown, we can even include that data frame as a nicely
formatted table directly in the knitted document:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aov_df</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>knitr.kable.NA <span class="op">=</span> <span class="st">''</span><span class="op">)</span> <span class="co"># don't print NA's in table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">aov_df</span>, </span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Source"</span>, <span class="st">"df"</span>, <span class="st">"SS"</span>, <span class="st">"MS"</span>, <span class="st">"F"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>      align <span class="op">=</span> <span class="st">'c'</span>, format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> </span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:center;">
Source
</th>
<th style="text-align:center;">
df
</th>
<th style="text-align:center;">
SS
</th>
<th style="text-align:center;">
MS
</th>
<th style="text-align:center;">
F
</th>
<th style="text-align:center;">
p
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Brand
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
942.5
</td>
<td style="text-align:center;">
314.18
</td>
<td style="text-align:center;">
19.3
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Residuals
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
260.4
</td>
<td style="text-align:center;">
16.27
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
<div class="section level5">
<h5 id="getting-estimates-of-group-means-mus-and-ses">Getting estimates of group means ( <span class="math inline">\(\mu\)</span>’s) and SE’s<a class="anchor" aria-label="anchor" href="#getting-estimates-of-group-means-mus-and-ses"></a>
</h5>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html" class="external-link">model.tables</a></span><span class="op">(</span><span class="va">aov1</span>, type <span class="op">=</span> <span class="st">"means"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tables of means</span></span>
<span><span class="co">#&gt; Grand mean</span></span>
<span><span class="co">#&gt;       </span></span>
<span><span class="co">#&gt; 41.45 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Brand </span></span>
<span><span class="co">#&gt; Brand</span></span>
<span><span class="co">#&gt;    A    B    C    D </span></span>
<span><span class="co">#&gt; 38.6 43.2 51.4 32.6 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standard errors for differences of means</span></span>
<span><span class="co">#&gt;         Brand</span></span>
<span><span class="co">#&gt;         2.551</span></span>
<span><span class="co">#&gt; replic.     5</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="getting-estimates-of-effect-sizes-alphas-and-ses">Getting estimates of effect sizes ( <span class="math inline">\(\alpha\)</span>’s) and SE’s<a class="anchor" aria-label="anchor" href="#getting-estimates-of-effect-sizes-alphas-and-ses"></a>
</h5>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html" class="external-link">model.tables</a></span><span class="op">(</span><span class="va">aov1</span>, type <span class="op">=</span> <span class="st">"effects"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tables of effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Brand </span></span>
<span><span class="co">#&gt; Brand</span></span>
<span><span class="co">#&gt;     A     B     C     D </span></span>
<span><span class="co">#&gt; -2.85  1.75  9.95 -8.85 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standard errors of effects</span></span>
<span><span class="co">#&gt;         Brand</span></span>
<span><span class="co">#&gt;         1.804</span></span>
<span><span class="co">#&gt; replic.     5</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="constructing-an-anova-table-by-hand">Constructing an ANOVA table by hand<a class="anchor" aria-label="anchor" href="#constructing-an-anova-table-by-hand"></a>
</h3>
<p>Just as we did in the last lab, we will see below how <code>R</code>
is actually doing the ANOVA and we’ll get practice constructing an ANOVA
table by hand.</p>
<div class="section level5">
<h5 id="grand-mean">Grand mean<a class="anchor" aria-label="anchor" href="#grand-mean"></a>
</h5>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ybar.</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 41.45</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="group-means">Group means<a class="anchor" aria-label="anchor" href="#group-means"></a>
</h5>
<p>As with most things in <code>R</code>, there are several ways to
calculate the group means. First, find the group means, the hard
way:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span><span class="op">[</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">]</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span><span class="op">[</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span> <span class="op">==</span> <span class="st">"B"</span><span class="op">]</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span><span class="op">[</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span> <span class="op">==</span> <span class="st">"C"</span><span class="op">]</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span><span class="op">[</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span> <span class="op">==</span> <span class="st">"D"</span><span class="op">]</span></span>
<span></span>
<span><span class="op">(</span><span class="va">ybar.i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">C</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 38.6 43.2 51.4 32.6</span></span></code></pre></div>
<p>Better yet, use <code>tapply</code> to find the group means (the base
<code>R</code> way):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ybar.i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span>, INDEX <span class="op">=</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    A    B    C    D </span></span>
<span><span class="co">#&gt; 38.6 43.2 51.4 32.6</span></span></code></pre></div>
<p>Finally, find the group means, the tidyverse way:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">ybar.i</span> <span class="op">&lt;-</span> <span class="va">sawdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Brand</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">angle</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   Brand    mu</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A      38.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B      43.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> C      51.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> D      32.6</span></span></code></pre></div>
<hr>
<p>Although each of these methods does what we want - return the mean
kickback angle for each group - note that they do not return the same
type of object.</p>
<p>Use the <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class()</a></code> function to see what type of object each
one returns.</p>
<p>When might the output from each method be useful?</p>
<hr>
</div>
<div class="section level5">
<h5 id="sum-of-squares">Sum of squares<a class="anchor" aria-label="anchor" href="#sum-of-squares"></a>
</h5>
<p>Sums of squares among</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of saw brands</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Number of measurements of each brand (note, this assumes balanced design)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">)</span><span class="op">/</span><span class="va">a</span></span>
<span></span>
<span><span class="va">SSa</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">ybar.i</span><span class="op">$</span><span class="va">mu</span> <span class="op">-</span> <span class="va">ybar.</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">SSa</span></span>
<span><span class="co">#&gt; [1] 942.5</span></span></code></pre></div>
<p>Sums of squares within<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># individual saw data</span></span>
<span><span class="va">y.ij</span> <span class="op">&lt;-</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span></span>
<span></span>
<span><span class="va">SSw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">y.ij</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ybar.i</span><span class="op">$</span><span class="va">mu</span>, times <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">SSw</span></span>
<span><span class="co">#&gt; [1] 260.4</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="means-squares">Means squares<a class="anchor" aria-label="anchor" href="#means-squares"></a>
</h5>
<p>Mean squares among</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="op">(</span><span class="va">MSa</span> <span class="op">&lt;-</span> <span class="va">SSa</span> <span class="op">/</span> <span class="va">df1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 314.2</span></span></code></pre></div>
<p>Mean squares within</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">MSw</span> <span class="op">&lt;-</span> <span class="va">SSw</span> <span class="op">/</span> <span class="va">df2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 16.27</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="f-statistic">
<em>F</em>-statistic<a class="anchor" aria-label="anchor" href="#f-statistic"></a>
</h5>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">F.stat</span> <span class="op">&lt;-</span> <span class="va">MSa</span> <span class="op">/</span> <span class="va">MSw</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 19.3</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="critical-values-and-p-values">Critical values and <em>p</em>-values<a class="anchor" aria-label="anchor" href="#critical-values-and-p-values"></a>
</h5>
<p>Recall that in ANOVA, we only consider the upper tail of the
<em>F</em>-distribution.</p>
<p>Critical value:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="op">(</span><span class="va">F.crit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">qf</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span>, <span class="va">df1</span>, <span class="va">df2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.239</span></span></code></pre></div>
<p><em>p</em>-value</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">F.stat</span>, <span class="va">df1</span>, <span class="va">df2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.446e-05</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="plotting-group-means-and-confidence-intervals">Plotting group means and confidence intervals<a class="anchor" aria-label="anchor" href="#plotting-group-means-and-confidence-intervals"></a>
</h3>
<p>Although we have performed the ANOVA in multiple ways and can
conclude that there is at least one difference in means between the
chainsaw brands, we still have a few tasks to perform. The first is to
plot the data in a meaningful way. With this type of data there are at
least two ways we could display the results. An example of one is below;
we’ll practice the second one in the homework assignment.</p>
<p>In an ANOVA context, confidence intervals can be constructed using
the equation:</p>
<p><span class="math display">\[
CI = Point\: estimate \pm t_{\alpha/2,a(n-1)}\times SE
\]</span></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the SE</span></span>
<span><span class="va">mean.SE</span> <span class="op">&lt;-</span> <span class="fl">2.551</span> <span class="co"># hard coded from model.tables()</span></span>
<span></span>
<span><span class="co"># OR</span></span>
<span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html" class="external-link">model.tables</a></span><span class="op">(</span><span class="va">aov1</span>, type <span class="op">=</span> <span class="st">"means"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mean.SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">se</span><span class="op">)</span> <span class="co"># more explicit</span></span>
<span><span class="va">mean.SE</span></span>
<span><span class="co">#&gt; [1] 2.551</span></span>
<span></span>
<span><span class="co"># Compute confidence intervals</span></span>
<span><span class="va">tc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fl">0.975</span>, <span class="va">a</span><span class="op">*</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lowerCI</span> <span class="op">&lt;-</span> <span class="va">ybar.i</span><span class="op">$</span><span class="va">mu</span> <span class="op">-</span> <span class="va">tc</span><span class="op">*</span><span class="va">mean.SE</span></span>
<span><span class="va">upperCI</span> <span class="op">&lt;-</span> <span class="va">ybar.i</span><span class="op">$</span><span class="va">mu</span> <span class="op">+</span> <span class="va">tc</span><span class="op">*</span><span class="va">mean.SE</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ybar.i</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Brand</span>, y <span class="op">=</span> <span class="va">mu</span>, fill <span class="op">=</span> <span class="va">Brand</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lowerCI</span>, ymax <span class="op">=</span> <span class="va">upperCI</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span><span class="st">"Chainsaw kickback angle"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="lab04_ANOVA_files/figure-html/unnamed-chunk-25-1.png" alt="Figure 1: Mean kickback angle from four chainsaw brands with 95% CI" width="480"><p class="caption">
Figure 1: Mean kickback angle from four chainsaw brands with 95% CI
</p>
</div>
</div>
<div class="section level3">
<h3 id="multiple-comparisons">Multiple comparisons<a class="anchor" aria-label="anchor" href="#multiple-comparisons"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Tukey multiple comparisons of means</span></span>
<span><span class="co">#&gt;     95% family-wise confidence level</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fit: aov(formula = angle ~ Brand, data = sawdata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Brand</span></span>
<span><span class="co">#&gt;      diff      lwr   upr  p adj</span></span>
<span><span class="co">#&gt; B-A   4.6  -2.6998  11.9 0.3079</span></span>
<span><span class="co">#&gt; C-A  12.8   5.5002  20.1 0.0007</span></span>
<span><span class="co">#&gt; D-A  -6.0 -13.2998   1.3 0.1276</span></span>
<span><span class="co">#&gt; C-B   8.2   0.9002  15.5 0.0251</span></span>
<span><span class="co">#&gt; D-B -10.6 -17.8998  -3.3 0.0037</span></span>
<span><span class="co">#&gt; D-C -18.8 -26.0998 -11.5 0.0000</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab04_ANOVA_files/figure-html/unnamed-chunk-27-1.png" width="480" style="display: block; margin: auto;"><strong>Which brands were significantly different from one another? How
would you answer the original question at the start of this
exercise?</strong></p>
<p><br></p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h2>
<p>A biologist wants to compare the growth of four different tree
species she is considering for use in reforestation efforts. All 32
seedlings of the four species are planted at the same time in a large
plot. Heights in meters are recorded after several years.</p>
<p>Create an R Markdown file to do the following:</p>
<ol style="list-style-type: decimal">
<li>Create an <code>R</code> chunk to load the data using:</li>
</ol>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"treedata"</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Create a header called “Hypotheses” and under this header,
indicate, in plain English, what the null and alternative hypotheses
are. Also use R Markdown’s equation features to write these hypotheses
using mathematical notation (1 pt).</p></li>
<li><p>Create a header called “ANOVA by hand”. Under this header,
perform an ANOVA analysis (degrees of freedom, sums-of-squares,
mean-squares, and <em>F</em>-value) without using <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>.
Compute either the critical value of <em>F</em>, or the
<em>p</em>-value. Be sure to <strong>annotate your code</strong> (1
pt).</p></li>
<li><p>Create a header called “ANOVA in R”. Under this header, perform
an ANOVA analysis on the data using the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function and
then again using the <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> function (1 pt).</p></li>
<li>
<p>Under a subheader called “ANOVA results” (2 pt):</p>
<ul>
<li><p>indicate whether or not the null hypothesis can be rejected at
the <span class="math inline">\(\alpha = 0.05\)</span> level</p></li>
<li><p>include a well-formatted ANOVA table using the
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">broom::tidy()</a></code> function</p></li>
<li><p>create a barplot showing the effect sizes and 95% confidence
intervals around them</p></li>
</ul>
</li>
<li><p>Create a header called “Which means are different?”. Use Tukey’s
HSD test to determine which pairs of means differ at the <span class="math inline">\(\alpha = 0.05\)</span> level. Include a few
sentences indicating which pairs are different. If there is an
inconsistency between the initial ANOVA results and the post-hoc
comparisons, explain why that might be the case (1 pt).</p></li>
</ol>
<p>A few things to remember when creating the assignment:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Title the document: <code>title: "Homework 2"</code></p></li>
<li><p>Be sure to include your first and last name in the
<code>author</code> section</p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so we can see both your code and the output</p></li>
<li><p>Please upload both the <code>html</code> and <code>.Rmd</code>
files when you submit your assignment</p></li>
<li><p>See the R Markdown reference sheet for help with creating
<code>R</code> chunks, equations, tables, etc.</p></li>
</ul>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>In this code chunk, we introduce the idea of pipes in R.
A pipe (shown with %&gt;%) is a way of stacking multiple functions on
top of each other in an easy to read way. Many packages (including
tidyr) use pipes instead of having functions nested inside of each
other. While pipes are generally considered to have multiple advantages
related to their readability as well as modular structure, there are
ways to perform any of these steps without their use.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Notice the use of the double colon in the code chunk
below. This is used in <code>R</code> to explicitly link a function to
the package from where it came. Because there is an ever expanding list
of available packages and many of them contain functions that have the
same names but perform different tasks, it is necessary to tell
<code>R</code> which particular function you are trying to use. If we
did not specify the package using the double colon operator,
<code>R</code> would use the function from whatever was the most
recently loaded package in your library that contained that function
name.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Notice the use of the times= argument. How do we decide
whether to use times= or each=? In this case, we need to look at the
order of the data in the dataframe. Because of how the data is ordered,
we are interested in taking the entire mu vector and repeating it 5
times. If the data were ordered such that all the Brand A observations
were first etc. then we would have taken each element in the mu vector
and repeated it each= 5.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
