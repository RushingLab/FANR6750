<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 4: Linear models with one categorical predictor-- t-tests • FANR6750</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.0/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lab 4: Linear models with one categorical predictor-- t-tests">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FANR6750</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fa-home"></span></a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../articles/syllabus.html"><span class="fa fas fa-book"></span> Syllabus</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/schedule.html"><span class="fa fas fa-calendar"></span> Schedule</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lectures" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-file-pdf-o"></span> Lectures</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lectures">
<li><a class="dropdown-item" href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/01_intro_to_stats/01_intro_to_stats.html">Lecture 1: Introduction to statistics</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/02_intro_to_lm/02_intro_to_lm.html">Lecture 2: Introduction to linear models</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/03_inference/03_inference.html">Lecture 3: Principles of inference</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/04_principles_of_expdesign/04_expdesign.html">Lecture 4: Principles of experimental design</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/05_t-test/05_t-test.html">Lecture 5: Linear models part 1: categorical predictor w/ 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/06_nht/06_nht.html">Lecture 6: Null hypothesis significance testings</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/07_power/07_power.html">Lecture 7: Statistical power</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/08_anova/08_anova.html">Lecture 8: Linear models part 2: categorical predictor &gt; 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/09_mult_comp/09_mult_comp.html">Lecture 9: Multiple Comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/10_regression/10_regression.html">Lecture 10: Multiple Regression</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-labs" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Labs</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-labs">
<li><a class="dropdown-item" href="../articles/lab01_intro_to_R.html">Lab 1: Introduction to R</a></li>
    <li><a class="dropdown-item" href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to projects and RMarkdown</a></li>
    <li><a class="dropdown-item" href="../articles/lab03_inference.html">Lab 3: Using R to explore sampling error</a></li>
    <li><a class="dropdown-item" href="../articles/lab04_t-tests.html">Lab 4: t-tests</a></li>
    <li><a class="dropdown-item" href="../articles/lab05_anova.html">Lab 5: ANOVA</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-references" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-pencil-square-o"></span> References</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-references">
<li><a class="dropdown-item" href="../articles/homework.html">Assignment instructions</a></li>
    <li><a class="dropdown-item" href="../articles/projects_and_directories.html">Projects and directories</a></li>
    <li><a class="dropdown-item" href="../articles/RMarkdown.html">R Markdown reference</a></li>
    <li><a class="dropdown-item" href="../articles/graphics.html">Creating publication-quality graphics</a></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Lab 4: Linear models with one categorical predictor-- t-tests</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2025</h4>
            
      

      <div class="d-none name"><code>lab04_t-tests.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="lab-3">Lab 3<a class="anchor" aria-label="anchor" href="#lab-3"></a>
</h3>
<ul>
<li><p>Graphics</p></li>
<li><p>Sampling error</p></li>
<li><p>Confidence intervals</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="todays-topics">Today’s topics<a class="anchor" aria-label="anchor" href="#todays-topics"></a>
</h3>
<ul>
<li><p>Introduction</p></li>
<li>
<p>Linear models with one categorical predictor: t-tests</p>
<ul>
<li><p>One sample</p></li>
<li><p>Samples vs tails</p></li>
<li><p>Two sample</p></li>
<li><p>Paired</p></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Today we will discuss a range of scenarios which broadly fall under
the category of <strong>t-tests</strong>. These will include:</p>
<ul>
<li><p>when a sample mean is being compared to a particular value
(<strong>one-sample t-test</strong>)</p></li>
<li><p>when two sample means are being compared to each other and the
observations between samples are independent (<strong>two-sample
t-test</strong>)</p></li>
<li><p>when two sample means are being compared to each other and the
observations between samples are paired (<strong>paired
t-test</strong>)</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="scenario-1-one-sample-t-tests">Scenario 1: One sample t-tests<a class="anchor" aria-label="anchor" href="#scenario-1-one-sample-t-tests"></a>
</h2>
<p>First, we will talk about the scenario in which we only have one
sample of data and we are interested in its mean.</p>
<ul>
<li><p><strong>Question</strong>: Is the average height of students at
UGA equal to 65 inches?</p></li>
<li><p><strong>Problem</strong>: We don’t know the true population mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\mu_1</annotation></semantics></math>).
All we have is the sample mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mn>1</mn></msub><annotation encoding="application/x-tex">\bar{y}_1</annotation></semantics></math>).</p></li>
<li>
<p>The relevant hypotheses are:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>=</mo><mn>65</mn></mrow><annotation encoding="application/x-tex">H_0 : \mu_1 = 65</annotation></semantics></math></p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>≠</mo><mn>65</mn></mrow><annotation encoding="application/x-tex">H_A : \mu_1 \neq 65</annotation></semantics></math></p></li>
</ul>
</li>
</ul>
<p>Suppose we have collected a random sample of 100 students. Below is a
plot of the distribution of their heights. In this case the sample mean
is 61 inches. From the plot below, it would be difficult to conclude one
way or another whether the population mean is equal to 65.</p>
<p><img src="lab04_t-tests_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
<p><br></p>
<p><br></p>
<p>We can think about this problem in a few different ways. Below we
will see how to approach it both from the perspective of a linear model
as well as from the perspective of a test. Remember that in our linear
model below we are interested in estimating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\beta_0</annotation></semantics></math>
which in this very simple case just represents the population mean.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>ϵ</mi><mi>i</mi></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">where</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>ϵ</mi><mi>i</mi></msub><mo>∼</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
y_i = \beta_0 + \epsilon_i \ \ \ \ \ \text{where} \ \ \ \ \ \epsilon_i \sim \text{N}(0,\sigma)
</annotation></semantics></math></p>
<div class="section level3">
<h3 id="key-points">Key points<a class="anchor" aria-label="anchor" href="#key-points"></a>
</h3>
<ul>
<li><p>If the sample mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mn>1</mn></msub><annotation encoding="application/x-tex">\bar{y}_1</annotation></semantics></math>)
is very different from the proposed population mean and the standard
error of the difference is small, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-statistic
will be far from zero</p></li>
<li><p>If the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-statistic
is more extreme than the critical values, we reject the null hypothesis
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>)</p></li>
</ul>
<p><img src="lab04_t-tests_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="exercise-1">Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="section level4">
<h4 id="formulation-as-a-linear-model">Formulation as a linear model<a class="anchor" aria-label="anchor" href="#formulation-as-a-linear-model"></a>
</h4>
<ol style="list-style-type: decimal">
<li><p>Open your <code>FANR6750</code> RStudio project (if you have
one)</p></li>
<li><p>Create a new <code>R</code> script and save it to the directory
where you store you lab activities. Name it something like
<code>lab04-t_tests.R</code></p></li>
<li><p>Load the <code>FANR6750</code> package and the
<code>studentsdata</code> object</p></li>
</ol>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rushinglab.github.io/FANR6750">FANR6750</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"studentsdata"</span><span class="op">)</span></span></code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Create an object <code>students</code> which is the vector in the
<code>studentsdata</code> dataframe.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">students</span> <span class="op">&lt;-</span> <span class="va">studentsdata</span><span class="op">$</span><span class="va">students</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Fit a linear model to this dataset.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">students</span> <span class="op">-</span> <span class="fl">65</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = students - 65 ~ 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.406  -2.181  -0.156   1.819   7.794 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   -3.594      0.321   -11.2   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 3.21 on 99 degrees of freedom</span></span></code></pre></div>
<p>A few things to think about here:</p>
<ul>
<li><p>Why did we include the <code>- 65</code> in the model
statement?</p></li>
<li><p>What does the <code>~ 1</code> represent?</p></li>
<li><p>What does the intercept value mean?</p></li>
<li><p>What do we conclude from this model and p-value?</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="formulation-as-a-t-test-by-hand">Formulation as a t-test by hand<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-by-hand"></a>
</h4>
<p>Now that we have seen how R can create a linear model to help us
answer the question about the population mean, we will dive deeper into
what exactly the computer is doing. How exactly did it decide to reject
the null hypothesis? How did it calculate the p-value? Where did it get
those numbers?</p>
<p>We know from lecture that the formula to get a test statistic for a
one sample test is the following:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mfrac><mrow><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo>−</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><mrow><mi>S</mi><mi>E</mi><mi>M</mi></mrow></mfrac><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">where</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>S</mi><mi>E</mi><mi>M</mi><mo>=</mo><mfrac><mi>s</mi><msqrt><mi>n</mi></msqrt></mfrac><mo>=</mo><mfrac><msqrt><mrow><mfrac><mn>1</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></msqrt><msqrt><mi>n</mi></msqrt></mfrac></mrow><annotation encoding="application/x-tex">
t = \frac{\bar{y} - \mu_0}{SEM} \ \ \ \ \ \text{where} \ \ \ \ \ SEM = \frac{s}{\sqrt{n}} = \frac{\sqrt{\frac{1}{n-1}\sum^n_{i=1}(y_i - \bar{y})^2}}{\sqrt{n}}
</annotation></semantics></math> While this looks like a lot, we can
break it into pieces as lines of code in R.</p>
<ol start="6" style="list-style-type: decimal">
<li>Create an object which is the sample mean.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">students</span><span class="op">)</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Create an object which is the standard error</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">students</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">students</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>Put these together to calculate the test statistic</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_stat</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y_bar</span> <span class="op">-</span> <span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="va">se_y</span></span></code></pre></div>
<p>Now that we have a test statistic, we need to calculate a critical
value for comparison.</p>
<ol start="9" style="list-style-type: decimal">
<li>Calculate the critical values</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">t_crit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, df<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">students</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Notice that the results are the same as when we used the
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function.</p>
</div>
<div class="section level4">
<h4 id="formulation-as-a-t-test-using-the-built-in-r-function">Formulation as a t-test using the built in R function<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-using-the-built-in-r-function"></a>
</h4>
<ol start="10" style="list-style-type: decimal">
<li>Use the built in <code>R</code> function <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">students</span>, mu<span class="op">=</span> <span class="fl">65</span>, alternative<span class="op">=</span> <span class="st">'two.sided'</span>, conf.level<span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  One Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  students</span></span>
<span><span class="co">#&gt; t = -11, df = 99, p-value &lt;2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: true mean is not equal to 65</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  60.77 62.04</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x </span></span>
<span><span class="co">#&gt;     61.41</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="samples-vs-tails">Samples vs Tails<a class="anchor" aria-label="anchor" href="#samples-vs-tails"></a>
</h2>
<p>Before we go any further, lets address an issue that many students
find confusing about t-tests. This is the issue of
<strong>samples</strong> vs <strong>tails</strong>. What does it mean
when we talk about a ‘one sample t-test vs a two sample t-test’? What
does it mean when we say a t-test had ‘one tail or two tails’?</p>
<ul>
<li><p><strong>Samples</strong>: The number of samples (one or two) has
to do with the data that you are using to approach the research
question. If you are comparing one sample to a specific value
(e.g. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>1</mn></msub><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">\mu_1 = 6</annotation></semantics></math>)
we call that a <strong>one sample test</strong>. If instead, you are
comparing two sample means to eachother, we call that a <strong>two
sample test</strong></p></li>
<li><p><strong>Tails</strong>: The number of tails (one or two) is
related to the specific research question that you are interested in
asking and it is directly informed by the null and alternative
hypotheses. A <strong>two tailed test</strong> will have hypotheses like
those below:</p></li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">
H_0: \mu_1 = x
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>≠</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">
H_A: \mu_1 \ne x
</annotation></semantics></math></p>
<p>Notice the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>=</mo><annotation encoding="application/x-tex">=</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≠</mo><annotation encoding="application/x-tex">\ne</annotation></semantics></math>
in the hypotheses.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\mu_1</annotation></semantics></math>
may be being compared to a specific value or being compared to another
mean
(e.g. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\mu_2</annotation></semantics></math>)
but the hypotheses are always set up as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>=</mo><annotation encoding="application/x-tex">=</annotation></semantics></math>
vs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≠</mo><annotation encoding="application/x-tex">\ne</annotation></semantics></math>.</p>
<p>In constrast, a <strong>one tailed test</strong> will have hypotheses
like these below:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>≤</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">
H_0: \mu_1 \le x
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>&gt;</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">
H_A: \mu_1 &gt; x
</annotation></semantics></math></p>
<p>Or the other way around:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>≥</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">
H_0: \mu_1 \ge x
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>&lt;</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">
H_A: \mu_1 &lt; x
</annotation></semantics></math></p>
<p>Notice that in a one tailed test, the alternative is only interested
in one direction and the null includes everything else.</p>
<p><strong>In what types of situations might you want to set up a t-test
as one tailed? What about two tailed? Which do you think has more
statistical power to detect an effect?</strong></p>
</div>
<div class="section level2">
<h2 id="scenario-2-two-sample-t-tests">Scenario 2: Two sample t-tests<a class="anchor" aria-label="anchor" href="#scenario-2-two-sample-t-tests"></a>
</h2>
<p>In this dataset, we have the average number of calls over 10 minutes
during point count surveys for Song Thrushes (<em>Turdus
philomelos</em>), a species of song bird in eastern Europe. The
researcher is interested in understanding how wind may be affecting the
frequency of bird calls. Specifically, she would like to know whether
high wind conditions results in fewer average calls over 10 minutes than
low wind conditions.</p>
<ul>
<li><p><strong>Question</strong>: Do the samples come from the same
population, or do they come from populations with different
means?</p></li>
<li><p><strong>Problem</strong>: We don’t know the true population means
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>H</mi></msub><annotation encoding="application/x-tex">\mu_H</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>L</mi></msub><annotation encoding="application/x-tex">\mu_L</annotation></semantics></math>)</p></li>
<li>
<p>Under the assumption that the variances of the two populations
are equal, the relevant hypotheses are:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>μ</mi><mi>H</mi></msub><mo>≥</mo><msub><mi>μ</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">H_0 : \mu_H \ge \mu_L</annotation></semantics></math></p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><msub><mi>μ</mi><mi>H</mi></msub><mo>&lt;</mo><msub><mi>μ</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">H_A : \mu_H &lt; \mu_L</annotation></semantics></math></p></li>
</ul>
</li>
</ul>
<p><strong>How many tails are in this test? Why did we decide to do
that?</strong></p>
<p><img src="lab04_t-tests_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We will again see how this problem can be approached from the
perspective of a linear model as well as being considered as a test.
Below is the linear model for the two sample t-test. It should look
similar to the last one we used, but now we have added the complexity of
two categorical levels (i.e. high wind vs low wind):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>ϵ</mi><mi>i</mi></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">where</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>ϵ</mi><mi>i</mi></msub><mo>∼</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
y_i = \beta_0 + \beta_1x_i + \epsilon_i \ \ \ \ \ \text{where} \ \ \ \ \ \epsilon_i \sim \text{N}(0,\sigma)
</annotation></semantics></math></p>
<p><strong>How do we interpret
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\beta_0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\beta_1</annotation></semantics></math>?</strong></p>
<div class="section level3">
<h3 id="exercise-2">Exercise 2<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h3>
<div class="section level4">
<h4 id="formulation-as-a-linear-model-1">Formulation as a linear model<a class="anchor" aria-label="anchor" href="#formulation-as-a-linear-model-1"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Load the <code>FANR6750</code> package and the
<code>thrushdata</code> object. Lets look at the structure and summary
of the dataset as well</li>
</ol>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rushinglab.github.io/FANR6750">FANR6750</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"thrushdata"</span><span class="op">)</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">thrushdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    100 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ calls: num  9.1 5.7 7.7 14.9 12.3 16.7 17.8 11.6 7.5 14.3 ...</span></span>
<span><span class="co">#&gt;  $ wind : chr  "high" "high" "high" "high" ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">thrushdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;      calls          wind          </span></span>
<span><span class="co">#&gt;  Min.   : 5.7   Length:100        </span></span>
<span><span class="co">#&gt;  1st Qu.:11.3   Class :character  </span></span>
<span><span class="co">#&gt;  Median :14.1   Mode  :character  </span></span>
<span><span class="co">#&gt;  Mean   :14.1                     </span></span>
<span><span class="co">#&gt;  3rd Qu.:16.7                     </span></span>
<span><span class="co">#&gt;  Max.   :23.4</span></span>
<span></span>
<span><span class="co"># Notice from the str() and summary() functions that R is interpreting the 'wind' variable </span></span>
<span><span class="co"># as a character. Because we would like to treat 'wind' as a grouping variable, we can </span></span>
<span><span class="co"># convert it to a factor in R.</span></span>
<span></span>
<span><span class="va">thrushdata</span><span class="op">$</span><span class="va">wind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">thrushdata</span><span class="op">$</span><span class="va">wind</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Fit a linear model to the data which estimates call frequency as a
function of wind conditions.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">calls</span><span class="op">~</span> <span class="va">wind</span>, data<span class="op">=</span> <span class="va">thrushdata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = calls ~ wind, data = thrushdata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt;  -6.02  -2.42  -0.12   2.17   6.95 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   11.720      0.414   28.32  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; windlow        4.730      0.585    8.08  1.7e-12 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.93 on 98 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:   0.4,   Adjusted R-squared:  0.394 </span></span>
<span><span class="co">#&gt; F-statistic: 65.3 on 1 and 98 DF,  p-value: 1.69e-12</span></span></code></pre></div>
<p><strong>How would you interpret these results? Is there a difference
in call frequency as a function of wind conditions? Which of these
numbers represent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\beta_0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\beta_1</annotation></semantics></math>
in our linear model above?</strong></p>
</div>
<div class="section level4">
<h4 id="formulation-as-a-t-test-by-hand-1">Formulation as a t-test by hand<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-by-hand-1"></a>
</h4>
<p>Similar to Exercise 1, we could calculate a test statistic by hand.
The formulas for creating this test statistic as well as the pooled
variance are shown below:</p>
<p><span class="math display">$$\large t = \frac{(\bar{y}_H − \bar{y}_L)
− (\mu_H − \mu_L)}{\sqrt{s^2_p/n_H + s^2_p/n_L}}$$</span></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>s</mi><mi>p</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">s^2_p</annotation></semantics></math>
is the pooled variance</p>
<p><span class="math display">$$\large s^2_p = \frac{(n_H − 1)s^2_H +
(n_L − 1)s^2_L}{n_H + n_L − 2}$$</span></p>
<p>We will leave it as an exercise for you to perform. The general steps
are as follows:</p>
<ul>
<li><p>Calculate the test statistic by defining all the necessary terms
in R</p></li>
<li><p>Calculate the appropriate critical value/values</p></li>
<li><p>Compare the test statistic to the critical value/values and reach
a conclusion about the hypotheses in question</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="formulation-as-a-t-test-using-the-built-in-r-function-1">Formulation as a t-test using the built in R function<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-using-the-built-in-r-function-1"></a>
</h3>
<ol start="3" style="list-style-type: decimal">
<li>Create two objects which represent the calls vectors for high and
low wind conditions</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yL</span> <span class="op">&lt;-</span> <span class="va">thrushdata</span><span class="op">$</span><span class="va">calls</span><span class="op">[</span><span class="va">thrushdata</span><span class="op">$</span><span class="va">wind</span><span class="op">==</span> <span class="st">'low'</span><span class="op">]</span></span>
<span><span class="va">yH</span> <span class="op">&lt;-</span> <span class="va">thrushdata</span><span class="op">$</span><span class="va">calls</span><span class="op">[</span><span class="va">thrushdata</span><span class="op">$</span><span class="va">wind</span><span class="op">==</span> <span class="st">'high'</span><span class="op">]</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Use the <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code> function to perform the two sample
t-test</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">yH</span>, <span class="va">yL</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>, paired <span class="op">=</span> <span class="cn">FALSE</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  yH and yL</span></span>
<span><span class="co">#&gt; t = -8.1, df = 98, p-value = 8e-13</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is less than 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;    -Inf -3.758</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x mean of y </span></span>
<span><span class="co">#&gt;     11.72     16.45</span></span></code></pre></div>
<p>Make sure you set <code>var.equal=TRUE</code>. Otherwise,
<code>R</code> will assume that the variances of the two populations are
unequal. We can test this assumption using the code below.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/var.test.html" class="external-link">var.test</a></span><span class="op">(</span><span class="va">yH</span>, <span class="va">yL</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  F test to compare two variances</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  yH and yL</span></span>
<span><span class="co">#&gt; F = 1.2, num df = 49, denom df = 49, p-value = 0.5</span></span>
<span><span class="co">#&gt; alternative hypothesis: true ratio of variances is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.6874 2.1345</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; ratio of variances </span></span>
<span><span class="co">#&gt;              1.211</span></span></code></pre></div>
<p><strong>What do we conclude? Was it appropriate for us to assume
equality of variances? What could we have done if this assumption was
not met?</strong></p>
<p>We have performed the t-test for this dataset but it would be nice if
we could plot the data. This section below provides a brief introduction
to plotting in <code>R</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="scenario-3-paired-t-test">Scenario 3: Paired t-test<a class="anchor" aria-label="anchor" href="#scenario-3-paired-t-test"></a>
</h2>
<p>In this dataset, the researcher is interested in studying the effects
of a pesticide on caterpillar populations. Twelve bushes are examined
and the number of caterpillars on each bush is recorded. The pesticide
is applied and after 3 days the number of caterpillars on each bush is
recorded again.</p>
<ul>
<li><p><strong>Question</strong>: Does the pesticide have a negative
effect on the caterpillar population?</p></li>
<li><p><strong>Note</strong>: Paired t-tests can be thought of as a one
sample t-test on the differences.</p></li>
<li><p>The hypotheses for this test would be the following:</p></li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>μ</mi><mi>T</mi></msub><mo>≥</mo><msub><mi>μ</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">
H_0: \mu_T \ge \mu_U
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><msub><mi>μ</mi><mi>T</mi></msub><mo>&lt;</mo><msub><mi>μ</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">
H_A: \mu_T &lt; \mu_U
</annotation></semantics></math></p>
<p>Another way we could think about this is to say that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>U</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>T</mi></msub><mo>=</mo><msub><mi>μ</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">\mu_U - \mu_T = \mu_D</annotation></semantics></math>.
From here, we can formulate the hypotheses as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>μ</mi><mi>D</mi></msub><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
H_0: \mu_D \le 0
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><msub><mi>μ</mi><mi>D</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
H_A: \mu_D &gt; 0
</annotation></semantics></math></p>
<div class="section level3">
<h3 id="exercise-4">Exercise 4<a class="anchor" aria-label="anchor" href="#exercise-4"></a>
</h3>
<div class="section level4">
<h4 id="formulation-as-a-linear-model-2">Formulation as a linear model<a class="anchor" aria-label="anchor" href="#formulation-as-a-linear-model-2"></a>
</h4>
<p>In this case, we already know that the paired t-test can be thought
of as a one sample t-test on the differences. As a result, the linear
model can be set up in the same way as Scenario 1 above. This will be
left as an exercise</p>
</div>
<div class="section level4">
<h4 id="formulation-as-a-t-test-by-hand-2">Formulation as a t-test by hand<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-by-hand-2"></a>
</h4>
<p>This will be left as an exercise for you but the general steps are as
follows:</p>
<ol style="list-style-type: decimal">
<li>Load the caterpillar dataset</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"caterpillardata"</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Calculate the difference between the untreated and treated
values</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caterpillardata</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="va">caterpillardata</span><span class="op">$</span><span class="va">untreated</span> <span class="op">-</span> <span class="va">caterpillardata</span><span class="op">$</span><span class="va">treated</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">caterpillardata</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span></code></pre></div>
<p>Is the mean different from zero?</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">caterpillardata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab04_t-tests_files/figure-html/unnamed-chunk-22-1.png" width="480" style="display: block; margin: auto;"></p>
<ol start="3" style="list-style-type: decimal">
<li>Calculate the standard deviation of the differences</li>
</ol>
<p><span class="math display">$$\large s_d =
\sqrt{\frac{1}{n-1}\sum_{i=1}^n(y_i - \bar{y})^2}$$</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Calculate the test statistic</li>
</ol>
<p><span class="math display">$$\large t =
\frac{\bar{y}-0}{s_d/\sqrt{n}}$$</span></p>
<ol start="5" style="list-style-type: decimal">
<li>Compare to appropriate critical value and draw a conclusion</li>
</ol>
</div>
<div class="section level4">
<h4 id="formulation-as-a-t-test-using-the-built-in-r-function-2">Formulation as a t-test using the built in R function<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-using-the-built-in-r-function-2"></a>
</h4>
<ol start="6" style="list-style-type: decimal">
<li>Use the <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code> function in R to perform the test</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">caterpillardata</span><span class="op">$</span><span class="va">diff</span>, mu<span class="op">=</span> <span class="fl">0</span>, alternative<span class="op">=</span> <span class="st">'greater'</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  One Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  caterpillardata$diff</span></span>
<span><span class="co">#&gt; t = 2.3, df = 11, p-value = 0.02</span></span>
<span><span class="co">#&gt; alternative hypothesis: true mean is greater than 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.3408    Inf</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x </span></span>
<span><span class="co">#&gt;       1.5</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h2>
<p>This dataset comes from fisheries landings data for Yellowfin tuna
(<em>Thunnus albacares</em>). The weight in pounds was recorded for each
fish as well as presence of the larval form of a Lacistorhynchidae
tapeworm (<em>Dasyrhynchus talismani</em>). The researcher believes that
the presence of the tapeworm likely results in a less healthy and
therefore lighter fish.</p>
<p>Create an R Markdown file titled “Assignment 2”. Within that
document, do the following:</p>
<ol style="list-style-type: decimal">
<li>Create an <code>R</code> chunk to load the tuna data using:</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rushinglab.github.io/FANR6750">FANR6750</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tunadata"</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Make a figure to show the weights of both infected and healthy
tuna. You should spend some time considering what type of figure would
best display this data</p></li>
<li><p>Create a header called “Hypotheses” and under this header, in
plain English indicate what the null and alternative hypotheses are for
the t-test. Also use R Markdown’s equation features to write these
hypotheses using mathematical notation. In order to do this, you will
need to consider what type of test would be appropriate for this data
and how many tails the test will have</p></li>
<li><p>Create a header called “t-test by hand”. Under this header, add a
R chunk that includes the following code. Change the <code>?</code>
inside the <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> function to any number of your
choosing, then run the code. you should get either a 0 or a 1</p></li>
</ol>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">set.seed</span>(?)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<ul>
<li>If the code above returned 0, do the following:</li>
</ul>
<blockquote>
<p>Do a t-test on the tuna data without using the <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>
function. Use only the functions <code>mean</code>, <code>sd</code>, and
possibly <code>length</code>. Be sure to annotate your code (either
within the <code>R</code> chunk using <code>#</code> or as plain text
within the R Markdown file) and state the decision (reject or fail to
reject the null) based on your results</p>
</blockquote>
<ul>
<li>If the code above returned 1, do the following:</li>
</ul>
<blockquote>
<p>Ask AI to perform a t-test without using the <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>
function. The code may only use the functions <code>mean</code>,
<code>sd</code>, and possibly <code>length</code>. The final code must
be annotated and must state the decision of the test. Provide all
prompts and output you used to get a final, working version of the code
that meets the criteria above.</p>
</blockquote>
<ul>
<li>Regardless of which option you completed, <strong>keep track of how
long it took you to complete the question and include the time taken at
the end of your answer</strong>.</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><p>Create a header called “t-test in R”. Under this header, do the
t-test again, but this time using the <code>t.test</code> function
(assume variances are equal). Did you get the same answer as the
previous question. Explain why you think the t-test failed to reject the
null hypothesis even though the sample means were ~60 pounds different
(almost a 20% difference in weight). What about the data may have caused
this result?</p></li>
<li><p>Create a new header called “Reflection”. Under this header,
answer the following questions:</p></li>
</ol>
<ul>
<li><p>On a 1-10 scale, how would you rate your confidence in the topics
covered in this lab?</p></li>
<li><p>What lingering questions/confusion about these topics do you
still have?</p></li>
<li><p>If you used AI to answer question 4, do you think it helped? Did
it save time? If you did not use AI, do you think it would have
helped?</p></li>
</ul>
<p>A few things to remember when creating the document:</p>
<ul>
<li><p>Be sure to include your name in the <code>author</code> field of
the header</p></li>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so that all code and output is visible in the knitted
document</p></li>
<li><p>Regularly knit the document as you work to check for
errors</p></li>
<li><p>See the R Markdown reference sheet for help with creating
<code>R</code> chunks, equations, tables, etc.</p></li>
<li><p>If you use AI on any part of your assignment, you must include
the full prompt(s) you used and it’s full answer(s) in a
<strong>separate section</strong> titled “AI assistance” at the end of
this document.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
