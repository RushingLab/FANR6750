<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 5: Completely randomized ANOVA • FANR6750</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.0/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lab 5: Completely randomized ANOVA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FANR6750</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../articles/syllabus.html"><span class="fa fas fa-book"></span> Syllabus</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/schedule.html"><span class="fa fas fa-calendar"></span> Schedule</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lectures" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-file-pdf-o"></span> Lectures</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lectures">
<li><a class="dropdown-item" href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/01_intro_to_stats/01_intro_to_stats.html">Lecture 1: Introduction to statistics</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/02_intro_to_lm/02_intro_to_lm.html">Lecture 2: Introduction to linear models</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/03_inference/03_inference.html">Lecture 3: Principles of inference</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/04_principles_of_expdesign/04_expdesign.html">Lecture 4: Principles of experimental design</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/05_t-test/05_t-test.html">Lecture 5: Linear models part 1: categorical predictor w/ 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/06_nht/06_nht.html">Lecture 6: Null hypothesis significance testings</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/07_power/07_power.html">Lecture 7: Statistical power</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/08_anova/08_anova.html">Lecture 8: Linear models part 2: categorical predictor &gt; 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/09_mult_comp/09_mult_comp.html">Lecture 9: Multiple Comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/10_regression/10_regression.html">Lecture 10: Multiple Regression</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-labs" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Labs</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-labs">
<li><a class="dropdown-item" href="../articles/lab01_intro_to_R.html">Lab 1: Introduction to R</a></li>
    <li><a class="dropdown-item" href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to projects and RMarkdown</a></li>
    <li><a class="dropdown-item" href="../articles/lab03_inference.html">Lab 3: Using R to explore sampling error</a></li>
    <li><a class="dropdown-item" href="../articles/lab04_t-tests.html">Lab 4: t-tests</a></li>
    <li><a class="dropdown-item" href="../articles/lab05_ANOVA.html">Lab 5: ANOVA</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-references" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-pencil-square-o"></span> References</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-references">
<li><a class="dropdown-item" href="../articles/homework.html">Assignment instructions</a></li>
    <li><a class="dropdown-item" href="../articles/projects_and_directories.html">Projects and directories</a></li>
    <li><a class="dropdown-item" href="../articles/RMarkdown.html">R Markdown reference</a></li>
    <li><a class="dropdown-item" href="../articles/graphics.html">Creating publication-quality graphics</a></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="lab05_anova_files/kePrint-0.0.1/kePrint.js"></script><link href="lab05_anova_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Lab 5: Completely randomized ANOVA</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2025</h4>
            
      

      <div class="d-none name"><code>lab05_ANOVA.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="lab-4">Lab 4<a class="anchor" aria-label="anchor" href="#lab-4"></a>
</h3>
<ol style="list-style-type: decimal">
<li>t-tests</li>
</ol>
<ul>
<li><p>One sample t-tests</p></li>
<li><p>Two sample t-tests</p></li>
<li><p>Samples vs tails</p></li>
<li><p>Paired t-tests</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="todays-topics">Today’s topics<a class="anchor" aria-label="anchor" href="#todays-topics"></a>
</h3>
<ol style="list-style-type: decimal">
<li>One way ANOVA as a linear model</li>
</ol>
<ul>
<li><p>Using lm()</p></li>
<li><p>Using aov()</p></li>
<li><p>Performing an ANOVA by hand</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p>Plotting group means and CI’s</p></li>
<li><p>Multiple comparisons</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="one-way-anova-as-a-linear-model">One-way ANOVA as a linear model<a class="anchor" aria-label="anchor" href="#one-way-anova-as-a-linear-model"></a>
</h2>
<div class="section level5">
<h5 id="scenario">Scenario<a class="anchor" aria-label="anchor" href="#scenario"></a>
</h5>
<ul>
<li><p>We have independent samples from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">a &gt; 2</annotation></semantics></math>
groups</p></li>
<li><p>We assume a common variance</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="questions">Questions<a class="anchor" aria-label="anchor" href="#questions"></a>
</h5>
<ul>
<li><p>Do the means differ and by how much (what are the effect
sizes?)</p></li>
<li><p>Which means differ from each other?</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="null-hypothesis">Null hypothesis<a class="anchor" aria-label="anchor" href="#null-hypothesis"></a>
</h5>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>=</mo><msub><mi>μ</mi><mn>2</mn></msub><mo>=</mo><msub><mi>μ</mi><mn>3</mn></msub><mo>=</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>=</mo><msub><mi>μ</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">H_0 : \mu_1 = \mu_2 = \mu_3 = . . . = \mu_a</annotation></semantics></math></li>
</ul>
<p>OR</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>α</mi><mn>1</mn></msub><mo>=</mo><msub><mi>α</mi><mn>2</mn></msub><mo>=</mo><msub><mi>α</mi><mn>3</mn></msub><mo>=</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>=</mo><msub><mi>α</mi><mi>a</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0 : \alpha_1 = \alpha_2 = \alpha_3 = . . . = \alpha_a = 0</annotation></semantics></math></li>
</ul>
</div>
<div class="section level5">
<h5 id="alternative-hypothesis">Alternative hypothesis<a class="anchor" aria-label="anchor" href="#alternative-hypothesis"></a>
</h5>
<ul>
<li><span class="math inline">$H_A: \mu_i \ne \mu_j \space\text{for some
i, j in (1, . . ., a)}$</span></li>
</ul>
</div>
<div class="section level5">
<h5 id="formulation-as-a-linear-model">Formulation as a linear model<a class="anchor" aria-label="anchor" href="#formulation-as-a-linear-model"></a>
</h5>
<p>Just as we have seen in the last lab, many of the analyses that we
will perform this semester can be thought of in multiple ways. A one-way
ANOVA can be formulated as a linear model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>μ</mi><mo>+</mo><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">where</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
y_{ij} = \mu + \alpha_i + \epsilon_{ij} \ \ \ \ \ \text{where} \ \ \ \ \ \epsilon_{ij} \sim \text{N}(0,\sigma)
</annotation></semantics></math></p>
<p><strong>Can you define each term in the context of the data? Why did
we need to add additional sub-scripting to the observation and residual
terms?</strong></p>
</div>
<div class="section level3">
<h3 id="exercise-1">Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<p>The dataset below comes from a pilot study implemented by the US
Forest Service. The service is interested in purchasing a number of
chainsaws to use for various projects and fieldwork. Due to safety
concerns, the service is hoping to select the chainsaw brand (A, B, C,
or D) which has the lowest average kickback angle. Kickback, which
refers to the sudden upward motion of the saw’s guide bar when the saw
strikes a hard object, is one of the leading causes of injuries during
chainsaw work. While the service would like to prioritize safety, their
secondary objective is to find a reasonably priced brand. The brands
range in price (D,B,A,C) with Brand D being the most expensive.</p>
<ol style="list-style-type: decimal">
<li>Load the sawdata dataset and examine the data</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sawdata"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Chainsaw  A  B  C  D</span></span>
<span><span class="co">#&gt; 1        1 42 38 52 29</span></span>
<span><span class="co">#&gt; 2        2 36 50 54 35</span></span>
<span><span class="co">#&gt; 3        3 33 44 48 31</span></span>
<span><span class="co">#&gt; 4        4 39 37 49 36</span></span>
<span><span class="co">#&gt; 5        5 43 47 54 32</span></span></code></pre></div>
<p>You may notice that something seems different about this dataset than
the previous ones we have looked at over the last few weeks. This is
because the data are in what is called ‘wide format’. This means that
each level of the grouping variable (in this case chainsaw brand) has
gotten its own column in the dataframe. While wide format is often
convenient for reports because it allows you to more easily see trends
in a table, long format is more useful for succinctly storing data and
for use in most analyses.</p>
<ol start="2" style="list-style-type: decimal">
<li>Convert the dataframe from wide format to long format<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;In this code chunk, we introduce the idea of pipes in R.
A pipe (shown with %&amp;gt;%) is a way of stacking multiple functions on
top of each other in an easy to read way. Many packages (including
tidyr) use pipes instead of having functions nested inside of each
other. While pipes are generally considered to have multiple advantages
related to their readability as well as modular structure, there are
ways to perform any of these steps without their use.&lt;/p&gt;"><sup>1</sup></a>
</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="va">sawdata</span> <span class="op">&lt;-</span> <span class="va">sawdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span><span class="op">)</span>,</span>
<span>                         names_to<span class="op">=</span> <span class="st">'Brand'</span>,</span>
<span>                         values_to<span class="op">=</span> <span class="st">'angle'</span><span class="op">)</span></span>
<span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Visualize the data</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sawdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Brand</span>, y <span class="op">=</span> <span class="va">angle</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Kickback angle"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab05_anova_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="two-anova-functions-in-r-aov-and-lm">Two ANOVA functions: in <code>R</code>: <code>aov()</code> and
<code>lm()</code><a class="anchor" aria-label="anchor" href="#two-anova-functions-in-r-aov-and-lm"></a>
</h3>
<ul>
<li><p><code>R</code> has 2 common functions for doing ANOVA:
<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> and <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code></p></li>
<li><p>We will use both in this class</p></li>
</ul>
<div class="section level4">
<h4 id="crude-characterization">Crude characterization<a class="anchor" aria-label="anchor" href="#crude-characterization"></a>
</h4>
<table class="table table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
aov()
</th>
<th style="text-align:center;">
lm()
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Emphasis
</td>
<td style="text-align:center;">
ANOVA tables
</td>
<td style="text-align:center;">
Linear models
</td>
</tr>
<tr>
<td style="text-align:center;">
Typical use
</td>
<td style="text-align:center;">
Designed experiments
</td>
<td style="text-align:center;">
Regression analysis
</td>
</tr>
<tr>
<td style="text-align:center;">
Multiple error strata?
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
No
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="using-lm">Using <code>lm()</code><a class="anchor" aria-label="anchor" href="#using-lm"></a>
</h3>
<ol start="4" style="list-style-type: decimal">
<li>Perform the analysis using the lm() function</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">angle</span><span class="op">~</span> <span class="va">Brand</span>, data<span class="op">=</span> <span class="va">sawdata</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = angle ~ Brand, data = sawdata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt;   -6.2   -2.8    0.5    2.8    6.8 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    38.60       1.80   21.39  3.4e-13 ***</span></span>
<span><span class="co">#&gt; BrandB          4.60       2.55    1.80  0.09027 .  </span></span>
<span><span class="co">#&gt; BrandC         12.80       2.55    5.02  0.00013 ***</span></span>
<span><span class="co">#&gt; BrandD         -6.00       2.55   -2.35  0.03184 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.03 on 16 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.784,  Adjusted R-squared:  0.743 </span></span>
<span><span class="co">#&gt; F-statistic: 19.3 on 3 and 16 DF,  p-value: 1.45e-05</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt;    (Intercept) BrandB BrandC BrandD</span></span>
<span><span class="co">#&gt; 1            1      0      0      0</span></span>
<span><span class="co">#&gt; 2            1      1      0      0</span></span>
<span><span class="co">#&gt; 3            1      0      1      0</span></span>
<span><span class="co">#&gt; 4            1      0      0      1</span></span>
<span><span class="co">#&gt; 5            1      0      0      0</span></span>
<span><span class="co">#&gt; 6            1      1      0      0</span></span>
<span><span class="co">#&gt; 7            1      0      1      0</span></span>
<span><span class="co">#&gt; 8            1      0      0      1</span></span>
<span><span class="co">#&gt; 9            1      0      0      0</span></span>
<span><span class="co">#&gt; 10           1      1      0      0</span></span>
<span><span class="co">#&gt; 11           1      0      1      0</span></span>
<span><span class="co">#&gt; 12           1      0      0      1</span></span>
<span><span class="co">#&gt; 13           1      0      0      0</span></span>
<span><span class="co">#&gt; 14           1      1      0      0</span></span>
<span><span class="co">#&gt; 15           1      0      1      0</span></span>
<span><span class="co">#&gt; 16           1      0      0      1</span></span>
<span><span class="co">#&gt; 17           1      0      0      0</span></span>
<span><span class="co">#&gt; 18           1      1      0      0</span></span>
<span><span class="co">#&gt; 19           1      0      1      0</span></span>
<span><span class="co">#&gt; 20           1      0      0      1</span></span>
<span><span class="co">#&gt; attr(,"assign")</span></span>
<span><span class="co">#&gt; [1] 0 1 1 1</span></span>
<span><span class="co">#&gt; attr(,"contrasts")</span></span>
<span><span class="co">#&gt; attr(,"contrasts")$Brand</span></span>
<span><span class="co">#&gt; [1] "contr.treatment"</span></span></code></pre></div>
<p><strong>Can you interpret each estimate? Why are only the last three
brands shown (what happened to Brand A)? What does each p-value
represent and what hypothesis are they testing?</strong></p>
</div>
<div class="section level3">
<h3 id="using-aov">Using <code>aov()</code><a class="anchor" aria-label="anchor" href="#using-aov"></a>
</h3>
<ol start="5" style="list-style-type: decimal">
<li>Perform the analysis using the aov() function</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aov1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">angle</span> <span class="op">~</span> <span class="va">Brand</span>, data <span class="op">=</span> <span class="va">sawdata</span><span class="op">)</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>View the ANOVA table</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Brand        3    943   314.2    19.3 1.4e-05 ***</span></span>
<span><span class="co">#&gt; Residuals   16    260    16.3                    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p><strong>What can we conclude from this ANOVA table? Does there appear
to be more or less information (or just different) provided here than
when we used the lm() function?</strong></p>
<p>The default output from <code>summary</code> is fine for viewing in
the console but what if you want to include the ANOVA table in a report
or paper? You could manually create a table and copy/paste the values,
but that’s a pain. Luckily, there is a handy package called
<code>broom</code> that turns the output from many model functions into
cleaned-up data frames<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Notice the use of the double colon in the code chunk
below. This is used in &lt;code&gt;R&lt;/code&gt; to explicitly link a function to
the package from where it came. Because there is an ever expanding list
of available packages and many of them contain functions that have the
same names but perform different tasks, it is necessary to tell
&lt;code&gt;R&lt;/code&gt; which particular function you are trying to use. If we
did not specify the package using the double colon operator,
&lt;code&gt;R&lt;/code&gt; would use the function from whatever was the most
recently loaded package in your library that contained that function
name.&lt;/p&gt;"><sup>2</sup></a>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   term         df sumsq meansq statistic    p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Brand         3  943.  314.       19.3  0.000<span style="text-decoration: underline;">014</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Residuals    16  260.   16.3      <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>In R Markdown, we can even include that data frame as a nicely
formatted table directly in the knitted document:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aov_df</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>knitr.kable.NA <span class="op">=</span> <span class="st">''</span><span class="op">)</span> <span class="co"># don't print NA's in table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">aov_df</span>, </span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Source"</span>, <span class="st">"df"</span>, <span class="st">"SS"</span>, <span class="st">"MS"</span>, <span class="st">"F"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>      align <span class="op">=</span> <span class="st">'c'</span>, format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> </span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:center;">
Source
</th>
<th style="text-align:center;">
df
</th>
<th style="text-align:center;">
SS
</th>
<th style="text-align:center;">
MS
</th>
<th style="text-align:center;">
F
</th>
<th style="text-align:center;">
p
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Brand
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
942.5
</td>
<td style="text-align:center;">
314.18
</td>
<td style="text-align:center;">
19.3
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Residuals
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
260.4
</td>
<td style="text-align:center;">
16.27
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
<div class="section level5">
<h5 id="getting-estimates-of-group-means-mus-and-ses">Getting estimates of group means (
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>’s)
and SE’s<a class="anchor" aria-label="anchor" href="#getting-estimates-of-group-means-mus-and-ses"></a>
</h5>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html" class="external-link">model.tables</a></span><span class="op">(</span><span class="va">aov1</span>, type <span class="op">=</span> <span class="st">"means"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tables of means</span></span>
<span><span class="co">#&gt; Grand mean</span></span>
<span><span class="co">#&gt;       </span></span>
<span><span class="co">#&gt; 41.45 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Brand </span></span>
<span><span class="co">#&gt; Brand</span></span>
<span><span class="co">#&gt;    A    B    C    D </span></span>
<span><span class="co">#&gt; 38.6 43.2 51.4 32.6 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standard errors for differences of means</span></span>
<span><span class="co">#&gt;         Brand</span></span>
<span><span class="co">#&gt;         2.551</span></span>
<span><span class="co">#&gt; replic.     5</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="getting-estimates-of-effect-sizes-alphas-and-ses">Getting estimates of effect sizes (
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>’s)
and SE’s<a class="anchor" aria-label="anchor" href="#getting-estimates-of-effect-sizes-alphas-and-ses"></a>
</h5>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html" class="external-link">model.tables</a></span><span class="op">(</span><span class="va">aov1</span>, type <span class="op">=</span> <span class="st">"effects"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tables of effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Brand </span></span>
<span><span class="co">#&gt; Brand</span></span>
<span><span class="co">#&gt;     A     B     C     D </span></span>
<span><span class="co">#&gt; -2.85  1.75  9.95 -8.85 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standard errors of effects</span></span>
<span><span class="co">#&gt;         Brand</span></span>
<span><span class="co">#&gt;         1.804</span></span>
<span><span class="co">#&gt; replic.     5</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="constructing-an-anova-table-by-hand">Constructing an ANOVA table by hand<a class="anchor" aria-label="anchor" href="#constructing-an-anova-table-by-hand"></a>
</h3>
<p>Just as we did in the last lab, we will see below how <code>R</code>
is actually doing the ANOVA and we’ll get practice constructing an ANOVA
table by hand.</p>
<div class="section level5">
<h5 id="grand-mean">Grand mean<a class="anchor" aria-label="anchor" href="#grand-mean"></a>
</h5>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ybar.</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 41.45</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="group-means">Group means<a class="anchor" aria-label="anchor" href="#group-means"></a>
</h5>
<p>As with most things in <code>R</code>, there are several ways to
calculate the group means. First, find the group means, the hard
way:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span><span class="op">[</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">]</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span><span class="op">[</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span> <span class="op">==</span> <span class="st">"B"</span><span class="op">]</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span><span class="op">[</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span> <span class="op">==</span> <span class="st">"C"</span><span class="op">]</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span><span class="op">[</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span> <span class="op">==</span> <span class="st">"D"</span><span class="op">]</span></span>
<span></span>
<span><span class="op">(</span><span class="va">ybar.i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">C</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 38.6 43.2 51.4 32.6</span></span></code></pre></div>
<p>Better yet, use <code>tapply</code> to find the group means (the base
<code>R</code> way):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ybar.i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span>, INDEX <span class="op">=</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    A    B    C    D </span></span>
<span><span class="co">#&gt; 38.6 43.2 51.4 32.6</span></span></code></pre></div>
<p>Finally, find the group means, the tidyverse way:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">ybar.i</span> <span class="op">&lt;-</span> <span class="va">sawdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Brand</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">angle</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   Brand    mu</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A      38.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B      43.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> C      51.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> D      32.6</span></span></code></pre></div>
<hr>
<p>Although each of these methods does what we want - return the mean
kickback angle for each group - note that they do not return the same
type of object.</p>
<p>Use the <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class()</a></code> function to see what type of object each
one returns.</p>
<p>When might the output from each method be useful?</p>
<hr>
</div>
<div class="section level5">
<h5 id="sum-of-squares">Sum of squares<a class="anchor" aria-label="anchor" href="#sum-of-squares"></a>
</h5>
<p>Sums of squares among</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of saw brands</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">$</span><span class="va">Brand</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Number of measurements of each brand (note, this assumes balanced design)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sawdata</span><span class="op">)</span><span class="op">/</span><span class="va">a</span></span>
<span></span>
<span><span class="va">SSa</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">ybar.i</span><span class="op">$</span><span class="va">mu</span> <span class="op">-</span> <span class="va">ybar.</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">SSa</span></span>
<span><span class="co">#&gt; [1] 942.5</span></span></code></pre></div>
<p>Sums of squares within<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Notice the use of the &lt;code&gt;times=&lt;/code&gt; argument. How
do we decide whether to use &lt;code&gt;times=&lt;/code&gt; or &lt;code&gt;each=&lt;/code&gt;?
In this case, we need to look at the order of the data in the dataframe.
Because of how the data is ordered, we are interested in taking the
entire mu vector and repeating it 5 times. If the data were ordered such
that all the Brand A observations were first etc. then we would have
taken each element in the mu vector and repeated it
&lt;code&gt;each= 5&lt;/code&gt;.&lt;/p&gt;"><sup>3</sup></a></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># individual saw data</span></span>
<span><span class="va">y.ij</span> <span class="op">&lt;-</span> <span class="va">sawdata</span><span class="op">$</span><span class="va">angle</span></span>
<span></span>
<span><span class="va">SSw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">y.ij</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ybar.i</span><span class="op">$</span><span class="va">mu</span>, times <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">SSw</span></span>
<span><span class="co">#&gt; [1] 260.4</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="means-squares">Means squares<a class="anchor" aria-label="anchor" href="#means-squares"></a>
</h5>
<p>Mean squares among</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="op">(</span><span class="va">MSa</span> <span class="op">&lt;-</span> <span class="va">SSa</span> <span class="op">/</span> <span class="va">df1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 314.2</span></span></code></pre></div>
<p>Mean squares within</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">MSw</span> <span class="op">&lt;-</span> <span class="va">SSw</span> <span class="op">/</span> <span class="va">df2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 16.27</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="f-statistic">
<em>F</em>-statistic<a class="anchor" aria-label="anchor" href="#f-statistic"></a>
</h5>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">F.stat</span> <span class="op">&lt;-</span> <span class="va">MSa</span> <span class="op">/</span> <span class="va">MSw</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 19.3</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="critical-values-and-p-values">Critical values and <em>p</em>-values<a class="anchor" aria-label="anchor" href="#critical-values-and-p-values"></a>
</h5>
<p>Recall that in ANOVA, we only consider the upper tail of the
<em>F</em>-distribution.</p>
<p>Critical value:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="op">(</span><span class="va">F.crit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">qf</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span>, <span class="va">df1</span>, <span class="va">df2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.239</span></span></code></pre></div>
<p><em>p</em>-value</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">F.stat</span>, <span class="va">df1</span>, <span class="va">df2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.446e-05</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="plotting-group-means-and-confidence-intervals">Plotting group means and confidence intervals<a class="anchor" aria-label="anchor" href="#plotting-group-means-and-confidence-intervals"></a>
</h3>
<p>Although we have performed the ANOVA in multiple ways and can
conclude that there is at least one difference in means between the
chainsaw brands, we still have a few tasks to perform. The first is to
plot the data in a meaningful way. With this type of data there are at
least two ways we could display the results. An example of one is below;
we’ll practice the second one in the homework assignment.</p>
<p>In an ANOVA context, confidence intervals can be constructed using
the equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>I</mi><mo>=</mo><mi>P</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mspace width="0.222em"></mspace><mi>e</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>±</mo><msub><mi>t</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn><mo>,</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo>×</mo><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">
CI = Point\: estimate \pm t_{\alpha/2,a(n-1)}\times SE
</annotation></semantics></math></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the SE</span></span>
<span><span class="va">mean.SE</span> <span class="op">&lt;-</span> <span class="fl">2.551</span> <span class="co"># hard coded from model.tables()</span></span>
<span></span>
<span><span class="co"># OR</span></span>
<span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html" class="external-link">model.tables</a></span><span class="op">(</span><span class="va">aov1</span>, type <span class="op">=</span> <span class="st">"means"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mean.SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">se</span><span class="op">)</span> <span class="co"># more explicit</span></span>
<span><span class="va">mean.SE</span></span>
<span><span class="co">#&gt; [1] 2.551</span></span>
<span></span>
<span><span class="co"># Compute confidence intervals</span></span>
<span><span class="va">tc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fl">0.975</span>, <span class="va">a</span><span class="op">*</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lowerCI</span> <span class="op">&lt;-</span> <span class="va">ybar.i</span><span class="op">$</span><span class="va">mu</span> <span class="op">-</span> <span class="va">tc</span><span class="op">*</span><span class="va">mean.SE</span></span>
<span><span class="va">upperCI</span> <span class="op">&lt;-</span> <span class="va">ybar.i</span><span class="op">$</span><span class="va">mu</span> <span class="op">+</span> <span class="va">tc</span><span class="op">*</span><span class="va">mean.SE</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ybar.i</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Brand</span>, y <span class="op">=</span> <span class="va">mu</span>, fill <span class="op">=</span> <span class="va">Brand</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lowerCI</span>, ymax <span class="op">=</span> <span class="va">upperCI</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Chainsaw kickback angle"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="lab05_anova_files/figure-html/unnamed-chunk-25-1.png" alt="Figure 1: Mean kickback angle from four chainsaw brands with 95% CI" width="480"><p class="caption">
Figure 1: Mean kickback angle from four chainsaw brands with 95% CI
</p>
</div>
</div>
<div class="section level3">
<h3 id="multiple-comparisons">Multiple comparisons<a class="anchor" aria-label="anchor" href="#multiple-comparisons"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Tukey multiple comparisons of means</span></span>
<span><span class="co">#&gt;     95% family-wise confidence level</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fit: aov(formula = angle ~ Brand, data = sawdata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Brand</span></span>
<span><span class="co">#&gt;      diff      lwr   upr  p adj</span></span>
<span><span class="co">#&gt; B-A   4.6  -2.6998  11.9 0.3079</span></span>
<span><span class="co">#&gt; C-A  12.8   5.5002  20.1 0.0007</span></span>
<span><span class="co">#&gt; D-A  -6.0 -13.2998   1.3 0.1276</span></span>
<span><span class="co">#&gt; C-B   8.2   0.9002  15.5 0.0251</span></span>
<span><span class="co">#&gt; D-B -10.6 -17.8998  -3.3 0.0037</span></span>
<span><span class="co">#&gt; D-C -18.8 -26.0998 -11.5 0.0000</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab05_anova_files/figure-html/unnamed-chunk-27-1.png" width="480" style="display: block; margin: auto;"><strong>Which brands were significantly different from one another? How
would you answer the original question at the start of this
exercise?</strong></p>
<p><br></p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="optional-exercise-not-graded">Optional exercise (not graded)<a class="anchor" aria-label="anchor" href="#optional-exercise-not-graded"></a>
</h2>
<p>A biologist wants to compare the growth of four different tree
species she is considering for use in reforestation efforts. All 32
seedlings of the four species are planted at the same time in a large
plot. Heights in meters are recorded after several years.</p>
<p>Create an R Markdown file titled “Assignment 3”. Within that
document, do the following:</p>
<ol style="list-style-type: decimal">
<li>Create an <code>R</code> chunk to load the data using:</li>
</ol>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"treedata"</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Create a header called “Hypotheses” and under this header,
indicate, in plain English, what the null and alternative hypotheses
are. Also use R Markdown’s equation features to write these hypotheses
using mathematical notation</p></li>
<li><p>Create a header called “ANOVA by hand”. Under this header,
perform an ANOVA analysis (degrees of freedom, sums-of-squares,
mean-squares, and <em>F</em>-value) without using <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>.
Compute either the critical value of <em>F</em>, or the
<em>p</em>-value. Be sure to <strong>annotate your
code</strong></p></li>
<li><p>Create a header called “ANOVA in R”. Under this header, perform
an ANOVA analysis on the data using the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function and
then again using the <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> function</p></li>
<li>
<p>Under a subheader called “ANOVA results”</p>
<ul>
<li><p>indicate whether or not the null hypothesis can be rejected at
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math>
level</p></li>
<li><p>include a well-formatted ANOVA table using the
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">broom::tidy()</a></code> function</p></li>
<li><p>create a barplot showing the effect sizes and 95% confidence
intervals around them</p></li>
</ul>
</li>
<li><p>Create a header called “Which means are different?”. Use Tukey’s
HSD test to determine which pairs of means differ at the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math>
level. Include a few sentences indicating which pairs are different. If
there is an inconsistency between the initial ANOVA results and the
post-hoc comparisons, explain why that might be the case</p></li>
</ol>
<p>A few things to remember when finishing the exercise:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Be sure to include your name in the <code>author</code> field of
the header</p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so we can see both your code and the output</p></li>
<li><p>See the R Markdown reference sheet for help with creating
<code>R</code> chunks, equations, tables, etc.</p></li>
</ul>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
