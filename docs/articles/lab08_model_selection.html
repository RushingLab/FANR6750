<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 8: Model Selection • FANR6750</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.0/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lab 8: Model Selection">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FANR6750</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fa-home"></span></a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../articles/syllabus.html"><span class="fa fas fa-book"></span> Syllabus</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/schedule.html"><span class="fa fas fa-calendar"></span> Schedule</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lectures" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-file-pdf-o"></span> Lectures</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lectures">
<li><a class="dropdown-item" href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/01_intro_to_stats/01_intro_to_stats.html">Lecture 1: Introduction to statistics</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/02_intro_to_lm/02_intro_to_lm.html">Lecture 2: Introduction to linear models</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/03_inference/03_inference.html">Lecture 3: Principles of inference</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/04_principles_of_expdesign/04_expdesign.html">Lecture 4: Principles of experimental design</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/05_t-test/05_t-test.html">Lecture 5: Linear models part 1: categorical predictor w/ 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/06_nht/06_nht.html">Lecture 6: Null hypothesis significance testings</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/07_power/07_power.html">Lecture 7: Statistical power</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/08_anova/08_anova.html">Lecture 8: Linear models part 2: categorical predictor &gt; 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/09_mult_comp/09_mult_comp.html">Lecture 9: Multiple Comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/10_regression/10_regression.html">Lecture 10: Multiple Regression</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-labs" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Labs</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-labs">
<li><a class="dropdown-item" href="../articles/lab01_intro_to_R.html">Lab 1: Introduction to R</a></li>
    <li><a class="dropdown-item" href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to projects and RMarkdown</a></li>
    <li><a class="dropdown-item" href="../articles/lab03_inference.html">Lab 3: Using R to explore sampling error</a></li>
    <li><a class="dropdown-item" href="../articles/lab04_t-tests.html">Lab 4: t-tests</a></li>
    <li><a class="dropdown-item" href="../articles/lab05_ANOVA.html">Lab 5: ANOVA</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-references" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-pencil-square-o"></span> References</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-references">
<li><a class="dropdown-item" href="../articles/homework.html">Assignment instructions</a></li>
    <li><a class="dropdown-item" href="../articles/projects_and_directories.html">Projects and directories</a></li>
    <li><a class="dropdown-item" href="../articles/RMarkdown.html">R Markdown reference</a></li>
    <li><a class="dropdown-item" href="../articles/graphics.html">Creating publication-quality graphics</a></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Lab 8: Model Selection</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2024</h4>
            
      

      <div class="d-none name"><code>lab08_model_selection.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="lab-7">Lab 7<a class="anchor" aria-label="anchor" href="#lab-7"></a>
</h3>
<ul>
<li><p>Review of linear model assumptions</p></li>
<li>
<p>Evaluating model assumptions</p>
<ul>
<li><p>Visual assessments</p></li>
<li><p>Formal tests</p></li>
</ul>
</li>
<li><p>Outliers and influential points</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="todays-topics">Today’s topics<a class="anchor" aria-label="anchor" href="#todays-topics"></a>
</h3>
<ul>
<li>
<p>Model selection approaches</p>
<ul>
<li><p>Purpose –&gt; Method</p></li>
<li>
<p>Exploration</p>
<ul>
<li><p>Variable screening</p></li>
<li><p>Stepwise Procedures</p></li>
</ul>
</li>
<li><p>Prediction</p></li>
</ul>
</li>
</ul>
<p><br></p>
</div>
<div class="section level2">
<h2 id="model-selection-approaches">Model Selection Approaches<a class="anchor" aria-label="anchor" href="#model-selection-approaches"></a>
</h2>
<div class="section level4">
<h4 id="purpose-precedes-method">Purpose precedes method<a class="anchor" aria-label="anchor" href="#purpose-precedes-method"></a>
</h4>
<p>Model selection is the formal process of choosing a model (out of
possibly many) using some defined performance criterion (or several)
that somehow best describes the system. As we have seen in lecture,
there are many approaches available when it comes to model selection.
Importantly, however, we should note that the way we go about model
selection should be directly informed by the purpose of our research
study. Models which are used for exploration should not be used for
prediction. Those which are used for prediction may or may not be
helpful in the context of inference. Below, we will look at several
model selection approaches within the context of study purpose.</p>
<p><br><br></p>
</div>
</div>
<div class="section level2">
<h2 id="exploration">Exploration<a class="anchor" aria-label="anchor" href="#exploration"></a>
</h2>
<p>When a biological system is not yet well understood, exploration is
often the purpose of many research studies. Exploration is used to help
identify potential relationships between variables and can be the
motivation for the development of future hypotheses.</p>
<p>It is important to remember that the results of an exploratory study
should not be viewed as demonstrating proof of a hypothesis. It is only
providing evidence for a potential hypothesis that will need future
testing with <strong>new data</strong>.</p>
<p>Several model selection approaches are commonly used during
exploratory studies. Below, we will talk about two broad approaches,
variable screening and step-wise procedures.</p>
<div class="section level3">
<h3 id="data-example">Data example<a class="anchor" aria-label="anchor" href="#data-example"></a>
</h3>
<p>Genetic modification allows for the production of food crops which
have increased usefulness to people. These modifications may be directly
related to the nutritional content of the crop, such as increasing
digestibility, or they may broadly affect the process of crop
production, such as decreasing the time required before harvest can
occur. In either case, knowledge of the relationships between genetic
variability and phenotypic response is a necessary step in modifying a
species’ genetic structure.</p>
<p>Soybeans (<em>Glycine max</em>) are a species of legume native to
East Asia which are used worldwide for a variety of food products as
well as feed for livestock. In this dataset, a researcher is studying
the relationship between several genetic markers and the flowering time
of soybean plants. In each row of the dataset, the average flowering
time of 10 soybean plants of a particular variety are recorded as well
as the parental type (A or H) of each of 141 genetic markers.</p>
<p><br></p>
<p>Import the data into <code>R</code> and examine the dataset</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rushinglab.github.io/FANR6750">FANR6750</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'soybeandata'</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="variable-screening">Variable screening<a class="anchor" aria-label="anchor" href="#variable-screening"></a>
</h4>
<p>Having seen the data set, it is clear that there are many more
possible predictor variables than we would like to put into one model.
Determining which to include and which to leave out, however, can be a
tedious process (especially with so many). We will begin this process
using variable screening. This will involve determining a subset of the
possible predictors which have the strongest relationships with the
response variable.</p>
<p>Note: The code used to set up this analysis is complex. Do not worry
too much about getting bogged down in the details of how this data
management is done. The main principles being demonstrated here can be
seen with other simpler datasets as well.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hoxo-m/magicfor" class="external-link">magicfor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a dataframe which contains only the genetic markers</span></span>
<span><span class="va">genetic_matrix</span> <span class="op">&lt;-</span> <span class="va">soybeandata</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">genetic_matrix</span> <span class="op">&lt;-</span> <span class="va">genetic_matrix</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_if</a></span><span class="op">(</span><span class="va">is.character</span>,<span class="va">as.factor</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function which stores the results from a for loop</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/magicfor/man/magic_for.html" class="external-link">magic_for</a></span><span class="op">(</span><span class="va">print</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">genetic_matrix</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">output1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">soybeandata</span><span class="op">$</span><span class="va">Flower09</span> <span class="op">~</span><span class="va">genetic_matrix</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">output2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">output1</span><span class="op">$</span><span class="va">statistic</span>,<span class="va">output1</span><span class="op">$</span><span class="va">stderr</span>,<span class="va">output1</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="va">output3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"marker"</span>,<span class="va">i</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,<span class="va">output2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">output3</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Above, we see our first example of a for loop in this course. For
loops allow us to execute a set of statements in an iterative way which
can greatly reduce the number of code lines we have to write.</p>
<p>The above loop works by iterating through each column of the
<code>genetic_matrix</code> dataframe and performing multiple tasks.
First, the loop conducts a t-test using the two levels (A and H) within
a particular genetic marker as the grouping variable and flowering time
as the response. The for loop does this for each of the 141 genetic
markers. Next, the loop stores the t-test output, rounds those values,
and assigns each of them to a particular marker.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This line uses the magic_for() function to save the output of the for loop as a dataframe</span></span>
<span><span class="va">flower_output1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/magicfor/man/magic_result_as_dataframe.html" class="external-link">magic_result_as_dataframe</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Above, we have saved the output from our for loop into a dataframe.
The format of the data, however, is not very convenient. All of the
information has been piled into one column. Below, we can take the
values and spread them out into a matrix which will make them easier to
view and work with.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flower_output</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">flower_output1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,nrow<span class="op">=</span><span class="fl">141</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Creates more informative column names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">flower_output</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"marker"</span>, <span class="st">"t.stat"</span>,<span class="st">"Std.Error"</span>,<span class="st">"pval"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">flower_output</span><span class="op">$</span><span class="va">pval</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">flower_output</span><span class="op">$</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now that we have conducted all of these t-tests, we need a way of
deciding which genetic markers to consider. In this case, it would be
wise to be somewhat liberal in our approach. We don’t want to miss any
potential relationships so we will want to retain the markers for which
the t-test was anywhere near significant. We can do this by filtering
only the t-tests which have a p-value &lt; 0.1.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flower_marker1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">flower_output</span>, <span class="va">flower_output</span><span class="op">$</span><span class="va">pval</span><span class="op">&lt;</span><span class="fl">0.10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">flower_marker1</span><span class="op">)</span></span>
<span><span class="co">#&gt;     marker  t.stat Std.Error   pval</span></span>
<span><span class="co">#&gt; 1 marker12 -1.9443    3.3881 0.0599</span></span>
<span><span class="co">#&gt; 2 marker13 -2.4719    2.9354 0.0159</span></span>
<span><span class="co">#&gt; 3 marker14 -2.7228    2.9659 0.0081</span></span>
<span><span class="co">#&gt; 4 marker15 -2.4083    3.1559 0.0191</span></span>
<span><span class="co">#&gt; 5 marker16 -2.6763    2.9922 0.0093</span></span>
<span><span class="co">#&gt; 6 marker17 -1.7569    2.9337 0.0831</span></span></code></pre></div>
<p>From the above dataframe, we can see that there were 36 genetic
markers which may be somewhat related to flowering time.</p>
<p>Below we can take a subset of our original dataset, selecting only
the columns that correspond to the potentially relevant genetic
markers.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flower_data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">soybeandata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>, <span class="va">genetic_matrix</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">genetic_matrix</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span>    <span class="va">flower_marker1</span><span class="op">$</span><span class="va">marker</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">flower_data2</span> <span class="op">&lt;-</span> <span class="va">flower_data2</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p>Note: In reality, if our purpose in this analysis was simply to
determine which genetic markers may have some relationship with soybean
flowering time, we would be done after this step. This information could
now be used to further genetic research with the goal of minimizing
flowering time. We will continue to use this dataset below, however, to
demonstrate how we might construct a parsimonious model estimating
flowering time from a large number of predictor variables.</p>
</div>
<div class="section level4">
<h4 id="step-wise-procedures">Step-wise procedures<a class="anchor" aria-label="anchor" href="#step-wise-procedures"></a>
</h4>
<p>Now that we have screened our set of predictor variables, we can
attempt to construct a parsimonious model. The problem, however, is that
we still have 36 potential predictors. <strong>How do we decide which to
include in the model?</strong></p>
<p>Three step-wise procedures exist (forward selection, backward
elimination, and stepwise regression) which could be used to resolve
this issue. Below we will see all three in action.</p>
<p><strong>Forward selection</strong> works by starting with the
simplest possible model (the intercept only model) and adding one
predictor variable at a time. The computer will iteratively create a
single variable model for each predictor and choose the predictor with
the smallest p-value less than alpha (the most significant). Having
chosen the first predictor, it will then create a set of two variable
models (always containing the most significant and then one each of all
the other possible predictors) and select the best two variable model.
Larger and larger models will be constructed until either the number of
possible predictors is exhausted or the addition of another predictor is
not considered significant (the p-value for that predictor is greater
than alpha).</p>
<p><strong>Backward elimination</strong> works in exactly the opposite
way. The most complex model is specified and predictors are dropped one
at a time (the least significant predictor is dropped first) until all
of the remaining predictors in the model are significant (p-value less
than alpha).</p>
<p><strong>Stepwise regression</strong> can be thought of as doing both
of these processes at once. Working from both ends (the intercept only
model and the full model) a set of predictors somewhere in the middle is
determined to be appropriate (there are multiple variations of how
exactly this can be performed).</p>
<p><br></p>
<p><strong>Some things to consider:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Because of how these procedures are performed (one variable added
or removed at a time) it is possible to miss the ‘optimal’ model. This
is especially true with correlated predictors where the inclusion or
removal of one may affect how meaningful it is to include
another.</p></li>
<li><p>Stepwise procedures tend to select smaller models than might be
helpful for prediction.</p></li>
<li><p>Different procedures can arrive at different ‘optimal’ models. In
that case, other metrics (adjusted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>,
root mean square error, predicted residuals sums of squares, or Mallow’s
CP) should be considered.</p></li>
</ol>
<p><br><br></p>
<p>We can begin by specifying the intercept only model and the full
model. Next, we will tell <code>R</code> which stepwise procedure to
perform. In this case, we will try all three.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fitting the models</span></span>
<span><span class="va">intercept_only</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Flower09</span><span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span> <span class="va">flower_data2</span><span class="op">)</span></span>
<span><span class="va">full.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Flower09</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span> <span class="va">flower_data2</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">forward.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></span><span class="op">(</span><span class="va">intercept_only</span>, direction<span class="op">=</span> <span class="st">'forward'</span>, scope<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">full.model</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">backward.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></span><span class="op">(</span><span class="va">full.model</span>, direction<span class="op">=</span> <span class="st">'backward'</span>, scope<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">full.model</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">both.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></span><span class="op">(</span><span class="va">intercept_only</span>, direction<span class="op">=</span> <span class="st">'both'</span>, scope<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">full.model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">forward.model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Flower09 ~ marker125 + marker110 + marker139 + marker14 + </span></span>
<span><span class="co">#&gt;     marker66 + marker19 + marker92 + marker34 + marker47 + marker112 + </span></span>
<span><span class="co">#&gt;     marker117, data = flower_data2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -22.561  -8.201  -1.903   5.712  39.848 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   65.178      2.596  25.106  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; marker125H     7.617      2.295   3.318  0.00115 ** </span></span>
<span><span class="co">#&gt; marker110H   -16.185      5.165  -3.133  0.00210 ** </span></span>
<span><span class="co">#&gt; marker139H     9.909      2.815   3.520  0.00058 ***</span></span>
<span><span class="co">#&gt; marker14H      6.173      2.396   2.577  0.01098 *  </span></span>
<span><span class="co">#&gt; marker66H      6.281      2.162   2.905  0.00426 ** </span></span>
<span><span class="co">#&gt; marker19H      6.047      2.246   2.693  0.00793 ** </span></span>
<span><span class="co">#&gt; marker92H     -5.943      2.207  -2.693  0.00792 ** </span></span>
<span><span class="co">#&gt; marker34H      4.931      2.549   1.935  0.05500 .  </span></span>
<span><span class="co">#&gt; marker47H      4.226      2.183   1.936  0.05484 .  </span></span>
<span><span class="co">#&gt; marker112H    10.321      5.403   1.910  0.05808 .  </span></span>
<span><span class="co">#&gt; marker117H    -4.234      2.389  -1.772  0.07852 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 13.06 on 143 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.4004, Adjusted R-squared:  0.3542 </span></span>
<span><span class="co">#&gt; F-statistic:  8.68 on 11 and 143 DF,  p-value: 1.175e-11</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">backward.model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Flower09 ~ marker15 + marker19 + marker34 + marker47 + </span></span>
<span><span class="co">#&gt;     marker66 + marker92 + marker110 + marker112 + marker116 + </span></span>
<span><span class="co">#&gt;     marker125 + marker139, data = flower_data2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -22.618  -7.923  -2.788   6.597  40.008 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   65.309      2.599  25.126  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; marker15H      6.219      2.469   2.519 0.012877 *  </span></span>
<span><span class="co">#&gt; marker19H      5.426      2.294   2.365 0.019365 *  </span></span>
<span><span class="co">#&gt; marker34H      5.363      2.558   2.097 0.037793 *  </span></span>
<span><span class="co">#&gt; marker47H      4.456      2.180   2.044 0.042772 *  </span></span>
<span><span class="co">#&gt; marker66H      6.306      2.177   2.896 0.004368 ** </span></span>
<span><span class="co">#&gt; marker92H     -6.121      2.214  -2.764 0.006459 ** </span></span>
<span><span class="co">#&gt; marker110H   -15.154      5.168  -2.932 0.003919 ** </span></span>
<span><span class="co">#&gt; marker112H     9.298      5.448   1.707 0.090046 .  </span></span>
<span><span class="co">#&gt; marker116H    -4.015      2.533  -1.585 0.115144    </span></span>
<span><span class="co">#&gt; marker125H     7.894      2.304   3.426 0.000800 ***</span></span>
<span><span class="co">#&gt; marker139H     9.550      2.832   3.372 0.000961 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 13.12 on 143 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.3952, Adjusted R-squared:  0.3486 </span></span>
<span><span class="co">#&gt; F-statistic: 8.493 on 11 and 143 DF,  p-value: 2.061e-11</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">both.model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Flower09 ~ marker125 + marker110 + marker139 + marker14 + </span></span>
<span><span class="co">#&gt;     marker66 + marker19 + marker92 + marker34 + marker47 + marker112 + </span></span>
<span><span class="co">#&gt;     marker117, data = flower_data2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -22.561  -8.201  -1.903   5.712  39.848 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   65.178      2.596  25.106  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; marker125H     7.617      2.295   3.318  0.00115 ** </span></span>
<span><span class="co">#&gt; marker110H   -16.185      5.165  -3.133  0.00210 ** </span></span>
<span><span class="co">#&gt; marker139H     9.909      2.815   3.520  0.00058 ***</span></span>
<span><span class="co">#&gt; marker14H      6.173      2.396   2.577  0.01098 *  </span></span>
<span><span class="co">#&gt; marker66H      6.281      2.162   2.905  0.00426 ** </span></span>
<span><span class="co">#&gt; marker19H      6.047      2.246   2.693  0.00793 ** </span></span>
<span><span class="co">#&gt; marker92H     -5.943      2.207  -2.693  0.00792 ** </span></span>
<span><span class="co">#&gt; marker34H      4.931      2.549   1.935  0.05500 .  </span></span>
<span><span class="co">#&gt; marker47H      4.226      2.183   1.936  0.05484 .  </span></span>
<span><span class="co">#&gt; marker112H    10.321      5.403   1.910  0.05808 .  </span></span>
<span><span class="co">#&gt; marker117H    -4.234      2.389  -1.772  0.07852 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 13.06 on 143 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.4004, Adjusted R-squared:  0.3542 </span></span>
<span><span class="co">#&gt; F-statistic:  8.68 on 11 and 143 DF,  p-value: 1.175e-11</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">forward.model</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1250.027</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">backward.model</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1251.367</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">both.model</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1250.027</span></span></code></pre></div>
<p><br></p>
<p>Notice the differences in the results of each of these three
approaches. Not all of the predictors are in common across all three
models. The AIC values differ slightly across the models. What does this
tell us? Additionally, notice the adjusted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
value which is the proportion of the variability in the response that is
explained by the predictors. While slightly different across each model,
none of them are particularly good.</p>
<p><strong>Why is this?</strong></p>
<p><br></p>
<p>This model was designed for the purpose of exploration not
prediction. It makes sense that given how many genetic markers there
were total, this handful of them is not going to predict most of the
variation in flowering time. What this model does do though, is provide
an opportunity to explore hypotheses in future studies.</p>
<p><br><br></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="prediction">Prediction<a class="anchor" aria-label="anchor" href="#prediction"></a>
</h2>
<p>Now we will see an example of how we can use model selection for the
purpose of prediction. Here, we would like to select a model which not
only performs well for the initial dataset, but can also be used to
create accurate predictions when presented with new data.</p>
<p>One way we can do this without having to have two completely separate
datasets is by using cross validation. In this example, we will use a
particular kind of cross validation known as K-fold. The conceptual
steps of K-fold cross validation for model selection are as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Randomly divide the data set into <em>k</em> number of groups
(preferably equal size)</p></li>
<li><p>Fit a model to all but one of the groups</p></li>
<li><p>Calculate a metric such as MSE using the observations from the
k-th group that was not used to train the model</p></li>
<li><p>Repeat this process k-number of times using each group</p></li>
<li><p>Calculate the overall MSE as the average of each calculated
above</p></li>
<li><p>Repeat this process for each separate model you wish to
compare</p></li>
<li><p>Compare the metric to the estimated metric from other possible
models to select the ‘best’ model</p></li>
</ol>
<div class="section level3">
<h3 id="data-example-1">Data example<a class="anchor" aria-label="anchor" href="#data-example-1"></a>
</h3>
<p>Growth of grasses on ranches can be affected by many factors. In this
example, researchers have developed three models which they would like
to use to predict grass growth (Kg dry matter per hectare). One of these
models contains abiotic factors (gallons of water, ppm soil salinity,
and % soil nitrogen) while another contains biotic factors (% pest cover
and number of grazers on the plot) and the third contains both.</p>
<p><br></p>
<p>Load the data set and examine the data</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'grasslanddata'</span><span class="op">)</span></span></code></pre></div>
<p>Below, we have specified our three models</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">KgDMHA</span><span class="op">~</span> <span class="va">Water</span> <span class="op">+</span> <span class="va">Salinity</span> <span class="op">+</span> <span class="va">Nitrogen</span>, data<span class="op">=</span> <span class="va">grasslanddata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = KgDMHA ~ Water + Salinity + Nitrogen, data = grasslanddata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2991.99  -652.64    27.78   654.49  3105.87 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  4.373e+02  3.162e+02   1.383    0.167    </span></span>
<span><span class="co">#&gt; Water        7.154e-03  3.805e-04  18.802   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Salinity    -1.189e+02  9.003e+00 -13.207   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Nitrogen     4.556e+02  3.969e+01  11.479   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 958.3 on 996 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.395,  Adjusted R-squared:  0.3931 </span></span>
<span><span class="co">#&gt; F-statistic: 216.7 on 3 and 996 DF,  p-value: &lt; 2.2e-16</span></span>
<span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">KgDMHA</span><span class="op">~</span> <span class="va">Pests</span> <span class="op">+</span> <span class="va">Graze</span>, data<span class="op">=</span> <span class="va">grasslanddata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = KgDMHA ~ Pests + Graze, data = grasslanddata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2659.53  -571.16     4.26   601.87  2453.67 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 10115.034    134.935   74.96   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Pests         -40.570      1.964  -20.66   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Graze         -57.924      2.349  -24.66   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 873 on 997 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.4974, Adjusted R-squared:  0.4964 </span></span>
<span><span class="co">#&gt; F-statistic: 493.4 on 2 and 997 DF,  p-value: &lt; 2.2e-16</span></span>
<span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">KgDMHA</span><span class="op">~</span> <span class="va">Water</span> <span class="op">+</span> <span class="va">Salinity</span> <span class="op">+</span> <span class="va">Nitrogen</span> <span class="op">+</span> <span class="va">Pests</span> <span class="op">+</span> <span class="va">Graze</span>, data<span class="op">=</span> <span class="va">grasslanddata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = KgDMHA ~ Water + Salinity + Nitrogen + Pests + Graze, </span></span>
<span><span class="co">#&gt;     data = grasslanddata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -829.03 -181.67    0.55  172.43  839.83 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  4.076e+03  9.471e+01   43.04   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Water        7.921e-03  1.067e-04   74.27   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Salinity    -1.161e+02  2.518e+00  -46.09   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Nitrogen     5.087e+02  1.113e+01   45.72   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Pests       -4.224e+01  6.037e-01  -69.96   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Graze       -6.237e+01  7.238e-01  -86.17   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 268 on 994 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9528, Adjusted R-squared:  0.9525 </span></span>
<span><span class="co">#&gt; F-statistic:  4010 on 5 and 994 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Next, we can tell <code>R</code> which type of cross validation we
plan to use for each model.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/" class="external-link">randomForest</a></span><span class="op">)</span></span>
<span><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method<span class="op">=</span> <span class="st">'cv'</span>, number<span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">abiotic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span><span class="va">KgDMHA</span><span class="op">~</span> <span class="va">Water</span> <span class="op">+</span> <span class="va">Salinity</span> <span class="op">+</span> <span class="va">Nitrogen</span>, data<span class="op">=</span> <span class="va">grasslanddata</span>, trControl<span class="op">=</span> <span class="va">ctrl</span><span class="op">)</span></span>
<span><span class="co">#&gt; note: only 2 unique complexity parameters in default grid. Truncating the grid to 2 .</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">abiotic</span><span class="op">)</span></span>
<span><span class="co">#&gt; Random Forest </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1000 samples</span></span>
<span><span class="co">#&gt;    3 predictor</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; No pre-processing</span></span>
<span><span class="co">#&gt; Resampling: Cross-Validated (10 fold) </span></span>
<span><span class="co">#&gt; Summary of sample sizes: 900, 900, 900, 900, 900, 900, ... </span></span>
<span><span class="co">#&gt; Resampling results across tuning parameters:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   mtry  RMSE      Rsquared   MAE     </span></span>
<span><span class="co">#&gt;   2     1018.171  0.3251206  820.6387</span></span>
<span><span class="co">#&gt;   3     1022.410  0.3226034  824.3181</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; RMSE was used to select the optimal model using the smallest value.</span></span>
<span><span class="co">#&gt; The final value used for the model was mtry = 2.</span></span>
<span></span>
<span><span class="va">abiotic</span><span class="op">$</span><span class="va">resample</span></span>
<span><span class="co">#&gt;         RMSE  Rsquared      MAE Resample</span></span>
<span><span class="co">#&gt; 1  1009.4179 0.2465991 812.2030   Fold01</span></span>
<span><span class="co">#&gt; 2   877.5759 0.4966374 697.4059   Fold02</span></span>
<span><span class="co">#&gt; 3  1002.9494 0.3123534 812.6133   Fold03</span></span>
<span><span class="co">#&gt; 4  1091.2507 0.2147421 861.1355   Fold04</span></span>
<span><span class="co">#&gt; 5  1073.5266 0.2407776 896.8341   Fold05</span></span>
<span><span class="co">#&gt; 6  1073.3304 0.3580076 873.4490   Fold06</span></span>
<span><span class="co">#&gt; 7  1054.7730 0.3499639 835.0267   Fold07</span></span>
<span><span class="co">#&gt; 8   929.4439 0.3425210 751.5689   Fold08</span></span>
<span><span class="co">#&gt; 9  1031.0531 0.3837676 822.6599   Fold09</span></span>
<span><span class="co">#&gt; 10 1038.3843 0.3058360 843.4903   Fold10</span></span>
<span></span>
<span><span class="va">biotic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span><span class="va">KgDMHA</span><span class="op">~</span> <span class="va">Pests</span> <span class="op">+</span> <span class="va">Graze</span>, data<span class="op">=</span> <span class="va">grasslanddata</span>, trControl<span class="op">=</span> <span class="va">ctrl</span><span class="op">)</span></span>
<span><span class="co">#&gt; note: only 1 unique complexity parameters in default grid. Truncating the grid to 1 .</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">biotic</span><span class="op">)</span></span>
<span><span class="co">#&gt; Random Forest </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1000 samples</span></span>
<span><span class="co">#&gt;    2 predictor</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; No pre-processing</span></span>
<span><span class="co">#&gt; Resampling: Cross-Validated (10 fold) </span></span>
<span><span class="co">#&gt; Summary of sample sizes: 900, 900, 900, 900, 900, 900, ... </span></span>
<span><span class="co">#&gt; Resampling results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSE      Rsquared   MAE     </span></span>
<span><span class="co">#&gt;   974.6648  0.3958953  776.4952</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tuning parameter 'mtry' was held constant at a value of 2</span></span>
<span></span>
<span><span class="va">both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span><span class="va">KgDMHA</span><span class="op">~</span> <span class="va">Water</span> <span class="op">+</span> <span class="va">Salinity</span> <span class="op">+</span> <span class="va">Nitrogen</span> <span class="op">+</span> <span class="va">Pests</span> <span class="op">+</span> <span class="va">Graze</span>, data<span class="op">=</span> <span class="va">grasslanddata</span>, trControl<span class="op">=</span> <span class="va">ctrl</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">both</span><span class="op">)</span></span>
<span><span class="co">#&gt; Random Forest </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1000 samples</span></span>
<span><span class="co">#&gt;    5 predictor</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; No pre-processing</span></span>
<span><span class="co">#&gt; Resampling: Cross-Validated (10 fold) </span></span>
<span><span class="co">#&gt; Summary of sample sizes: 900, 900, 900, 900, 900, 900, ... </span></span>
<span><span class="co">#&gt; Resampling results across tuning parameters:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   mtry  RMSE      Rsquared   MAE     </span></span>
<span><span class="co">#&gt;   2     467.3569  0.8910970  365.6314</span></span>
<span><span class="co">#&gt;   3     463.9885  0.8832841  362.1499</span></span>
<span><span class="co">#&gt;   5     466.7486  0.8754120  364.6875</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; RMSE was used to select the optimal model using the smallest value.</span></span>
<span><span class="co">#&gt; The final value used for the model was mtry = 3.</span></span></code></pre></div>
<p><strong>Which of these models appears to more accurately predict
growth (as shown by R squared and RMSE)?</strong></p>
<p><strong>Take a look at the resample values. Why is there a different
R squared for each of the k-number of folds even though each iteration
is using the same predictor variables? </strong></p>
<p><strong>Why is the estimated R squared value for the cross validation
models lower than it was when we ran the model summaries
above?</strong></p>
<p><br><br><br></p>
</div>
</div>
<div class="section level2">
<h2 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h2>
<p>Create an R Markdown file to do the following:</p>
<ol style="list-style-type: decimal">
<li>Create an <code>R</code> chunk to load the data using:</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rushinglab.github.io/FANR6750">FANR6750</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'jaydata'</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Use the data available to fit 5 linear models which predict jay
abundance. Each model should include at least one interaction and at
least one model should have a quadratic term (1 pt).</p></li>
<li><p>Compare the AIC values of each model and determine which model
appears best (1 pt).</p></li>
<li>
<p>Construct an AIC table by hand using the equations found in the
lecture notes (2 pt).</p>
<ol style="list-style-type: lower-alpha">
<li><p>Use the equation AIC = -2log-likelihood + 2k (the log-likelihood
can be calculated using the R function logLik())</p></li>
<li><p>Determine the Akaike weight for the best performing model and
explain what that weight means in comparison to the second best
performing model</p></li>
</ol>
</li>
<li>
<p>Perform a k-fold cross validation on your top two performing
models (2 pt).</p>
<ol style="list-style-type: lower-alpha">
<li><p>Use 5 folds</p></li>
<li><p>Explain how you think the number of folds affects this process?
When do you think we might choose to use fewer or more folds?</p></li>
</ol>
</li>
</ol>
<p><br></p>
<p>A few things to remember when creating the document:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so that all code and output is visible in the knitted
document</p></li>
<li><p>Regularly knit the document as you work to check for
errors</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
