<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 7: Evaluating assumptions of Linear Models • FANR6750</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 7: Evaluating assumptions of Linear Models">
<meta property="og:description" content="FANR6750">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FANR6750</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2023.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/01_intro_to_stats/01_intro_to_stats.html">Lecture 1: Introduction to statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/02_intro_to_lm/02_intro_to_lm.html">Lecture 2: Introduction to linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/03_inference/03_inference.html">Lecture 3: Principles of inference</a>
    </li>
    <li>
      <a href="../articles/lectures/04_t-test/04_t-test.html">Lecture 4: Linear models part 1: categorical predictor w/ 2 levels</a>
    </li>
    <li>
      <a href="../articles/lectures/05_nht/05_nht.html">Lecture 5: Null hypothesis significance testings</a>
    </li>
    <li>
      <a href="../articles/lectures/06_power/06_power.html">Lecture 6: Statistical power</a>
    </li>
    <li>
      <a href="../articles/lectures/07_anova/07_anova.html">Lecture 7: Linear models part 2: categorical predictor &gt; 2 levels</a>
    </li>
    <li>
      <a href="../articles/lectures/08_mult_comp/08_mult_comp.html">Lecture 8: Multiple Comparisons</a>
    </li>
    <li>
      <a href="../articles/lectures/09_regression/09_regression.html">Lecture 9: Multiple Regression</a>
    </li>
    <li>
      <a href="../articles/lectures/10_interactions/10_interactions.html">Lecture 10: Interactions</a>
    </li>
    <li>
      <a href="../articles/lectures/11_assumptions/11_assumptions.html">Lecture 11: Evaluating assumptions</a>
    </li>
    <li>
      <a href="../articles/lectures/12_model_selection/12_model_selection.html">Lecture 12: Model selection</a>
    </li>
    <li>
      <a href="../articles/lectures/13_random_effects/13_random_effects.html">Lecture 13: Random effects</a>
    </li>
    <li>
      <a href="../articles/lectures/14_nested/14_nested.html">Lecture 14: Nested designs</a>
    </li>
    <li>
      <a href="../articles/lectures/15_split-plot/15_split-plot.html">Lecture 15: Split-plot designs</a>
    </li>
    <li>
      <a href="../articles/lectures/16_repeated_measures/16_repeated_measures.html">Lecture 16: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lectures/17_glm/17_glm.html">Lecture 17: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/18_logistic_regression/18_logistic_regression.html">Lecture 18: Logistic regression</a>
    </li>
    <li>
      <a href="../articles/lectures/19_poisson_regression/19_poisson_regression.html">Lecture 19: Poisson regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab01_intro_to_R.html">Lab 1: Introduction to R</a>
    </li>
    <li>
      <a href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to projects and RMarkdown</a>
    </li>
    <li>
      <a href="../articles/lab03_t-tests.html">Lab 3: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab04_ANOVA.html">Lab 4: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab05_multiple_regression.html">Lab 5: Multiple Regression</a>
    </li>
    <li>
      <a href="../articles/lab06_interactions.html">Lab 6: Interactions</a>
    </li>
    <li>
      <a href="../articles/lab07_linear_model_assumptions.html">Lab 7: Evaluating assumptions</a>
    </li>
    <li>
      <a href="../articles/lab08_model_selection.html">Lab 8: Model selection</a>
    </li>
    <li>
      <a href="../articles/lab09_nested.html">Lab 9: Nested designs</a>
    </li>
    <li>
      <a href="../articles/lab10_split_plot.html">Lab 10: Split-plot designs</a>
    </li>
    <li>
      <a href="../articles/lab11_repeated_measures.html">Lab 11: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lab12_glm_lr.html">Lab 12: Logistic regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework.html">Assignment instructions</a>
    </li>
    <li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/RMarkdown.html">R Markdown reference</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Creating publication-quality graphics</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 7: Evaluating assumptions of Linear
Models</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2023</h4>
            
      
      
      <div class="hidden name"><code>lab07_linear_model_assumptions.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="lab-6">Lab 6<a class="anchor" aria-label="anchor" href="#lab-6"></a>
</h3>
<ul>
<li>
<p>Interactions in experimental design</p>
<ul>
<li><p>Visualizing interactions</p></li>
<li><p>Types of interactions</p></li>
</ul>
</li>
<li>
<p>Factorial designs</p>
<ul>
<li><p>Using aov()</p></li>
<li><p>Using lm()</p></li>
<li><p>Follow-ups</p></li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="todays-topics">Today’s topics<a class="anchor" aria-label="anchor" href="#todays-topics"></a>
</h3>
<ul>
<li>
<p>Review of linear model assumptions</p>
<ul>
<li>OLS regression and the Gauss Markov Theory</li>
</ul>
</li>
<li>
<p>Evaluating assumptions (visual assessments and tests)</p>
<ul>
<li><p>Linearity</p></li>
<li><p>Normality</p></li>
<li><p>Homoscedasticity</p></li>
<li><p>Independence</p></li>
<li><p>Multicollinearity</p></li>
</ul>
</li>
<li><p>Outliers and influential observations</p></li>
</ul>
<p><br></p>
</div>
<div class="section level2">
<h2 id="assumptions-of-linear-models">Assumptions of linear models<a class="anchor" aria-label="anchor" href="#assumptions-of-linear-models"></a>
</h2>
<p>When we are using <code>R</code> to help with data analysis, keep in
mind that, for the most part, <code>R</code> is happy to do anything
that you tell it to do. In reality though, every linear model that we
will use this semester will come with a set of assumptions. Before using
any model for data analysis, you will need to consider the assumptions
of that model and decide whether or not it is reasonable to make those
assumptions. If it is, that model may be appropriate for that analysis;
if it is not, you will need to consider other options. <strong>Because
we have limited time in this course, for the most part we will not delve
into other modeling options including nonparametric tests, GLMS, and
data transformation methods. Several other courses on campus, however,
directly tackle these approaches.</strong></p>
<p>All linear models have at least 6 explicit assumptions. In this
course, we will primarily consider the first 4 of these assumptions, but
it is good to know that the others (and usually more) exist.</p>
<p>As we go through these assumptions try to find in our linear model
where these assumptions show up (some are more subtle than others).</p>
<ol style="list-style-type: decimal">
<li>
<strong>Linearity:</strong> We assume that the relationship between
x and y is linear</li>
</ol>
<p><br></p>
<p>Note: This assumption <strong>DOES NOT</strong> mean that we need to
be able to fit a straight line through the data. Often, we will actually
used a curved line (in the cases of quadratic relationships). Rather,
this assumption means that the <strong>parameters</strong> themselves
enter the model linearly. This means that for one unit change in a
predictor, there is <strong>ALWAYS</strong> the same constant change in
the response.</p>
<p>Let’s see some examples:</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1x_1 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1x_1 + \beta_2x_1^2 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1x_1 + \beta_2x_2x_3 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
y_i = \beta_0 + x_1^{\beta_1} + \beta_2x_1^2 + \epsilon_i
\]</span> <strong>Which of the above examples are linear and which are
not?</strong></p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Normality:</strong> We assume that the residuals are
normally distributed</li>
</ol>
<p>This assumption will be important as we progress through the semester
and perform hypothesis testing to assess the significance of predictor
variables. While normality of residuals is not required, it suggests
that the model is doing a good job of predicting the response (i.e. most
residuals are close to zero and larger errors are much less likely).</p>
<p><br><br></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>Homoscedasticity:</strong> We assume that the residuals have
a constant variance across all levels or values of x (if not, we refer
to that as heterscedasticity)</li>
</ol>
<div class="figure" style="text-align: left">
<img src="lab07_linear_model_assumptions_files/figure-html/unnamed-chunk-1-1.png" alt="**Figure 1: Residuals from linear model across a range of x (predictor variable). Heteroscedasticity is demonstrated as a funnel shape.**" width="768"><p class="caption">
<strong>Figure 1: Residuals from linear model across a range of x
(predictor variable). Heteroscedasticity is demonstrated as a funnel
shape.</strong>
</p>
</div>
<p><br><br></p>
<p><strong>When might this assumption be violated?</strong></p>
<ul>
<li>In time series</li>
<li>In cross sectional studies</li>
</ul>
<p><br><br></p>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>Independence:</strong> We assume that the residuals are
independent of one another and independent of predictors.</li>
</ol>
<p>This assumption means that we cannot predict the size of a residual
from another residual (autocorrelation) or from the value of a predictor
variable (endogeneity).</p>
<p><strong>When might this assumption be violated?</strong></p>
<p><br><br></p>
<ol start="5" style="list-style-type: decimal">
<li>
<strong>Unbiased estimator:</strong> We assume that the residuals
are centered on zero.</li>
</ol>
<p>If the residuals are centered on zero, then our estimate of the
parameter is doing a good job of approximating the true value of the
parameter. If the residuals are not centered on zero, then the model is
either consistenly under or over estimating the parameter values (a
biased estimator).</p>
<div class="figure" style="text-align: left">
<img src="lab07_linear_model_assumptions_files/figure-html/unnamed-chunk-2-1.png" alt="**Figure 2: Histogram of residuals from linear model demonstrating biased estimator.**" width="768"><p class="caption">
<strong>Figure 2: Histogram of residuals from linear model demonstrating
biased estimator.</strong>
</p>
</div>
<p><br></p>
<p>Note: When we are using least squares regression, we assume that our
estimators are unbiased. An unbiased estimator is not
<strong>always</strong> desirable though (or even realistic
[e.g. estimating <span class="math inline">\(\lambda^2\)</span> or <span class="math inline">\(e^{-\lambda}\)</span> for a poisson
distribution]). In general, <em>bias</em> and <em>variance</em> are both
just forms of error in the model. One is not inherently worse than the
other. See <a href="http://www-biba.inrialpes.fr/Jaynes/cc17h.pdf" class="external-link">here</a> for an in
depth discussion of this topic from one of the founders of modern
probability theory.</p>
<p>Remember that the total error (MSE) can be calculated as:</p>
<p><span class="math display">\[
MSE = Bias(\hat\beta)^2 + Var(\hat\beta)
\]</span></p>
<p><strong>When might a biased estimator be advantageous?</strong></p>
<p><br><br></p>
<ol start="6" style="list-style-type: decimal">
<li>
<strong>Independent predictors:</strong> We assume that when using
multiple predictor variables, they are <em>relatively</em> independent
from one another.</li>
</ol>
<p>If one explanatory variable is able to be partially predicted using
others (the information provided by the variable is somewhat redundant)
then we refer to that as multicollinearity. In general, linear models
are able to withstand a great deal of multicollinearity. These methods,
however, are not able to deal with situations where a predictor variable
is completely redundant. In this case, the Gram matrix [<span class="math inline">\(X'X\)</span>] is not invertible (singular;
i.e. the matrix algebra isn’t defined).</p>
<p><strong>What are some other issues we might consider when thinking
about whether multicollinearity will affect our model?</strong></p>
<ul>
<li><p>Standard error of estimates</p></li>
<li><p>Stability of parameters (inference)</p></li>
<li><p>Issues with model selection (effect on penalty terms and
parsimony)</p></li>
<li><p>Cost of data collection</p></li>
<li><p>Unreasonable or impossible predictions (due to impossible
combinations of predictor values)</p></li>
</ul>
<p><br><br></p>
<p><strong>What are some examples where multicollinearity might
happen?</strong></p>
<ul>
<li><p>Predicting nest survival using both Fahrenheit and
Celsius</p></li>
<li><p>Predicting presence of birds using all % land use
categories</p></li>
<li><p>Predicting movement of fish using dissolved oxygen, salinity, and
conductivity</p></li>
</ul>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="ordinary-least-squares-regression-and-the-gauss-markov-theory">Ordinary Least Squares Regression and the Gauss Markov Theory<a class="anchor" aria-label="anchor" href="#ordinary-least-squares-regression-and-the-gauss-markov-theory"></a>
</h2>
<p>All of the assumptions of linear models above can be traced back to
the method we will be using (ordinary least squares regression) and the
theory that helps explain it (Gauss Markov Theory). The method of OLS
regression works by minimizing the sum of the squared residuals. The
Gauss Markov Theory says that when the assumptions listed above are
reasonably met, this minimum can be obtained in a straightforward way,
will be unique, and will be the Best Linear Unbiased Estimator.
Namely:</p>
<p><span class="math display">\[
\hat\beta = (X'X)^{-1}X'y
\]</span></p>
<p>While this formula may look somewhat daunting, remember that we have
all the information we need in the form of our data. We have our X
matrix (the variables being used as predictors) and we have our vector
of y (the response variable). All that remains is to perform some matrix
algebra to obtain our vector of <span class="math inline">\(\hat\beta\)</span>’s.</p>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="evaluating-model-assumptions-in-r">Evaluating model assumptions in R<a class="anchor" aria-label="anchor" href="#evaluating-model-assumptions-in-r"></a>
</h2>
<p>Above, we have seen many of the assumptions that are made when using
linear modeling as a tool for data analysis. Now we will look at how we
might evaluate our data to see if they meet those assumptions or if they
deviate enough that we will need to adjust our methods.</p>
<div class="section level3">
<h3 id="data-example">Data example<a class="anchor" aria-label="anchor" href="#data-example"></a>
</h3>
<p>Deer hunters are often interested in knowing what variables affect
deer movement rates. Presumably deer should move more during certain
conditions and less during others. Knowing what affects this change can
help hunters to know when their hunt is most likely to be
profitable.</p>
<p>Below is a dataset containing information about 150 radio collared
bucks. The total movement (m) in one day was recorded for each deer
across several tracts of land in Arkansas. Other information which was
also collected includes the day on which the tracking was conducted
(either the last day before hunting season starts, the day hunting
season starts, or the first day after hunting season ends), the average
temperature (F) on that day, the average wind speed (mi/hr) on that day,
and the patch size (categorical) where the deer resides.</p>
<p>Let’s start by loading the <code>deerdata</code> dataset and
examining the data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'deerdata'</span><span class="op">)</span></span></code></pre></div>
<p>We should also examine the structure and summary of the dataset:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">deerdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    150 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;  $ Deer    : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ Movement: int  6676 6290 5038 6849 7313 6725 7471 5845 9220 5138 ...</span></span>
<span><span class="co">#&gt;  $ Season  : chr  "Prehunt" "Prehunt" "Prehunt" "Prehunt" ...</span></span>
<span><span class="co">#&gt;  $ Temp    : int  47 56 68 54 51 47 58 64 50 52 ...</span></span>
<span><span class="co">#&gt;  $ Wind    : int  12 14 12 14 20 20 13 16 17 21 ...</span></span>
<span><span class="co">#&gt;  $ Patch   : chr  "Medium" "Large" "Large" "Medium" ...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">deerdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Deer          Movement       Season               Temp     </span></span>
<span><span class="co">#&gt;  Min.   :  1.0   Min.   :1198   Length:150         Min.   :30.0  </span></span>
<span><span class="co">#&gt;  1st Qu.: 38.2   1st Qu.:1636   Class :character   1st Qu.:55.0  </span></span>
<span><span class="co">#&gt;  Median : 75.5   Median :3914   Mode  :character   Median :58.0  </span></span>
<span><span class="co">#&gt;  Mean   : 75.5   Mean   :3952                      Mean   :58.6  </span></span>
<span><span class="co">#&gt;  3rd Qu.:112.8   3rd Qu.:5806                      3rd Qu.:63.0  </span></span>
<span><span class="co">#&gt;  Max.   :150.0   Max.   :9662                      Max.   :76.0  </span></span>
<span><span class="co">#&gt;       Wind         Patch          </span></span>
<span><span class="co">#&gt;  Min.   : 6.0   Length:150        </span></span>
<span><span class="co">#&gt;  1st Qu.:13.2   Class :character  </span></span>
<span><span class="co">#&gt;  Median :16.0   Mode  :character  </span></span>
<span><span class="co">#&gt;  Mean   :15.9                     </span></span>
<span><span class="co">#&gt;  3rd Qu.:19.0                     </span></span>
<span><span class="co">#&gt;  Max.   :24.0</span></span></code></pre></div>
<p><br></p>
<p>It appears that two of the variables are being read as characters but
we will want them to be factors. In this case, it also makes sense to
manually define the factor levels.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deerdata</span><span class="op">$</span><span class="va">Season</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">deerdata</span><span class="op">$</span><span class="va">Season</span>, levels<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Prehunt'</span>, <span class="st">'Hunt'</span>, <span class="st">'Posthunt'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">deerdata</span><span class="op">$</span><span class="va">Patch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">deerdata</span><span class="op">$</span><span class="va">Patch</span>, levels<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Small'</span>, <span class="st">'Medium'</span>, <span class="st">'Large'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p>The researchers who set up this study already have a model in mind.
Before they write up their conclusions though, they have come to you to
check the model assumptions to see how reasonably they are being
met.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Movement</span><span class="op">~</span> <span class="va">Temp</span> <span class="op">+</span> <span class="va">Wind</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Wind</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">Season</span> <span class="op">+</span> <span class="va">Patch</span> <span class="op">+</span> <span class="va">Season</span><span class="op">:</span><span class="va">Patch</span>, data<span class="op">=</span> <span class="va">deerdata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Movement ~ Temp + Wind + I(Wind^2) + Season + Patch + </span></span>
<span><span class="co">#&gt;     Season:Patch, data = deerdata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2450.0  -531.7    63.2   566.9  2271.9 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                             Estimate Std. Error t value           Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)                 9372.069   1316.724    7.12 0.0000000000547120 ***</span></span>
<span><span class="co">#&gt; Temp                         -78.587     10.986   -7.15 0.0000000000453510 ***</span></span>
<span><span class="co">#&gt; Wind                          43.743    128.385    0.34              0.734    </span></span>
<span><span class="co">#&gt; I(Wind^2)                      0.354      4.038    0.09              0.930    </span></span>
<span><span class="co">#&gt; SeasonHunt                 -1734.984    432.534   -4.01 0.0000985462680663 ***</span></span>
<span><span class="co">#&gt; SeasonPosthunt             -3955.655    441.819   -8.95 0.0000000000000021 ***</span></span>
<span><span class="co">#&gt; PatchMedium                  -87.401    415.696   -0.21              0.834    </span></span>
<span><span class="co">#&gt; PatchLarge                   854.837    421.993    2.03              0.045 *  </span></span>
<span><span class="co">#&gt; SeasonHunt:PatchMedium       510.248    502.542    1.02              0.312    </span></span>
<span><span class="co">#&gt; SeasonPosthunt:PatchMedium     3.594    529.716    0.01              0.995    </span></span>
<span><span class="co">#&gt; SeasonHunt:PatchLarge       1135.633    547.858    2.07              0.040 *  </span></span>
<span><span class="co">#&gt; SeasonPosthunt:PatchLarge  -1007.949    524.112   -1.92              0.057 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 887 on 138 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.851,  Adjusted R-squared:  0.839 </span></span>
<span><span class="co">#&gt; F-statistic: 71.7 on 11 and 138 DF,  p-value: &lt;0.0000000000000002</span></span></code></pre></div>
<p>On the surface, this looks great. The researchers have included
several predictor variables including a quadratic term for wind (perhaps
they expect a happy medium of wind conditions?) and an interaction term
that suggests that patch size may matter but only during certain
seasons.</p>
<p><strong>Can you interpret each of the parameter estimates? Which
variables ended up being significant in this model?</strong></p>
</div>
<div class="section level3">
<h3 id="evaluating-model-assumptions">Evaluating model assumptions<a class="anchor" aria-label="anchor" href="#evaluating-model-assumptions"></a>
</h3>
<div class="section level4">
<h4 id="residual-vs-fitted-plots">Residual vs fitted plots<a class="anchor" aria-label="anchor" href="#residual-vs-fitted-plots"></a>
</h4>
<p>We’ll start by creating a plot of the model residuals as a function
of the predicted values. This can be done either using base R plotting
or ggplot.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">.fitted</span>, y<span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab07_linear_model_assumptions_files/figure-html/unnamed-chunk-9-1.png" alt="**Figure 3: Residuals across a range of predicted values from Model 1**" width="768"><p class="caption">
<strong>Figure 3: Residuals across a range of predicted values from
Model 1</strong>
</p>
</div>
<p><strong>What assumptions can we examine from this plot?</strong></p>
<ol style="list-style-type: decimal">
<li><p>First, let’s consider the linearity assumption. From lecture, we
saw that deviations from linearity will appear as patterns in the
residual plot. This could show itself as consistently increasing or
decreasing values or as a quadratic relationship. There definitely
appears to be something happening in this plot that is out of the
ordinary, but only at the smallest prediction values. One possibility is
that there is some sort of upper bound in the dataset (perhaps for a
particular factor level).</p></li>
<li><p>Next, we can consider the issue of heteroscedasticity. In that
case, we would expect to see a funnel shape of residuals across the
range of predicted values (either fanning in or fanning out).
<strong>What might cause this funnel?</strong> <strong>Do you think that
is happening here?</strong></p></li>
</ol>
<p>Notice what happens if we re-create this plot but change the points
so that the color of the points represents the season of the tracking
event.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">.fitted</span>, y<span class="op">=</span> <span class="va">.resid</span>, color<span class="op">=</span> <span class="va">deerdata</span><span class="op">$</span><span class="va">Season</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab07_linear_model_assumptions_files/figure-html/unnamed-chunk-10-1.png" alt="**Figure 4: Residuals across a range of predicted values (by season) from Model 1**" width="768"><p class="caption">
<strong>Figure 4: Residuals across a range of predicted values (by
season) from Model 1</strong>
</p>
</div>
<p><strong>What seems to be happening here?</strong></p>
<p>We can now see that there appears to be a very different relationship
during the posthunt season. Additionally, there appears to be much less
variation during that season compared to the other two seasons.</p>
<p>We could see this same trend if we were to create a boxplot of
movement as a function of season.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">deerdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Season</span>, y<span class="op">=</span> <span class="va">Movement</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab07_linear_model_assumptions_files/figure-html/unnamed-chunk-11-1.png" alt="**Figure 5: Residuals as a function of tracking season from Model 1**" width="768"><p class="caption">
<strong>Figure 5: Residuals as a function of tracking season from Model
1</strong>
</p>
</div>
</div>
<div class="section level4">
<h4 id="normality-plots">Normality plots<a class="anchor" aria-label="anchor" href="#normality-plots"></a>
</h4>
<div class="section level5">
<h5 id="histograms">Histograms<a class="anchor" aria-label="anchor" href="#histograms"></a>
</h5>
<p>Next, we can check the normality of the residuals coming from our
model. We can do this in a couple ways. One is to create a histogram of
the residuals.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab07_linear_model_assumptions_files/figure-html/unnamed-chunk-12-1.png" alt="**Figure 6: Histogram of residuals from Model 1. Vertical line represents mean of the residuals.**" width="768"><p class="caption">
<strong>Figure 6: Histogram of residuals from Model 1. Vertical line
represents mean of the residuals.</strong>
</p>
</div>
<p>These histograms (and to some degree all of the plots we have made in
this lab) are notoriously subjective. Different researchers, depending
on the kinds of data they are accustomed to working with, may interpret
this plot differently. Thankfully, normality of residuals is not a
<em>strict</em> assumption of linear models and this distribution
appears <em>relatively</em> normal.</p>
<p>In addition to normality, this plot can show us information about the
bias of our estimator. As we might expect, since we have used an
unbiased estimator, the mean of the residuals should be close to zero
(which it is).</p>
</div>
<div class="section level5">
<h5 id="qq-plots">QQ plots<a class="anchor" aria-label="anchor" href="#qq-plots"></a>
</h5>
<p>We can also assess the normality assumption using QQ plots. QQ plots
essentially tell us whether or not two samples of data come from the
same distribution. For our purposes, we will plot the residuals (in
ascending order) vs the theoretical order of the residuals if they truly
came from a normal distribution. Ideally, the points in the plot should
fall along the center line. Deviations from the line can tell us a great
deal about issues in the data.</p>
<p>You can find lots of resources online which help to explain patterns
that you might see in QQ plots. One such resource can be found <a href="https://seankross.com/2016/02/29/A-Q-Q-Plot-Dissection-Kit.html" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>sample<span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Sample quantiles"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="st">"Theoretical quantiles"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab07_linear_model_assumptions_files/figure-html/unnamed-chunk-13-1.png" alt="**Figure 7: Quantile-Quantile plot of residuals from Model 1.**" width="768"><p class="caption">
<strong>Figure 7: Quantile-Quantile plot of residuals from Model
1.</strong>
</p>
</div>
</div>
</div>
<div class="section level4">
<h4 id="independence">Independence<a class="anchor" aria-label="anchor" href="#independence"></a>
</h4>
<p>We can assess the independence of residuals using an autocorrelation
function. Typically correlated residuals result from either temporal
(serial) autocorrelation or spatial autocorrelation of data points.
Autocorrelated residuals would manifest as trends along the x-axis of
the ACF plot. As we might expect, because there are no spatial or
temporal trends in our dataset, we do not see any trends in the
plot.</p>
<p>Note: while this class does not delve into time series modeling,
there are a few courses on campus which specifically address this
topic.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span>, plot<span class="op">=</span> <span class="cn">T</span>, main<span class="op">=</span> <span class="st">''</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab07_linear_model_assumptions_files/figure-html/unnamed-chunk-14-1.png" alt="**Figure 8: Autocorrelation function plot of Model 1 residuals.**" width="768"><p class="caption">
<strong>Figure 8: Autocorrelation function plot of Model 1
residuals.</strong>
</p>
</div>
</div>
<div class="section level4">
<h4 id="multicollinearity">Multicollinearity<a class="anchor" aria-label="anchor" href="#multicollinearity"></a>
</h4>
<p>We can assess multicollinearity of predictors (only the continuous
ones!) by creating a covariance matrix in <code>R</code>. There are
numerous opinions by different researchers as far as how highly
correlated predictors need to be before you consider throwing one of
them out of the model. <a href="https://onlinelibrary.wiley.com/doi/epdf/10.1111/j.1600-0587.2012.07348.x" class="external-link">Here</a>
and <a href="https://ia903007.us.archive.org/21/items/identifyingproxy470boot/identifyingproxy470boot.pdf" class="external-link">here</a>
are two papers which have addressed this issue through extensive
simulations.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot" class="external-link">corrplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">deerdata</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Movement      Temp     Wind</span></span>
<span><span class="co">#&gt; Movement   1.0000 -0.318801 0.134070</span></span>
<span><span class="co">#&gt; Temp      -0.3188  1.000000 0.008585</span></span>
<span><span class="co">#&gt; Wind       0.1341  0.008585 1.000000</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">deerdata</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, method<span class="op">=</span> <span class="st">'number'</span>, type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab07_linear_model_assumptions_files/figure-html/unnamed-chunk-16-1.png" alt="**Figure 9: Correlation matrix of predictors used in Model 1.**" width="768"><p class="caption">
<strong>Figure 9: Correlation matrix of predictors used in Model
1.</strong>
</p>
</div>
<p><br><br></p>
</div>
<div class="section level4">
<h4 id="getting-r-to-do-it-all">Getting R to do it all<a class="anchor" aria-label="anchor" href="#getting-r-to-do-it-all"></a>
</h4>
<p>While we have made each of these plots individually (which makes them
more easily edited), we can also get <code>R</code> to create all of
these plots at once.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/" class="external-link">performance</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html" class="external-link">check_model</a></span><span class="op">(</span><span class="va">mod1</span>, check<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'linearity'</span>, <span class="st">'homogeneity'</span>, <span class="st">'qq'</span>, <span class="st">'normality'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab07_linear_model_assumptions_files/figure-html/unnamed-chunk-17-1.png" alt="**Figure 10: Checking model assumptions for Model 1.**" width="768"><p class="caption">
<strong>Figure 10: Checking model assumptions for Model 1.</strong>
</p>
</div>
<p><br><br></p>
<p>We can also formally test some of these assumptions with functions in
<code>R</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Linearity</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/resettest.html" class="external-link">resettest</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  RESET test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  mod1</span></span>
<span><span class="co">#&gt; RESET = 9.6, df1 = 2, df2 = 136, p-value = 0.0001</span></span>
<span></span>
<span><span class="co"># Normality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Shapiro-Wilk normality test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  mod1$residuals</span></span>
<span><span class="co">#&gt; W = 1, p-value = 0.9</span></span>
<span></span>
<span><span class="co"># Heteroscedasticity</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/ncvTest.html" class="external-link">ncvTest</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="op">~</span> <span class="va">Season</span><span class="op">)</span> <span class="co"># Breusch-Pagan test</span></span>
<span><span class="co">#&gt; Non-constant Variance Score Test </span></span>
<span><span class="co">#&gt; Variance formula: ~ Season </span></span>
<span><span class="co">#&gt; Chisquare = 20.85, Df = 2, p = 0.00003</span></span></code></pre></div>
<p><br><br></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="outliers-and-influential-observations">Outliers and influential observations<a class="anchor" aria-label="anchor" href="#outliers-and-influential-observations"></a>
</h2>
<p>A topic which is related to the discussion of evaluating model
assumptions is the issue of outliers and influential points. First let’s
define some terms:</p>
<p><br></p>
<p>An <strong>outlier</strong> is a data point that does not fit well
into the model. These points result in very large residuals (the
predicted value is nowhere close to the actual observed value).</p>
<p>An <strong>influential observation</strong> is a data point whose
removal from the dataset would cause a large change in the model
fit.</p>
<p>An observation with high <strong>leverage</strong> is one at the
extreme end of the x-axis (think of a fulcrum) which has the potential
to pull the model predictions toward itself (be influential).</p>
<p><br></p>
<p>At first glance, these terms appear to be essentially defining the
same concept. In reality though, an outlier may or may not be
influential to the model fit and may or may not have high leverage. An
influential point may or may not be an outlier. An observation with high
leverage may or may not be influential or be an outlier. All three,
however, should be considered during the process of model
diagnostics.</p>
<p>Some great plots demonstrating these concepts from the Penn State
College of Science can be found <a href="https://online.stat.psu.edu/stat462/node/170/" class="external-link">here</a>.</p>
<p><br><br></p>
<p>Several plots can be made in <code>R</code> which will help us to
identify outliers and data points that are exerting high degrees of
leverage on the model. Below we have plotted the studentized residuals
(residuals divided by their sd) as a function of leverage. Data points
deviating too far on the y-axis from zero are considered outliers and
those with leverage exceeding a threshold (defined as a function of the
data) are considered high leverage.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/" class="external-link">olsrr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html" class="external-link">ols_plot_resid_lev</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab07_linear_model_assumptions_files/figure-html/unnamed-chunk-19-1.png" alt="**Figure 11: Studentized residuals from Model 1 as a function of leverage.**" width="768"><p class="caption">
<strong>Figure 11: Studentized residuals from Model 1 as a function of
leverage.</strong>
</p>
</div>
<p><br><br></p>
<p>Now that we have identified the presence of some outliers in our
dataset, what do we do about it?</p>
<p><br></p>
<p><strong>Some things to consider first:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Multiple outliers can mask the effect of each other.</p></li>
<li><p>An observation that is an outlier in one model may not be in
another model when different variables are included or
transformed.</p></li>
<li><p>Outliers may be more reasonable/expected in some datasets than
others. If the residuals are not normally distributed, it may be more
common to find extreme values.</p></li>
<li><p>Individual outliers are much less of a problem in a large enough
dataset.</p></li>
</ol>
<p><br></p>
<p><strong>What are our options?</strong></p>
<ol style="list-style-type: decimal">
<li><p>First, check for data entry errors. Is there a discrepancy
between the excel file and the paper datasheet? Is this value a code for
something that you don’t know about?</p></li>
<li><p>Consider the biological context. Is this value impossible
biologically? Or does it represent an extreme but potentially very
interesting phenomenon?</p></li>
<li><p>Consider excluding the observation and see how it affects your
model. This is a tricky and subjective process. Always remember to
explain your data management process including the exclusion of
observations when you write up your methods.</p></li>
</ol>
<p><br><br><br></p>
</div>
<div class="section level2">
<h2 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h2>
<p>Freshwater mussels are a group of aquatic organisms which inhabit
streams and rivers throughout the world. While typically residing at or
just below the surface of the stream substrate where they filter feed,
mussels sometimes burrow further into the substrate for a variety of
reasons. While this burrowing behavior can protect the mussels from
environmental conditions, it prevents the mussels from feeding during
that time. Researchers at UGA are interested in better understanding
what environmental conditions might cause mussels to burrow.</p>
<p>The dataset below contains information about 90 juvenile mussels
which were housed in a laboratory setting and monitored to assess their
burrowing behavior. Information related to the burrow depth (cm) was
collected as well as the temperature (F) of the system and the flow
(<span class="math inline">\(m^3\)</span>/s) through the system. To
translate the flow into biologically relevant terms, the researchers
categorized flow to represent the severity of drought which that flow
would represent. Because the researchers were interested in how these
burrow dynamics might vary across species, they used three species of
mussel in the study design. They made sure, however, that all
individuals within a particular species were approximately the same
size.</p>
<p>Your task should you choose to accept it is to help these researchers
determine whether their data reasonably meet the linear modeling
assumptions which are assumed in the model they have constructed.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Depth</span> <span class="op">=</span> <span class="va">Species</span> <span class="op">+</span> <span class="va">Temp</span> <span class="op">+</span> <span class="va">Flow</span> <span class="op">+</span> <span class="va">Drought</span></span></code></pre></div>
<p>Create an R Markdown file to do the following:</p>
<ol style="list-style-type: decimal">
<li>Create an <code>R</code> chunk to load the data using:</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'burrowdata'</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Formulate the linear model in R and interpret the results of the
model. Which predictors appear to be significant? Explain these results
in the context of the biological system.</p></li>
<li><p>Let’s start thinking about model assumptions by considering
outliers and highly influential points.</p></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Create a plot of the studentized residuals as a function of
leverage and interpret the results.</p></li>
<li><p>Are there any values which appear to be outliers? If so, can you
identify which TagID corresponds to that individual animal?<br>
Here we are presented with a problem. An outlier exists in the dataset
but we have no way of knowing whether or not it is a valid data point.
Did the data recorder mean to type 9.9? Did they enter a ‘99’ to
represent a missing value similar to how some datasets might contain a
‘-999’ or other impossible value? Did the mussel actually burrow 99cm
into the substrate?<br>
For the purposes of this analysis, remove the outlier and rerun the
model. Note whether or not this changes the significance of any of the
predictors.</p></li>
</ol>
<ol start="4" style="list-style-type: decimal">
<li>Next, let’s consider the <code>Drought</code> variable in the
model.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Although this is a categorical variable so we cannot formally
assess multicollinearity, do you think that this variable is redundant
with any other predictors?</p></li>
<li><p>Create a plot of <code>Depth</code> as a function of
<code>Flow</code> where the color of the data points in the plot
represent the <code>Drought</code> condition.</p></li>
<li><p>Explain why you think the researchers should or should not
include <code>Drought</code> in the final model.</p></li>
<li><p>Remove <code>Drought</code> from the linear model and analyze the
data again. Did any variables change in their significance? Explain why
you think this happened. Having seen this result, did your opinion
change about the utility of including <code>Drought</code> in the
model?</p></li>
</ol>
<ol start="5" style="list-style-type: decimal">
<li><p>For all of the following questions, leave <code>Drought</code>
out of the linear model such that the model now appears as
<code>Depth = Species + Temp + Flow</code>.</p></li>
<li><p>Assess the linear model assumptions by creating the following
series of plots. Below each plot, explain what assumption is being
assessed using that plot and your conclusions.</p></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Residual vs fitted plot</p></li>
<li><p>Histogram of residuals</p></li>
<li><p>QQ plot of residuals</p></li>
<li><p>Correlation plot of continuous predictors</p></li>
</ol>
<p><br></p>
<p>A few things to remember when creating the document:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so that all code and output is visible in the knitted
document</p></li>
<li><p>Regularly knit the document as you work to check for
errors</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
