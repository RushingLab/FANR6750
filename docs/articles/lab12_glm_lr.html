<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 12: Generalized linear models: Logistic Regression • FANR6750</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.0/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lab 12: Generalized linear models: Logistic Regression">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FANR6750</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../articles/syllabus.html"><span class="fa fas fa-book"></span> Syllabus</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/schedule.html"><span class="fa fas fa-calendar"></span> Schedule</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lectures" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-file-pdf-o"></span> Lectures</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lectures">
<li><a class="dropdown-item" href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/01_intro_to_stats/01_intro_to_stats.html">Lecture 1: Introduction to statistics</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/02_intro_to_lm/02_intro_to_lm.html">Lecture 2: Introduction to linear models</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/03_inference/03_inference.html">Lecture 3: Principles of inference</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/04_principles_of_expdesign/04_expdesign.html">Lecture 4: Principles of experimental design</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/05_t-test/05_t-test.html">Lecture 5: Linear models part 1: categorical predictor w/ 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/06_nht/06_nht.html">Lecture 6: Null hypothesis significance testings</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/07_power/07_power.html">Lecture 7: Statistical power</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/08_anova/08_anova.html">Lecture 8: Linear models part 2: categorical predictor &gt; 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/09_mult_comp/09_mult_comp.html">Lecture 9: Multiple Comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/10_regression/10_regression.html">Lecture 10: Multiple Regression</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-labs" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Labs</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-labs">
<li><a class="dropdown-item" href="../articles/lab01_intro_to_R.html">Lab 1: Introduction to R</a></li>
    <li><a class="dropdown-item" href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to projects and RMarkdown</a></li>
    <li><a class="dropdown-item" href="../articles/lab03_inference.html">Lab 3: Using R to explore sampling error</a></li>
    <li><a class="dropdown-item" href="../articles/lab04_t-tests.html">Lab 4: t-tests</a></li>
    <li><a class="dropdown-item" href="../articles/lab05_ANOVA.html">Lab 5: ANOVA</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-references" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-pencil-square-o"></span> References</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-references">
<li><a class="dropdown-item" href="../articles/homework.html">Assignment instructions</a></li>
    <li><a class="dropdown-item" href="../articles/projects_and_directories.html">Projects and directories</a></li>
    <li><a class="dropdown-item" href="../articles/RMarkdown.html">R Markdown reference</a></li>
    <li><a class="dropdown-item" href="../articles/graphics.html">Creating publication-quality graphics</a></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Lab 12: Generalized linear models: Logistic Regression</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2024</h4>
            
      

      <div class="d-none name"><code>lab12_glm_lr.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="lab-11">Lab 11<a class="anchor" aria-label="anchor" href="#lab-11"></a>
</h3>
<ul>
<li>
<p>Repeated Measures</p>
<ul>
<li><p>The additive model</p></li>
<li><p>Univariate approach</p></li>
<li><p>Multivariate approach</p></li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="todays-topics">Today’s topics<a class="anchor" aria-label="anchor" href="#todays-topics"></a>
</h3>
<ul>
<li>
<p>Logistic Regression</p>
<ul>
<li><p>Link functions</p></li>
<li><p>Using glm()</p></li>
<li><p>Creating plots</p></li>
</ul>
</li>
</ul>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="generalized-linear-models">Generalized Linear Models<a class="anchor" aria-label="anchor" href="#generalized-linear-models"></a>
</h2>
<p>Remember from lecture that generalized linear models (GLMs) are
useful when the response variable and predictor variables do not have an
underlying linear relationship. In this situation, instead of modeling
the response as a function of the predictors we can instead model a
function of the response (known as the link function) as a function of
the predictors. This method has many benefits including:</p>
<ul>
<li><p>The residuals don’t have to be normally distributed</p></li>
<li><p>The response variable can be binary, integer, strictly-positive,
etc…</p></li>
<li><p>The variance is not assumed to be constant</p></li>
</ul>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="logistic-regression">Logistic regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h2>
<p>One situation where a generalized linear model is useful is when we
are attempting to model a binary response variable. In this case, the
only values that our response can take on are coded as a 0 or a 1 (which
takes on which value is up to the researcher for easier
interpretation).</p>
<p><strong>What are some examples?</strong></p>
<p><br><br></p>
<ul>
<li>Presence/Absence</li>
<li>Survived/Died</li>
<li>Male/Female</li>
<li>Diseased/Healthy</li>
<li>Breeding/Nonbreeding</li>
<li>Migration/Nonmigration</li>
<li>Extinction/Nonextinction</li>
</ul>
<p><br><br></p>
<p>Let’s take a look at a data example that demonstrates this
concept.</p>
<div class="section level3">
<h3 id="example-orchid-data">Example: Orchid data<a class="anchor" aria-label="anchor" href="#example-orchid-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"orchiddata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">orchiddata</span><span class="op">)</span></span>
<span><span class="co">#&gt;   presence abundance elevation habitat</span></span>
<span><span class="co">#&gt; 1        0         0        58     Oak</span></span>
<span><span class="co">#&gt; 2        1         7       191     Oak</span></span>
<span><span class="co">#&gt; 3        0         0        43     Oak</span></span>
<span><span class="co">#&gt; 4        1        11       374     Oak</span></span>
<span><span class="co">#&gt; 5        1        11       337     Oak</span></span>
<span><span class="co">#&gt; 6        1         1        64     Oak</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
presence
</th>
<th style="text-align:right;">
abundance
</th>
<th style="text-align:right;">
elevation
</th>
<th style="text-align:left;">
habitat
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
191
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
374
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
337
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
</tbody>
</table>
<p>First, lets visualize our data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">orchiddata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">presence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Presence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="st">"Elevation (m)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="lab12_glm_lr_files/figure-html/unnamed-chunk-4-1.png" alt="**Figure 1: Observations of orchid presence and absence across a range of elevation.**" width="576"><p class="caption">
<strong>Figure 1: Observations of orchid presence and absence across a
range of elevation.</strong>
</p>
</div>
<p><br></p>
<p>Here we are interested in estimating presence. We could start by
constructing a model that estimates presence as a function of
elevation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">presence</span><span class="op">~</span> <span class="va">elevation</span>, data<span class="op">=</span> <span class="va">orchiddata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = presence ~ elevation, data = orchiddata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -0.7072 -0.3361  0.0176  0.3103  0.5196 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept) 0.394014   0.121553    3.24   0.0031 **</span></span>
<span><span class="co">#&gt; elevation   0.001464   0.000428    3.42   0.0019 **</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.384 on 28 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.295,  Adjusted R-squared:  0.269 </span></span>
<span><span class="co">#&gt; F-statistic: 11.7 on 1 and 28 DF,  p-value: 0.00194</span></span></code></pre></div>
<p>Now let’s add our model predictions to the plot from above.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">orchiddata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">presence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">orchiddata</span><span class="op">$</span><span class="va">elevation</span>, <span class="va">model_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Presence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="st">"Elevation (m)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="lab12_glm_lr_files/figure-html/unnamed-chunk-6-1.png" alt="**Figure 2: Observations of orchid presence and absence across a range of elevation. Line represents model predictions from simple linear regression (mod1)**" width="576"><p class="caption">
<strong>Figure 2: Observations of orchid presence and absence across a
range of elevation. Line represents model predictions from simple linear
regression (mod1)</strong>
</p>
</div>
<p><br></p>
<p><strong>What issues do you see with this plot? Does this look like a
reasonable way to model this response variable?</strong></p>
<p>In this case, we are presented with a problem. We have a binary
response variable
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">y_i</annotation></semantics></math>)
but it makes more sense for us to predict probability
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>i</mi></msub><annotation encoding="application/x-tex">p_i</annotation></semantics></math>)
rather than the response itself. We could derive an equation that
estimates probability as a function of our predictor variables. This is
referred to as the logistic function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mi>x</mi><mn>1</mn><mo>+</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>+</mo><msub><mi>β</mi><mi>z</mi></msub><msub><mi>x</mi><mi>z</mi></msub></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
p(x) = \frac{1}{1 + e^{-\beta_0 + \beta_1x1 + ... + \beta_zx_z}}
</annotation></semantics></math></p>
<p><br><br> Now we’ve run into another problem. <strong>What is the
issue with this equation in the context of linear modeling?</strong></p>
<p><br><br></p>
<p>Instead, we can use a link function (in this case the logit link) to
create a linear relationship between the response and the
predictors.</p>
<p>Remember from lecture the logistic regression model:</p>
<p><span class="math display">$$\Large logit(p_i) = \beta_0 +
\beta_1x_{i1} + \beta_2x_{i2} + · · · + \beta_zx_{iz}$$</span></p>
<p><span class="math display">$$\Large y_i \sim binomial(N,
p_i)$$</span> where:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
is the number of ‘trials’ (e.g. coin flips)</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>i</mi></msub><annotation encoding="application/x-tex">p_i</annotation></semantics></math>
is the probability of a success for sample unit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math></p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
is the number of predictors in our model</p></li>
</ul>
<p>Let’s start by using the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> function to model the
relationship between orchid detections (0 = not detected, 1 = detected),
habitat, and elevation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">presence</span> <span class="op">~</span> <span class="va">habitat</span> <span class="op">+</span> <span class="va">elevation</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">orchiddata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = presence ~ habitat + elevation, family = binomial(link = "logit"), </span></span>
<span><span class="co">#&gt;     data = orchiddata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span><span class="co">#&gt; (Intercept) -0.99598    1.21698   -0.82    0.413  </span></span>
<span><span class="co">#&gt; habitatOak  -0.09678    1.36752   -0.07    0.944  </span></span>
<span><span class="co">#&gt; habitatPine -0.33722    1.38157   -0.24    0.807  </span></span>
<span><span class="co">#&gt; elevation    0.01366    0.00601    2.27    0.023 *</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 34.795  on 29  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 23.132  on 26  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 31.13</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span>
<span><span class="co">#&gt;    (Intercept) habitatOak habitatPine elevation</span></span>
<span><span class="co">#&gt; 1            1          1           0        58</span></span>
<span><span class="co">#&gt; 2            1          1           0       191</span></span>
<span><span class="co">#&gt; 3            1          1           0        43</span></span>
<span><span class="co">#&gt; 4            1          1           0       374</span></span>
<span><span class="co">#&gt; 5            1          1           0       337</span></span>
<span><span class="co">#&gt; 6            1          1           0        64</span></span>
<span><span class="co">#&gt; 7            1          1           0       195</span></span>
<span><span class="co">#&gt; 8            1          1           0       263</span></span>
<span><span class="co">#&gt; 9            1          1           0       181</span></span>
<span><span class="co">#&gt; 10           1          1           0        59</span></span>
<span><span class="co">#&gt; 11           1          0           0       489</span></span>
<span><span class="co">#&gt; 12           1          0           0       317</span></span>
<span><span class="co">#&gt; 13           1          0           0        12</span></span>
<span><span class="co">#&gt; 14           1          0           0       245</span></span>
<span><span class="co">#&gt; 15           1          0           0       474</span></span>
<span><span class="co">#&gt; 16           1          0           0        83</span></span>
<span><span class="co">#&gt; 17           1          0           0       467</span></span>
<span><span class="co">#&gt; 18           1          0           0       485</span></span>
<span><span class="co">#&gt; 19           1          0           0       335</span></span>
<span><span class="co">#&gt; 20           1          0           0        20</span></span>
<span><span class="co">#&gt; 21           1          0           1       430</span></span>
<span><span class="co">#&gt; 22           1          0           1       223</span></span>
<span><span class="co">#&gt; 23           1          0           1        68</span></span>
<span><span class="co">#&gt; 24           1          0           1       483</span></span>
<span><span class="co">#&gt; 25           1          0           1        78</span></span>
<span><span class="co">#&gt; 26           1          0           1       214</span></span>
<span><span class="co">#&gt; 27           1          0           1        64</span></span>
<span><span class="co">#&gt; 28           1          0           1        73</span></span>
<span><span class="co">#&gt; 29           1          0           1       162</span></span>
<span><span class="co">#&gt; 30           1          0           1       468</span></span>
<span><span class="co">#&gt; attr(,"assign")</span></span>
<span><span class="co">#&gt; [1] 0 1 1 2</span></span>
<span><span class="co">#&gt; attr(,"contrasts")</span></span>
<span><span class="co">#&gt; attr(,"contrasts")$habitat</span></span>
<span><span class="co">#&gt; [1] "contr.treatment"</span></span></code></pre></div>
<p>Notice that we use the <code>family =</code> argument to tell
<code>R</code> that this is a logistic (i.e., binomial) glm with a logit
link function.</p>
<p><strong>What do the parameter estimates from this model represent,
including the intercept? What can we say about the effects of habitat
and elevation on the probability of detecting an orchid?</strong></p>
<p><br><br></p>
<p>As we have seen previously, we can use <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> to
estimate occurrence probability at different combinations of elevation
and habitat. For example, how does probability of occurrence differ
across elevations in oak habitat:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predData.elev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>elevation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">orchiddata</span><span class="op">$</span><span class="va">elevation</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">orchiddata</span><span class="op">$</span><span class="va">elevation</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,habitat <span class="op">=</span> <span class="st">"Oak"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predData.elev</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
elevation
</th>
<th style="text-align:left;">
habitat
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
12.00
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
<tr>
<td style="text-align:right;">
21.73
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
<tr>
<td style="text-align:right;">
31.47
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
<tr>
<td style="text-align:right;">
41.20
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
<tr>
<td style="text-align:right;">
50.94
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
<tr>
<td style="text-align:right;">
60.67
</td>
<td style="text-align:left;">
Oak
</td>
</tr>
</tbody>
</table>
<p>By default, the predictions are on the link scale so to get
confidence intervals on the probability scale, we have to back transform
using the inverse-link (<code><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis()</a></code>):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred.link</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm1</span>, newdata <span class="op">=</span> <span class="va">predData.elev</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">predData.elev</span><span class="op">$</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">pred.link</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span> <span class="co"># back transform to probability scale</span></span>
<span><span class="va">predData.elev</span><span class="op">$</span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">pred.link</span><span class="op">$</span><span class="va">fit</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">pred.link</span><span class="op">$</span><span class="va">se.fit</span><span class="op">)</span></span>
<span><span class="va">predData.elev</span><span class="op">$</span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">pred.link</span><span class="op">$</span><span class="va">fit</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">pred.link</span><span class="op">$</span><span class="va">se.fit</span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
<p>And now plot the predictions and observations:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">orchiddata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">presence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predData.elev</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predData.elev</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>,</span>
<span>              fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"longdash"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Probability of occurrence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="st">"Elevation (m)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="lab12_glm_lr_files/figure-html/unnamed-chunk-11-1.png" alt="**Figure 3: Observations of orchid presence and absence across a range of elevation. Line represents model predictions from logistic regression for Oak habitat. Dashed lines represent 95% confidence bands.**" width="576"><p class="caption">
<strong>Figure 3: Observations of orchid presence and absence across a
range of elevation. Line represents model predictions from logistic
regression for Oak habitat. Dashed lines represent 95% confidence
bands.</strong>
</p>
</div>
<p><br><br></p>
<p>What about occurrence probability in each habitat type at a
particular elevation:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predData.hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Oak"</span>, <span class="st">"Maple"</span>, <span class="st">"Pine"</span><span class="op">)</span>, elevation <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span>
<span><span class="va">pred.hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm1</span>, newdata <span class="op">=</span> <span class="va">predData.hab</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">predData.hab</span><span class="op">$</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">pred.hab</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span> <span class="co"># back transform to probability scale</span></span>
<span><span class="va">predData.hab</span><span class="op">$</span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">pred.hab</span><span class="op">$</span><span class="va">fit</span> <span class="op">-</span> <span class="va">pred.hab</span><span class="op">$</span><span class="va">se.fit</span><span class="op">)</span></span>
<span><span class="va">predData.hab</span><span class="op">$</span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">pred.hab</span><span class="op">$</span><span class="va">fit</span> <span class="op">+</span> <span class="va">pred.hab</span><span class="op">$</span><span class="va">se.fit</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predData.hab</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">habitat</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"grey60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predData.hab</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">habitat</span>, ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Probability of occurrence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span><span class="st">"Habitat type"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="lab12_glm_lr_files/figure-html/unnamed-chunk-12-1.png" alt="**Figure 4: Probability of occurence for orchids across multiple habitat types at elevation= 250m. Error bars represent approximate 95% confidence intervals.**" width="576"><p class="caption">
<strong>Figure 4: Probability of occurence for orchids across multiple
habitat types at elevation= 250m. Error bars represent approximate 95%
confidence intervals.</strong>
</p>
</div>
<p><br><br><br></p>
</div>
</div>
<div class="section level2">
<h2 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h2>
<p>Researchers want to know how latitude and landscape type influence
the probability that American Crows are infected by West Nile Virus. One
hundred crows are captured and tested for West Nile Virus in urban and
rural landscapes spanning a latitude gradient.</p>
<p>The data can be loaded using:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"crowdata"</span><span class="op">)</span></span></code></pre></div>
<p>Create an R markdown report to do the following:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a logistic regression model to the crow data to assess the
effects of latitude and landscape type (1.5 pt)</p></li>
<li><p>Include a well-formatted summary table of the parameter estimates
(1.5 pt)</p></li>
<li><p>Provide a clear interpretation of the parameter estimates in the
text (1.5 pt)</p></li>
<li>
<p>Plot the relationship between infection probability and latitude,
for rural and urban landscapes, on the same graph. The graph should
include (1.5 pt):</p>
<ul>
<li><p>the observed data points (color coded by landscape)</p></li>
<li><p>a legend</p></li>
<li><p>confidence intervals</p></li>
</ul>
</li>
</ol>
<p>You may format the report however you like but it should be
well-organized, with relevant headers, plain text, and the elements
described above.</p>
<p><br><br><br><br></p>
<p>As always:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Be sure to include your first and last name in the
<code>author</code> section</p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so we can see both your code and the output</p></li>
<li><p>See the R Markdown reference sheet for help with creating
<code>R</code> chunks, equations, tables, etc.</p></li>
<li><p>See the “Creating publication-quality graphics” reference sheet
for tips on formatting figures</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="bonus-assignment">Bonus Assignment<a class="anchor" aria-label="anchor" href="#bonus-assignment"></a>
</h2>
<p>Georgia Department of Natural Resources (GADNR) is interested in
understanding the relationship between several demographic variables and
the likelihood that a deer hunter will reach their annual harvest limit
(10 does and 2 bucks). The data collected by GADNR (which can be found
in the <code>harvestdata</code> dataset) contains:</p>
<blockquote>
<p><code>Limit</code>: Whether or not the hunter harvested their limit
(1- they did; 0- they did not)<br><code>Age</code>: Age of hunter<br><code>Fam_veh</code>: The number of vehicles owned by the
household<br><code>Drive_dist</code>: The average drive distance from the hunter’s
home to their hunting spot<br><code>Sick12</code>: The number of available sick days accumulated by
the hunter in the past 12 months<br><code>Sick24</code>: The number of available sick days accumulated by
the hunter in the past 24 months<br><code>Range_hrs</code>: The number of hours spent by the hunter at the
shooting range prior to the start of the season<br><code>Muzzleloader</code>: Whether or not the hunter participated in the
muzzleloader season (1- they did; 0- they did not)<br><code>Archery</code>: Whether or not the hunter participated in the
archery season (1- they did; 0- they did not)<br><code>Utilized</code>: The percent of available days during the hunting
season which the hunter utilized<br><code>Past_max</code>: Whether or not the hunter has harvested their
limit in a past season (1- they did; 0- they did not)<br><code>COUNTY</code>: The hunter’s county of residence</p>
</blockquote>
<p>You have been tasked with constructing a parsimonious model which can
accurately predict whether or not a hunter will harvest their limit. In
addition to constructing the model, GADNR would like you to be able to
tell them the model accuracy (i.e. what percentage of time did the model
correctly assign a 0 or 1).</p>
<p>While there are several ways you may approach this research question,
a rough outline is below:</p>
<ol style="list-style-type: decimal">
<li>Explore your dataset
<ul>
<li>Check for missing values or typos</li>
<li>Consider which variables ought to be considered numerical vs
factors</li>
<li>Check for correlation among predictors and consider removing them if
necessary (justify your reasons for the removed predictors)</li>
</ul>
</li>
</ol>
<!-- --><ol start="2" style="list-style-type: decimal">
<li>Split your dataset into a reasonably sized training and testing set.
<ul>
<li>Consider using the functions <code><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample()</a></code> and
<code><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff()</a></code>
</li>
</ul>
</li>
</ol>
<!-- --><ol start="3" style="list-style-type: decimal">
<li>Use reasonable model selection procedures to construct a
parsimonious model using your training data set.
<ul>
<li>You may use quadratic effects or interaction terms but you are not
required to.</li>
</ul>
</li>
</ol>
<!-- --><ol start="4" style="list-style-type: decimal">
<li>Test your model using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function on your
test dataset.
<ul>
<li>At this point, you can get predictions for all of the observations
in your test dataset (using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function) and you
will already have the actual observations from that set</li>
<li>Next you can convert your predictions (which are values of
probability) to ones and zeros as factors. Consider using the
<code><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse()</a></code> function for this.</li>
<li>Now you can test to see how many values in your predictions
dataframe match the corresponding value in your test set.</li>
</ul>
</li>
<li>Create a short report to GADNR explaining the model that you
constructed and your assessment of its accuracy.
<ul>
<li>Include in your report at least one figure which shows the
relationship between “Limit” and one of the continuous predictor
variables.</li>
<li>Make sure to include model predictions and 95% confidence
intervals</li>
<li>To do this you can set all other variables to either a reference
level (if categorical) or to their mean (if continuous)</li>
<li>Make sure that your figure displays multiple levels of one
categorical variable</li>
</ul>
</li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
