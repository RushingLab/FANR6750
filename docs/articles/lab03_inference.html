<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 3: Using R to explore sampling error • FANR6750</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.0/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lab 3: Using R to explore sampling error">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FANR6750</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../articles/syllabus.html"><span class="fa fas fa-book"></span> Syllabus</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/schedule.html"><span class="fa fas fa-calendar"></span> Schedule</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lectures" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-file-pdf-o"></span> Lectures</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lectures">
<li><a class="dropdown-item" href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/01_intro_to_stats/01_intro_to_stats.html">Lecture 1: Introduction to statistics</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/02_intro_to_lm/02_intro_to_lm.html">Lecture 2: Introduction to linear models</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/03_inference/03_inference.html">Lecture 3: Principles of inference</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/04_principles_of_expdesign/04_expdesign.html">Lecture 4: Principles of experimental design</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/05_t-test/05_t-test.html">Lecture 5: Linear models part 1: categorical predictor w/ 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/06_nht/06_nht.html">Lecture 6: Null hypothesis significance testings</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/07_power/07_power.html">Lecture 7: Statistical power</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/08_anova/08_anova.html">Lecture 8: Linear models part 2: categorical predictor &gt; 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/09_mult_comp/09_mult_comp.html">Lecture 9: Multiple Comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/10_regression/10_regression.html">Lecture 10: Multiple Regression</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-labs" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Labs</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-labs">
<li><a class="dropdown-item" href="../articles/lab01_intro_to_R.html">Lab 1: Introduction to R</a></li>
    <li><a class="dropdown-item" href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to projects and RMarkdown</a></li>
    <li><a class="dropdown-item" href="../articles/lab03_inference.html">Lab 3: Using R to explore sampling error</a></li>
    <li><a class="dropdown-item" href="../articles/lab04_t-tests.html">Lab 4: t-tests</a></li>
    <li><a class="dropdown-item" href="../articles/lab05_ANOVA.html">Lab 5: ANOVA</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-references" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-pencil-square-o"></span> References</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-references">
<li><a class="dropdown-item" href="../articles/homework.html">Assignment instructions</a></li>
    <li><a class="dropdown-item" href="../articles/projects_and_directories.html">Projects and directories</a></li>
    <li><a class="dropdown-item" href="../articles/RMarkdown.html">R Markdown reference</a></li>
    <li><a class="dropdown-item" href="../articles/graphics.html">Creating publication-quality graphics</a></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Lab 3: Using R to explore sampling error</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2025</h4>
            
      

      <div class="d-none name"><code>lab03_inference.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="lab-2">Lab 2<a class="anchor" aria-label="anchor" href="#lab-2"></a>
</h3>
<ul>
<li><p>Introduction to RMarkdown</p></li>
<li><p>Introduction to RProjects and directories</p></li>
<li><p>Submitting HWs</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="todays-topics">Today’s topics<a class="anchor" aria-label="anchor" href="#todays-topics"></a>
</h3>
<ul>
<li><p>Introduction</p></li>
<li><p>Data visualization using <code>ggplot2</code></p></li>
<li><p>Using <code>for</code> loops to explore sampling</p></li>
<li><p>More on confidence intervals</p></li>
<li><p>Assignment</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Today we will dive deeper into several key topics from lecture
related to statistical inference. In particular, we will use R explore
concepts related to sampling, sampling error, and sample size. In doing
so, we will also learn (or reinforce) some new skills in <code>R</code>,
including:</p>
<ul>
<li><p>Data visualizationg using <code>ggplot2</code></p></li>
<li><p>Using R’s built in functions to randomly generate samples from
probability distributions</p></li>
<li><p>Using <code>for</code> loops to repeat code many times</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="graphics">Graphics<a class="anchor" aria-label="anchor" href="#graphics"></a>
</h2>
<p><code>R</code> has very powerful graphing capabilities that make it
possible to create data visualizations for reports or publications.
Before we get started on today’s material, we will introduce a few ways
to visualize data. As with most tasks in <code>R</code>, there are many
ways to create graphs and you will find that people have very strong
feelings about the best approach.</p>
<p>The debate over graphics in <code>R</code> usually boils down to
using the built-in graphing functions (“base graphics”) vs the
<code>ggplot2</code> package. There are some advantages to both
approaches, but for the most part the newer generations of
<code>R</code> users prefer <code>ggplot2</code>. Therefore most of the
sample code provided in lab will reflect that preference. However,
<strong>I don’t care how you make your plots as long as they effectively
display the information you are trying to convey</strong>. If you prefer
base graphics, by all means use base graphics.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Keep in mind that although we will be using ggplot2, it
is a good idea to have some understanding of how base &lt;code&gt;R&lt;/code&gt;
graphics work. Most packages in &lt;code&gt;R&lt;/code&gt;, when they produce some
sort of output in the form of a plot, will still create that plot using
base &lt;code&gt;R&lt;/code&gt; graphics rather than ggplot. In order to alter those
graphics without having to start from scratch, it will be useful to know
a little about base &lt;code&gt;R&lt;/code&gt; graphics.&lt;/p&gt;"><sup>1</sup></a></p>
<p>For this exercise, we will use a small data set that comes with the
<code>FANR6750</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"thrushdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">thrushdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    100 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ calls: num  9.1 5.7 7.7 14.9 12.3 16.7 17.8 11.6 7.5 14.3 ...</span></span>
<span><span class="co">#&gt;  $ wind : chr  "high" "high" "high" "high" ...</span></span></code></pre></div>
<p>The data frame contains two columns: <code>calls</code> is the
average number of calls made by birds during a brief sampling period and
<code>wind</code> indicates whether there was high or low wind during
each sample.</p>
<div class="section level4">
<h4 id="brief-introduction-to-ggplot2">Brief introduction to <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#brief-introduction-to-ggplot2"></a>
</h4>
<p>Because the code I provide will use <code>ggplot2</code>, it is worth
briefly learning/reviewing how this package approaches data
visualization.</p>
<p>The power and flexibility of <code>ggplot2</code> come from it’s
consistent structure. Although a bit confusing at first, once you get
the hang of it, the structure actually makes it quite easy to create
highly customized visualizations. All plots created using
<code>ggplot2</code> use the same underlying structure:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><munder><mrow><mi>g</mi><mi>g</mi><mi>p</mi><mi>l</mi><mi>o</mi><mi>t</mi></mrow><mo accent="true">⏟</mo></munder><mrow><mi>i</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>a</mi><mi>t</mi><mi>e</mi><mspace width="0.278em"></mspace><mi>p</mi><mi>l</mi><mi>o</mi><mi>t</mi></mrow></munder><mrow><mo stretchy="true" form="prefix">(</mo><munder><munder><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo>=</mo><mi>d</mi><mi>f</mi></mrow><mo accent="true">⏟</mo></munder><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mspace width="0.278em"></mspace><mi>f</mi><mi>r</mi><mi>a</mi><mi>m</mi><mi>e</mi></mrow></munder><mo>,</mo><mspace width="0.278em"></mspace><munder><munder><mrow><mi>a</mi><mi>e</mi><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>=</mo><mspace width="0.278em"></mspace><mo>,</mo><mi>y</mi><mo>=</mo><mspace width="0.278em"></mspace><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mrow><mi>p</mi><mi>l</mi><mi>o</mi><mi>t</mi><mspace width="0.278em"></mspace><mi>a</mi><mi>t</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>b</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>s</mi></mrow></munder><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munder><munder><mrow><mi>g</mi><mi>e</mi><mi>o</mi><mi>m</mi><mi>_</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mrow><mi>g</mi><mi>e</mi><mi>o</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>r</mi><mi>y</mi></mrow></munder></mrow><annotation encoding="application/x-tex">\underbrace{ggplot}_{initiate\; plot} ( \underbrace{data = df}_{data\;frame},\;  \underbrace{aes(x =\; , y = \;)}_{plot\; attributes} ) + \underbrace{geom\_line()}_{geometry}</annotation></semantics></math></p>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> function initiates a new plot. In this
function, you tell <code>ggplot2</code> what data frame you will be
using for the plot (<code>ggplot</code> only accepts data frames as
input) and you tell it how to map attributes of the data to the visual
properties of the figures. Attributes are mapped inside the
<code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> argument. Attributes usually include location
(<code>x-axis</code> and <code>y-axis</code> placement), color, size,
shape, line type, and many others. In general, <strong>each attribute
will be mapped to one column of your data frame</strong>.</p>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> function simply initiates a graph - if you
run just that portion of the code you will get a blank graph. We can see
that by creating a plot showing the relationship between
<code>wind</code> (the x-axis of the plot) and <code>calls</code> (the
y-axis):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-4-1.png" width="480" style="display: block; margin: auto;"></p>
<p>You can see that <code>ggplot</code> created a figure with the
correct axes and labels. But no data. That’s because we didn’t tell
<code>ggplot</code> what type of <em>geometry</em> to use to represent
the data. Once we add a geometry, we can see the data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-5-1.png" width="480" style="display: block; margin: auto;"></p>
<p>In this case, a boxplot might make more sense:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;"></p>
<p>It’s also possible to use more than one geometry:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></p>
<p>This is reasonable figure showing call frequencies as a function of
wind. But <code>ggplot2</code> makes it very easy to tweak the way the
data is visualized (maybe too easy, you can spend <em>a lot</em> of time
tweaking minor details). For example, maybe we want to color the points
based on the wind. Because we want to map an <em>attribute</em> (color)
to a <em>variable</em> (wind), we make this change inside of
<code>aes</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span>, color <span class="op">=</span> <span class="va">wind</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;"></p>
<p>That’s not exactly what we wanted. Both the boxplot and the points
now colored a function of <code>wind</code>. To make just the points a
function of wind, we specify <code>color = wind</code> inside of the
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> function (anything in the
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> function will apply to all geoms):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">wind</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-9-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We can also do things like the change the size of the geometries. In
this case, we are <strong>not</strong> mapping a variable to an
attribute (size is not a function of the data values). So these changes
happen <strong>outside</strong> of the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> argument:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">wind</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-10-1.png" width="480" style="display: block; margin: auto;"></p>
<p>One last example. Because many of the points overlap, it can be hard
to tell how many individual points there are in each group. One way to
deal with overplotting like this is to make each point slightly
transparent. We can do that with the <code>alpha</code> parameter:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">wind</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Again, because we aren’t mapping the alpha value to any data, we
include it outside of <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code>.</p>
<hr>
</div>
<div class="section level4">
<h4 id="exercise-1">Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h4>
<p>The graph above is fine for a quick visualization of the data but
wouldn’t be appropriate for including in publications or reports. On
your own,</p>
<ol style="list-style-type: decimal">
<li><p>Improve the axis labels. This could include: title case, units,
font size, etc. Run <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">?scale_y_continuous</a></code> and
<code><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">?scale_x_discrete</a></code> if you need some help (and note the
difference between these two functions!). <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">?theme</a></code> may also
be useful</p></li>
<li><p>Manually change the color of the points
(<code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">?scale_color_manual</a></code>)</p></li>
<li><p>Instead of displaying the data using a boxplot, create histograms
showing the distribution of call densities at each level of wind
(<code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">?geom_histogram</a></code>)</p></li>
</ol>
<hr>
<p>As you learn about graphics functions, whether base or
<code>ggplot2</code>, you will probably need to look up help for how to
do certain things. Google is usually your best bet but here are a few
other good references:</p>
<ul>
<li><p>The fantastic <a href="https://clauswilke.com/dataviz/" class="external-link">Fundamentals of Data
Visualization</a> book by Claus Wilke</p></li>
<li><p>The <code>ggplot2</code> package <a href="https://ggplot2.tidyverse.org/" class="external-link">website</a></p></li>
<li><p>And, yes, even the base <code>R</code> <a href="https://www.r-graph-gallery.com/base-R.html" class="external-link">graph
gallery</a></p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="using-r-to-generate-samples">Using <code>R</code> to generate samples<a class="anchor" aria-label="anchor" href="#using-r-to-generate-samples"></a>
</h2>
<p>In lecture, we discussed the concept of <em>sampling</em> - that is,
using a randomly-selected subset of a larger population to learn about
the characteristics of that population. We will explore this idea
further in this lab, taking advantage of several built-in <code>R</code>
functions that make it very easy to simulate samples.</p>
<p>To start, let’s assume that we are interested in quantifying the body
mass of gray squirrels (<em>Sciurus carolinensis</em>) on campus.
Because we’re simulating these data, we first need to define the true
distribution of body mass (i.e., the population). For this exercise, we
will assume the mean mass of campus squirrels is 500g. Furthermore, we
will assume that body mass in this population is normally distributed (a
reasonable assumption given the central limit theorem) with a standard
deviation of 30. We can visualize the population using the code below<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This code includes some fairly advanced ggplot2 options.
Don’t worry too much about understanding each one, though it may be
useful to spend some time figuring out what each function is doing&lt;/p&gt;"><sup>2</sup></a>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">380</span>, to <span class="op">=</span> <span class="fl">620</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to shade area under normal distribution</span></span>
<span><span class="va">dnorm_one_sd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">norm_one_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span></span>
<span>  <span class="va">norm_one_sd</span><span class="op">[</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="fl">470</span> <span class="op">|</span> <span class="va">x</span> <span class="op">&gt;=</span> <span class="fl">530</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">norm_one_sd</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm_one_sd</span>, geom <span class="op">=</span> <span class="st">"area"</span>, fill <span class="op">=</span> <span class="st">"#446E9B"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">500</span>, xend <span class="op">=</span> <span class="fl">500</span>, y <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, yend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey30"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#446E9B"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="st">"Mass (g)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"mu"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>, x <span class="op">=</span> <span class="fl">500</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.0013</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-12-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Sampling from this population is simple using the built in
<code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm()</a></code> function. <code>R</code> has a number of built-in
functions to randomly generate samples from a range of probability
distributions (that’s what the <em>r</em> stands for in the function
name). In addition to <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm()</a></code>, there is
<code><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois()</a></code> (Poisson distribution), <code><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom()</a></code>
(binomial distribution), <code><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif()</a></code> (uniform distribution),
etc.</p>
<p>As with any function, you can run <code>?rnorm()</code> to get more
information about the arguments required to run this function. Briefly,
we need to define</p>
<ul>
<li><p><code>x</code>: the number of random numbers to generate,
i.e. the sample size)</p></li>
<li><p><code>mean</code>: the mean of the normal distribution (in this
case, the population mean of 500)</p></li>
<li><p><code>sd</code>: the standard deviation on the normal
distribution (in this case 30)</p></li>
</ul>
<p>Let’s start with a sample size of 15:</p>
<pre><code><span><span class="co">#&gt;  [1] 530.0 464.3 492.4 526.0 500.0 560.2 502.7 460.2 489.0 529.9 472.1 532.7</span></span>
<span><span class="co">#&gt; [13] 534.9 525.1 476.6</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">samp</span></span></code></pre></div>
<hr>
<div class="section level4">
<h4 id="exercise-2">Exercise 2<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h4>
<p><strong>Question</strong>: What are the expected values for the mean
and standard deviation of our sample?</p>
<p>Use <code>R</code> to calculate the mean and standard deviation of
the sample. How close were they to the expected values?</p>
<hr>
<p>We can also visualize how this sample compares to the population by
adding it to our previous plot<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Notice the &lt;code&gt;p&lt;/code&gt; is a ggplot object, so we can
add elements directly to it rather than repeat all the code needed to
make the previous figure&lt;/p&gt;"><sup>3</sup></a>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">samp</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_rug.html" class="external-link">geom_rug</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">samp_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span>, xend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, yend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey30"</span>, linetype <span class="op">=</span> <span class="st">"longdash"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"bar(y)"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.001</span><span class="op">)</span> </span>
<span><span class="va">p2</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-15-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Remember that because this is a random sample, your sample will be
slightly different from the one shown here.</p>
</div>
</div>
<div class="section level2">
<h2 id="exploring-variability-among-samples">Exploring variability among samples<a class="anchor" aria-label="anchor" href="#exploring-variability-among-samples"></a>
</h2>
<p>One of the most foundational topics for everything we will learn
about this semester is <em>sampling error</em>. Sampling error stems
directly from the fact that sampling is an inherently random process and
therefore no two samples will be exactly the same (and no sample will
exactly resemble the population from which it is drawn). Although
straightforward, this simple fact will form the basis of nearly every
topic we discuss this semester. In fact, this is the reason we need
statistics in the first place!</p>
<p>To explore the concept of sampling error in more detail, and to build
some intuition for how sampling error influences conclusions from our
samples, we will expand on the previous exercise by generating a very
large number of samples from the population.</p>
<p>In the real world, of course, we generally only have a single sample.
But <code>R</code> makes it easy to explore what we would see
<em>if</em> we could repeat our sampling process many times. This is
essentially the entire concept of <em>frequentist statistics</em></p>
<p>To repeat the sampling process we implemented above, we could just
copy and paste the <code>samp &lt;- rnorm(15, 500, 30)</code> code over
and over again, each time naming the sample object something
different:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">samp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">samp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">.</span></span>
<span><span class="va">.</span></span>
<span><span class="va">.</span></span>
<span><span class="va">sampN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p>But that is obviously inefficient for more than just 2-3 samples.
Anytime you find yourself needing to repeat the same code many times,
you could consider using a loop.</p>
<p>In <code>R</code>, <code>for</code> loops allow us to efficiently<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Efficient in terms of lines of code, not computational
efficiency. Loops are often very slow to run so advanced R users often
avoid them when possible&lt;/p&gt;"><sup>4</sup></a> repeat
code as many times we want. To run a <code>for</code> loop, we will
first specify how many times we want to run the loop and also create an
empty matrix that will store the samples that are created each time we
run the loop.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">15</span> <span class="co"># sample size</span></span>
<span><span class="va">nsamp</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># number of samples</span></span>
<span><span class="va">samp_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">nsamp</span><span class="op">)</span></span></code></pre></div>
<p>The syntax of the loop itself will always start with the function
<code>for()</code>. Inside the parentheses, the first thing we add is a
<em>counter</em>, which is essentially just a symbol we will use to keep
track of which iteration of the loop we are on. By convention, we will
use <code>i</code> as our counter, though we could make it pretty much
anything we want (e.g., <code>j</code>, <code>k</code>, etc<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Remember that certain letters are also functions - e.g.,
&lt;code&gt;&lt;a href="https://rdrr.io/r/base/c.html" class="external-link"&gt;c()&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href="https://rdrr.io/r/base/t.html" class="external-link"&gt;t()&lt;/a&gt;&lt;/code&gt; - so it’s good practice not to use
those letters as counters&lt;/p&gt;'><sup>5</sup></a>). After
defining the counter, we add <code>in</code> and then a sequence of
values the counter will take each time it runs the loop. We want to run
the loop 1000 times so we generate a sequence from 1 to 1000. After
defining the counter and sequence, we put all of the code we want to run
inside of curly brackets:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsamp</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">samp_mat</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Note that each time the loop runs, any place you see the counter
<code>i</code> inside the curly brackets, <code>R</code> will replace
<code>i</code> with the values specified in sequence
<code>1:nsamp</code> (the first loop, i = 1, the second loop i = 2,
etc). The code inside of the loop uses some of the indexing rules we
learned several weeks ago. Be sure you understand how this indexing
works, particularly in relation to the counter <code>i</code>.</p>
<hr>
<p>Because the counter symbol and the sequence are flexible, the
following code all does the same thing:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsamp</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">samp_mat</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">samp</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsamp</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">samp_mat</span><span class="op">[</span>,<span class="va">samp</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">samps</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsamp</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">samps</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">samp_mat</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">500</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr>
<p>The <code>samp_mat</code> object we just created contains 1000
samples from our hypothetical population of squirrels, each containing
15 observations. Although we expect the mean of each sample to be 500,
we know that there will be variation among the 1000 sample means (this
is <strong>sampling error</strong>!).</p>
<p>To explore how much variation there is among our sample means, we
first need to calculate the mean of each sample. We could do this a few
ways. First, we could use a loop<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;In fact, we could just add a second line to our previous
loop rather than run two loops&lt;/p&gt;"><sup>6</sup></a>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samp_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># object to store sample means</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsamp</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">samp_means</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samp_mat</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This works perfectly well, though because loops can be slow, many
advanced users try to avoid them when possible. <code>R</code> has
another built-in function called <code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply()</a></code> that can be very
useful for avoiding loops when we need to apply the same function to
each row or column of a matrix:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samp_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">samp_mat</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, FUN <span class="op">=</span>  <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<p>The first argument <code>X</code> is a matrix and the argument
<code>FUN</code> is the function we want to apply to each row or column
of the matrix. The <code>MARGIN</code> argument is the dimension we want
to apply the function to (1 = row, 2 = column). So in this case, we are
telling <code>R</code> to take the mean of each column of
<code>samp_mat</code>. Apply will return a vector with the mean of each
column.</p>
<p>Let’s visualize the distribution of the 1000 sample means:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">samp_means</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, <span class="va">..density..</span><span class="op">)</span>, </span>
<span>                 fill <span class="op">=</span> <span class="st">"grey50"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, binwidth <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">p3</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-22-1.png" width="576" style="display: block; margin: auto;"></p>
<hr>
<p>What do you notice about the distribution of sampling means?</p>
<hr>
<p>We can also calculate summary statistics from our sample means:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samp_means</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 500.4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">samp_means</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.746</span></span></code></pre></div>
<hr>
<p>What do you notice about the mean of the sample means?</p>
<p>What is the interpretation of the standard deviation of the sample
means?</p>
<hr>
<p>As you may have figured out, we just used <code>R</code> to
approximate the <strong>sampling distribution</strong>, i.e., the means
of a large number of samples from the same population. Thanks to the
central limit theorem, the mean of the sample means is the population
mean (or, in this case, very close to the population mean since 1000 is
large but not infinite).</p>
<p>More importantly, the standard deviation of the sample means tells us
<em>on average</em> how far each sample mean is from the population
mean, i.e., the <strong>standard error</strong>. You can prove this to
yourself by calculating the standard error of the first sample we took
and comparing it to the standard deviation of the sample means:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.798</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">samp_means</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.746</span></span></code></pre></div>
<p>Again, these values should be close but will not be equal. Why won’t
they be equal? What factors influence how close they are to each
other?</p>
<hr>
<div class="section level4">
<h4 id="exercise-3">Exercise 3<a class="anchor" aria-label="anchor" href="#exercise-3"></a>
</h4>
<p>On your own, change the sample size and rerun the previous code. Note
that all you need to do is change <code>n &lt;- 15</code> to another
value and re-run the code. Run smaller sample sizes (e.g.,
<code>n &lt;- 5</code>) and larger sample sizes (e.g.,
<code>n &lt;- 30</code>). What happens to the sampling distribution and
the standard error?</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="confidence-intervals">Confidence intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"></a>
</h2>
<p>We can also use the concepts we just learned to better understand how
confidence intervals are calculated and what they represent.</p>
<p>Let’s quickly review a few properties of normal distributions. First,
~68% of samples from a normal distribution will fall within 1 SD of the
mean. For our squirrel population, this means that ~68% of squirrel body
masses fall within the range 470g-530g. This is the dark shaded area
below:</p>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-25-1.png" width="576" style="display: block; margin: auto;"></p>
<p>It is also true that 95% of samples will fall within ~1.96 x SD of
the mean. For our squirrel population, this means that ~95% of squirrel
body masses fall within the range 441.2g-558.8g. This is the dark shaded
area above.</p>
<p>In the above graph, we are visualizing the distribution of body
masses for individual squirrels as a way to learn about the properties
of normal distributions. But when we sample, we are (usually) not trying
to learn about individual squirrels, but instead about the population
mean.</p>
<p>How does this relate to confidence intervals?</p>
<p>Remember that the sampling distribution is a normal distribution. If
we denote the mean of sampling distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><annotation encoding="application/x-tex">\mu_{\bar{x}}</annotation></semantics></math>
and standard deviation as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><annotation encoding="application/x-tex">\sigma_{\bar{x}}</annotation></semantics></math>,
this means that ~95% of sample means will fall within the range
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><mo>−</mo><mn>1.96</mn><mo>×</mo><msub><mi>σ</mi><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub></mrow><annotation encoding="application/x-tex">\mu_{\bar{x}} - 1.96 \times \sigma_{\bar{x}}</annotation></semantics></math>
-
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><mo>+</mo><mn>1.96</mn><mo>×</mo><msub><mi>σ</mi><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub></mrow><annotation encoding="application/x-tex">\mu_{\bar{x}} + 1.96 \times \sigma_{\bar{x}}</annotation></semantics></math>.
Stare at that sentence for a few minutes until it sinks in.</p>
<p>What is this range for our samples?</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">500</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">samp_means</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 484.8</span></span>
<span><span class="fl">500</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">samp_means</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 515.2</span></span></code></pre></div>
<p>So 95% of our sample means should fall within the range 484.8 -
515.2. We can use the quantile function to check whether this is the
case:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">samp_means</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  2.5% 97.5% </span></span>
<span><span class="co">#&gt; 485.1 515.3</span></span></code></pre></div>
<p>Pretty close!</p>
<p>In the real world, we never actually know
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><annotation encoding="application/x-tex">\hat{\mu}_{\bar{x}}</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><annotation encoding="application/x-tex">\hat{\sigma}_{\bar{x}}</annotation></semantics></math>
so we can’t know the exact range of values our sample means should fall
within. But we can estimate it from our sample!</p>
<p>Remember that:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><mo>=</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\mu}_{\bar{x}} = \bar{y}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><mo>=</mo><mfrac><mi>s</mi><msqrt><mi>n</mi></msqrt></mfrac><mo>=</mo><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">\hat{\sigma}_{\bar{x}} = \frac{s}{\sqrt{n}} = SE</annotation></semantics></math>.
So for given a sample, we expect that 95% of sample means should be
within the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo>−</mo><mn>1.96</mn><mo>×</mo><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">\bar{y} - 1.96 \times SE</annotation></semantics></math>
-
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo>+</mo><mn>1.96</mn><mo>×</mo><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">\bar{y} + 1.96 \times SE</annotation></semantics></math>.</p>
<p>For our initial sample:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y_bar</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span></span>
<span><span class="co">#&gt; [1] 491.1</span></span>
<span><span class="va">y_bar</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span></span>
<span><span class="co">#&gt; [1] 521.7</span></span></code></pre></div>
<p>How do we interpret this range? Remember, it is <strong>not</strong>
saying anything about the probability of population mean is between
these values. In fact, in this case we can see that it makes no sense to
think about probability at all. We <strong>know</strong> whether the
confidence interval we just calculated includes the population mean or
not. There is no probability. We can see that by visualizing the
<em>estimated</em> sampling distribution and 95% confidence interval
relative to the true population mean:</p>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-29-1.png" width="576" style="display: block; margin: auto;"></p>
<p>In this case, we know the population mean so we are certain whether
or not it is within the confidence interval. But that is not the
important point. What’s important is that <em>after we collect a
sample</em>, the population mean is either within the confidence
interval or it isn’t. Even if we don’t know the population mean, we know
it’s either within the interval or it’s not.</p>
<p><em>Before we collect the sample</em>, however, we don’t know exactly
what the bounds of the confidence interval will be<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Just the like the sample mean and standard deviation,
the bounds of the confidence interval are random variables and will be
different for each sample&lt;/p&gt;"><sup>7</sup></a>. All we know is that,
given the properties of the normally-distributed sampling distribution,
there is a 95% probability that the confidence interval will include the
population mean and a 5% probability that it won’t. Put another way, if
we repeated our sampling many times, 95% of the confidence intervals
will contain the population mean and 5% won’t.</p>
<p>But don’t take my word for it! We can actually prove that and, in
doing so, hopefully clarify what confidence intervals are. We already
have a large number of samples, so let’s calculate the 95% confidence
interval for each one. To do this, we’ll again use a loop:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># empty objects to store lower and upper CI bounds for each sample</span></span>
<span><span class="va">lci</span> <span class="op">&lt;-</span> <span class="va">uci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsamp</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># first, calculate SE of sample </span></span>
<span>  <span class="co"># note that we use the object n for sample size. If you changed n above, be sure it is correct here</span></span>
<span>  <span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">samp_mat</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># next, calculate bounds of CI</span></span>
<span>  <span class="co"># again, we use the samp_means object here to index the correct sample mean. Make sure it is correct</span></span>
<span>  <span class="va">lci</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">samp_means</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span></span>
<span>  <span class="va">uci</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">samp_means</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To aid visualization, let’s compile these in a data frame:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ci_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsamp</span>, </span>
<span>                    mean <span class="op">=</span> <span class="va">samp_means</span>,</span>
<span>                    lci <span class="op">=</span> <span class="va">lci</span>, </span>
<span>                    uci <span class="op">=</span> <span class="va">uci</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ci_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sample_id  mean   lci   uci</span></span>
<span><span class="co">#&gt; 1         1 513.0 497.5 528.6</span></span>
<span><span class="co">#&gt; 2         2 494.2 477.2 511.2</span></span>
<span><span class="co">#&gt; 3         3 511.3 495.5 527.0</span></span>
<span><span class="co">#&gt; 4         4 501.6 487.5 515.7</span></span>
<span><span class="co">#&gt; 5         5 510.0 492.5 527.6</span></span>
<span><span class="co">#&gt; 6         6 487.9 469.5 506.4</span></span></code></pre></div>
<p>We can also create another column to indicate whether each confidence
interval contains the true population mean:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">ci_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">ci_df</span>, Coverage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">lci</span> <span class="op">&lt;</span> <span class="fl">500</span> <span class="op">&amp;</span> <span class="va">uci</span> <span class="op">&gt;</span> <span class="fl">500</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ci_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sample_id  mean   lci   uci Coverage</span></span>
<span><span class="co">#&gt; 1         1 513.0 497.5 528.6      Yes</span></span>
<span><span class="co">#&gt; 2         2 494.2 477.2 511.2      Yes</span></span>
<span><span class="co">#&gt; 3         3 511.3 495.5 527.0      Yes</span></span>
<span><span class="co">#&gt; 4         4 501.6 487.5 515.7      Yes</span></span>
<span><span class="co">#&gt; 5         5 510.0 492.5 527.6      Yes</span></span>
<span><span class="co">#&gt; 6         6 487.9 469.5 506.4      Yes</span></span></code></pre></div>
<p>Now we can visualize our samples. Note that we will only look at the
first 200 samples just to make things easier to see (you can change this
on your own if you’d like). Also note that we are using some additional
ggplot2 functions and arguments to improve the aesthetics of our
graph:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the mean of each sample and color based on whether CI contains population mean</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ci_df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample_id</span>, y <span class="op">=</span> <span class="va">mean</span>, color <span class="op">=</span> <span class="va">Coverage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add horizontal line, corresponding to population mean</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">500</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add CI for each sample; make each bar semi-transparent to make them easier to see</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample_id</span>, ymin <span class="op">=</span> <span class="va">lci</span>, ymax <span class="op">=</span> <span class="va">uci</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>, width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add sample means; make each point semi-transparent to make them easier to see</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># change the y-axis title to be more informative</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Sample mean"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># set the colors manually so that No = red, Yes = black</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># turn off x-axis text, tick marks, and title since it is cluttered and not relevant</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_inference_files/figure-html/unnamed-chunk-33-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Of the 1000 total intervals, what proportion do you think are
black?</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">ci_df</span><span class="op">$</span><span class="va">Coverage</span> <span class="op">==</span> <span class="st">"Yes"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">coverage</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.933</span></span></code></pre></div>
<p>Of course, for <em>your</em> sample that forms the basis of
<em>your</em> thesis, you have no way of knowing whether you are of the
black points or one of the red points. :)</p>
<div class="section level4">
<h4 id="exercise-4">Exercise 4<a class="anchor" aria-label="anchor" href="#exercise-4"></a>
</h4>
<p>By convention, most people calculate and report 95% confidence
intervals. But there is nothing magical about 95% and we can calculate
confidence intervals for any percentage we think is relevant to our
inference.</p>
<p>For example, 80% of a normal distribution falls within ~1.281
standard deviations of the mean. Based on this information:</p>
<ol style="list-style-type: decimal">
<li><p>Calculate the 80% confidence intervals of the 1000 samples from
our population</p></li>
<li><p>Add the 80% confidence intervals to the graph we created above.
Use a slightly thicker line for the 80% intervals than you did for the
95% intervals so you can see the limits of both intervals (hint -
<code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar()</a></code> has a <code>size</code> argument). It may
help to limit your graph to a smaller number of samples (e.g.,
100)</p></li>
</ol>
<p>How do the 80% confidence intervals compare to the 95% confidence
intervals? What are some reasons you might prefer intervals other than
95% when reporting results or making decisions based on the confidence
intervals from your sample?</p>
</div>
</div>
<div class="section level2">
<h2 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h2>
<p>In this assignment, you will build on the concepts and code from this
lab to explore sampling error in more detail.</p>
<p>Create an R Markdown file titled “Assignment 1”. Within that
document, do the following:</p>
<ol style="list-style-type: decimal">
<li><p>Create a header called “Quantifying the magnitude of sampling
error” and under this header create a R chunk. Within this R chunk,
create an object called <code>r</code> that contains the difference
between each of the 1000 sample means and the population mean
(<code>r</code> should thus be a vector of 1000 numeric values). Next,
use ggplot2 to create a histogram of these values. Below the chunk,
explain what the values in this histogram represent. In your answer,
indicate what the expected value of <code>r</code> is and what positive
vs negative values indicate about each sample.</p></li>
<li><p>Create a header called “Standardizing the magnitude of sampling
error” and under this header create another R chunk. Within this chunk,
calculate the standard deviation of <code>r</code>. Next, create a new
object (call it <code>t</code>) by dividing each element of
<code>r</code> by the standard deviation of <code>r</code>. Note that
you should do this using a single line of code and you <em>should
not</em> hard code the standard deviation (in other words, use the
<code><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd()</a></code> function rather than typing the actual value you
calculated in the previous step). Next, use ggplot2 to create a
histogram of these values. Below the chunk, explain what the values in
this histogram represent, in particular what positive and negative
values represent. Also, explain where the variation in these values
comes from. In other words, why do the samples not all have the same
value?</p></li>
<li><p>A friend of yours from another university also happens to be
studying gray squirrels (what are the chances!) and claims that their
squirrels are bigger than your squirrels. This friend has a history of
exaggeration and you certainly don’t want them to think their squirrels
are better than your squirrels, so you are skeptical. You ask your
friend to capture and weight 15 squirrels on their campus and send you
the data, which is included below:</p></li>
</ol>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">575.5</span>, <span class="fl">513.1</span>, <span class="fl">509.4</span>, <span class="fl">527.1</span>, <span class="fl">485.6</span>, <span class="fl">473.9</span>, <span class="fl">467.3</span>, <span class="fl">535.9</span>, <span class="fl">527.5</span>, </span>
<span>              <span class="fl">533.4</span>, <span class="fl">535.9</span>, <span class="fl">516.9</span>, <span class="fl">572.9</span>, <span class="fl">530.3</span>, <span class="fl">498.3</span><span class="op">)</span></span></code></pre></div>
<p>Create a new header called “Are their squirrels really bigger than my
squirrels?” and under this header create another R chunk. Copy the new
code to that chunk. Next, perform the following calculations:</p>
<ul>
<li><p>the mean of the new data (call this
<code>mu_samp</code>)</p></li>
<li><p>the difference between this mean and population mean of UGA gray
squirrels (call this <code>r_samp</code>)</p></li>
<li><p>divide <code>r_samp</code> by the standard deviation of
<code>r</code> that you calculated above (call this
<code>t_samp</code>)</p></li>
</ul>
<p>Next, create a new figure that includes the histogram you create in
the previous step plus a dashed, vertical bar corresponding to
<code>t_samp</code>.</p>
<p>Finally, do think your friend is right? Are the squirrels on their
campus bigger? Discuss how the information in this figure informs your
conclusions. Remember that this assignment is focused on sampling error,
so be sure your answer relates back to this concept. What does sampling
error have to do with the histogram and your friend’s data?</p>
<p>You may use AI to help inform your answer, though if you do, you must
include the full prompt(s) you used and it’s full answer(s) in a
<strong>separate section</strong> at the end of this document.</p>
<ol start="4" style="list-style-type: decimal">
<li>Create a new header called “Reflection”. Under this header, answer
the following questions:</li>
</ol>
<ul>
<li><p>On a 1-10 scale, how would you rate your confidence in the topics
covered in this lab?</p></li>
<li><p>What lingering questions/confusion about these topics do you
still have?</p></li>
<li><p>If you used AI to help with any aspects of this lab, how well did
it do? Did it help you understand the material better? Did it struggle
with any specific topics?</p></li>
</ul>
<p>A few things to remember when creating the document:</p>
<ul>
<li><p>Be sure to include your name in the <code>author</code> field of
the header</p></li>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so that all code and output is visible in the knitted
document</p></li>
<li><p>Regularly knit the document as you work to check for
errors</p></li>
<li><p>See the R Markdown reference sheet for help with creating
<code>R</code> chunks, equations, tables, etc.</p></li>
</ul>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
