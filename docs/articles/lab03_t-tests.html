<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 3: Linear models with one categorical predictor-- t-tests • FANR6750</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 3: Linear models with one categorical predictor-- t-tests">
<meta property="og:description" content="FANR6750">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FANR6750</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2024.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/01_intro_to_stats/01_intro_to_stats.html">Lecture 1: Introduction to statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/02_intro_to_lm/02_intro_to_lm.html">Lecture 2: Introduction to linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/03_inference/03_inference.html">Lecture 3: Principles of inference</a>
    </li>
    <li>
      <a href="../articles/lectures/04_t-test/04_t-test.html">Lecture 4: Linear models part 1: categorical predictor w/ 2 levels</a>
    </li>
    <li>
      <a href="../articles/lectures/05_nht/05_nht.html">Lecture 5: Null hypothesis significance testings</a>
    </li>
    <li>
      <a href="../articles/lectures/06_power/06_power.html">Lecture 6: Statistical power</a>
    </li>
    <li>
      <a href="../articles/lectures/07_anova/07_anova.html">Lecture 7: Linear models part 2: categorical predictor &gt; 2 levels</a>
    </li>
    <li>
      <a href="../articles/lectures/08_mult_comp/08_mult_comp.html">Lecture 8: Multiple Comparisons</a>
    </li>
    <li>
      <a href="../articles/lectures/09_regression/09_regression.html">Lecture 9: Multiple Regression</a>
    </li>
    <li>
      <a href="../articles/lectures/10_interactions/10_interactions.html">Lecture 10: Interactions</a>
    </li>
    <li>
      <a href="../articles/lectures/11_assumptions/11_assumptions.html">Lecture 11: Evaluating assumptions</a>
    </li>
    <li>
      <a href="../articles/lectures/12_model_selection/12_model_selection.html">Lecture 12: Model selection</a>
    </li>
    <li>
      <a href="../articles/lectures/13_random_effects/13_random_effects.html">Lecture 13: Random effects</a>
    </li>
    <li>
      <a href="../articles/lectures/14_nested/14_nested.html">Lecture 14: Nested designs</a>
    </li>
    <li>
      <a href="../articles/lectures/15_split-plot/15_split-plot.html">Lecture 15: Split-plot designs</a>
    </li>
    <li>
      <a href="../articles/lectures/16_repeated_measures/16_repeated_measures.html">Lecture 16: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lectures/17_glm/17_glm.html">Lecture 17: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/18_logistic_regression/18_logistic_regression.html">Lecture 18: Logistic regression</a>
    </li>
    <li>
      <a href="../articles/lectures/19_poisson_regression/19_poisson_regression.html">Lecture 19: Poisson regression</a>
    </li>
    <li>
      <a href="../articles/lectures/20_zero_inflation/20_zero_inflation.html">Lecture 20: Zero-inflated regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab01_intro_to_R.html">Lab 1: Introduction to R</a>
    </li>
    <li>
      <a href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to projects and RMarkdown</a>
    </li>
    <li>
      <a href="../articles/lab03_t-tests.html">Lab 3: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab04_ANOVA.html">Lab 4: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab05_multiple_regression.html">Lab 5: Multiple Regression</a>
    </li>
    <li>
      <a href="../articles/lab06_interactions.html">Lab 6: Interactions</a>
    </li>
    <li>
      <a href="../articles/lab07_linear_model_assumptions.html">Lab 7: Evaluating assumptions</a>
    </li>
    <li>
      <a href="../articles/lab08_model_selection.html">Lab 8: Model selection</a>
    </li>
    <li>
      <a href="../articles/lab09_nested.html">Lab 9: Nested designs</a>
    </li>
    <li>
      <a href="../articles/lab10_split_plot.html">Lab 10: Split-plot designs</a>
    </li>
    <li>
      <a href="../articles/lab11_repeated_measures.html">Lab 11: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lab12_glm_lr.html">Lab 12: Logistic regression</a>
    </li>
    <li>
      <a href="../articles/lab13_glm_pr.html">Lab 13: Poisson regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework.html">Assignment instructions</a>
    </li>
    <li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/RMarkdown.html">R Markdown reference</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Creating publication-quality graphics</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 3: Linear models with one categorical
predictor– t-tests</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2024</h4>
            
      
      
      <div class="hidden name"><code>lab03_t-tests.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="lab-2">Lab 2<a class="anchor" aria-label="anchor" href="#lab-2"></a>
</h3>
<ul>
<li><p>Introduction to RMarkdown</p></li>
<li><p>Introduction to RProjects and directories</p></li>
<li><p>Submitting HWs</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="todays-topics">Today’s topics<a class="anchor" aria-label="anchor" href="#todays-topics"></a>
</h3>
<ul>
<li><p>Introduction</p></li>
<li>
<p>Linear models with one categorical predictor: t-tests</p>
<ul>
<li><p>One sample</p></li>
<li><p>Samples vs tails</p></li>
<li><p>Two sample</p></li>
<li><p>Graphics Review</p></li>
<li><p>Paired</p></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Today we will discuss a range of scenarios which broadly fall under
the category of <strong>t-tests</strong>. These will include:</p>
<ul>
<li><p>when a sample mean is being compared to a particular value
(<strong>one-sample t-test</strong>)</p></li>
<li><p>when two sample means are being compared to each other and the
observations between samples are independent (<strong>two-sample
t-test</strong>)</p></li>
<li><p>when two sample means are being compared to each other and the
observations between samples are paired (<strong>paired
t-test</strong>)</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="scenario-1-one-sample-t-tests">Scenario 1: One sample t-tests<a class="anchor" aria-label="anchor" href="#scenario-1-one-sample-t-tests"></a>
</h2>
<ul>
<li><p>For now, we will talk about the scenario in which we only have
one sample of data and we are interested in its mean.</p></li>
<li><p><strong>Question</strong>: Is the average height of students at
UGA equal to 65 inches?</p></li>
<li><p><strong>Problem</strong>: We don’t know the true population mean
(<span class="math inline">\(\mu_1\)</span>). All we have is the sample
mean (<span class="math inline">\(\bar{y}_1\)</span>).</p></li>
<li>
<p>The relevant hypotheses are:</p>
<ul>
<li><p><span class="math inline">\(H_0 : \mu_1 = 65\)</span></p></li>
<li><p><span class="math inline">\(H_A : \mu_1 \neq 65\)</span></p></li>
</ul>
</li>
</ul>
<p>Suppose we have collected a random sample of 100 students. Below is a
plot of the distribution of their heights. In this case the sample mean
is 61 inches. From the plot below, it would be difficult to conclude one
way or another whether the population mean is equal to 65.</p>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
<p><br></p>
<p><br></p>
<p>We can think about this problem in a few different ways. Below we
will see how to approach it both from the perspective of a linear model
as well as from the perspective of a test. Remember that in our linear
model below we are interested in estimating <span class="math inline">\(\beta_0\)</span> which in this very simple case
just represents the population mean.</p>
<p><span class="math display">\[
y_i = \beta_0 + \epsilon_i \ \ \ \ \ \text{where} \ \ \ \ \ \epsilon_i
\sim \text{N}(0,\sigma)
\]</span></p>
<div class="section level3">
<h3 id="key-points">Key points<a class="anchor" aria-label="anchor" href="#key-points"></a>
</h3>
<ul>
<li><p>If the sample mean (<span class="math inline">\(\bar{y}_1\)</span>) is very different from the
proposed population mean and the standard error of the difference is
small, the <span class="math inline">\(t\)</span>-statistic will be far
from zero</p></li>
<li><p>If the <span class="math inline">\(t\)</span>-statistic is more
extreme than the critical values, we reject the null hypothesis (<span class="math inline">\(H_0\)</span>)</p></li>
</ul>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="exercise-1">Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="section level4">
<h4 id="formulation-as-a-linear-model">Formulation as a linear model<a class="anchor" aria-label="anchor" href="#formulation-as-a-linear-model"></a>
</h4>
<ol style="list-style-type: decimal">
<li><p>Open your <code>FANR6750</code> RStudio project (if you have
one)</p></li>
<li><p>Create a new <code>R</code> script and save it to the directory
where you store you lab activities. Name it something like
<code>lab04-t_tests.R</code></p></li>
<li><p>Load the <code>FANR6750</code> package and the
<code>studentsdata</code> object</p></li>
</ol>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"studentsdata"</span><span class="op">)</span></span></code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Create an object <code>students</code> which is the vector in the
<code>studentsdata</code> dataframe.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">students</span> <span class="op">&lt;-</span> <span class="va">studentsdata</span><span class="op">$</span><span class="va">students</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Fit a linear model to this dataset.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">students</span> <span class="op">-</span> <span class="fl">65</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = students - 65 ~ 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.406  -2.181  -0.156   1.819   7.794 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   -3.594      0.321   -11.2   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 3.21 on 99 degrees of freedom</span></span></code></pre></div>
<p>A few things to think about here:</p>
<ul>
<li><p>Why did we include the <code>- 65</code> in the model
statement?</p></li>
<li><p>What does the <code>~ 1</code> represent?</p></li>
<li><p>What does the intercept value mean?</p></li>
<li><p>What do we conclude from this model and p-value?</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="formulation-as-a-t-test-by-hand">Formulation as a t-test by hand<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-by-hand"></a>
</h4>
<p>Now that we have seen how R can create a linear model to help us
answer the question about the population mean, we will dive deeper into
what exactly the computer is doing. How exactly did it decide to reject
the null hypothesis? How did it calculate the p-value? Where did it get
those numbers?</p>
<p>We know from lecture that the formula to get a test statistic for a
one sample test is the following:</p>
<p><span class="math display">\[
t = \frac{\bar{y} - \mu_0}{SEM} \ \ \ \ \ \text{where} \ \ \ \ \ SEM =
\frac{s}{\sqrt{n}} = \frac{\sqrt{\frac{1}{n-1}\sum^n_{i=1}(y_i -
\bar{y})^2}}{\sqrt{n}}
\]</span> While this looks like a lot, we can break it into pieces as
lines of code in R.</p>
<ol start="6" style="list-style-type: decimal">
<li>Create an object which is the sample mean.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">students</span><span class="op">)</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Create an object which is the standard error</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">students</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">students</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>Put these together to calculate the test statistic</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_stat</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y_bar</span> <span class="op">-</span> <span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="va">se_y</span></span></code></pre></div>
<p>Now that we have a test statistic, we need to calculate a critical
value for comparison.</p>
<ol start="9" style="list-style-type: decimal">
<li>Calculate the critical values</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">t_crit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, df<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">students</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Notice that the results are the same as when we used the
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function.</p>
</div>
<div class="section level4">
<h4 id="formulation-as-a-t-test-using-the-built-in-r-function">Formulation as a t-test using the built in R function<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-using-the-built-in-r-function"></a>
</h4>
<ol start="10" style="list-style-type: decimal">
<li>Use the built in <code>R</code> function <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">students</span>, mu<span class="op">=</span> <span class="fl">65</span>, alternative<span class="op">=</span> <span class="st">'two.sided'</span>, conf.level<span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  One Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  students</span></span>
<span><span class="co">#&gt; t = -11, df = 99, p-value &lt;2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: true mean is not equal to 65</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  60.77 62.04</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x </span></span>
<span><span class="co">#&gt;     61.41</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="samples-vs-tails">Samples vs Tails<a class="anchor" aria-label="anchor" href="#samples-vs-tails"></a>
</h2>
<p>Before we go any further, lets address an issue that many students
find confusing about t-tests. This is the issue of
<strong>samples</strong> vs <strong>tails</strong>. What does it mean
when we talk about a ‘one sample t-test vs a two sample t-test’? What
does it mean when we say a t-test had ‘one tail or two tails’?</p>
<ul>
<li><p><strong>Samples</strong>: The number of samples (one or two) has
to do with the data that you are using to approach the research
question. If you are comparing one sample to a specific value
(e.g. <span class="math inline">\(\mu_1 = 6\)</span>) we call that a
<strong>one sample test</strong>. If instead, you are comparing two
sample means to eachother, we call that a <strong>two sample
test</strong></p></li>
<li><p><strong>Tails</strong>: The number of tails (one or two) is
related to the specific research question that you are interested in
asking and it is directly informed by the null and alternative
hypotheses. A <strong>two tailed test</strong> will have hypotheses like
those below:</p></li>
</ul>
<p><span class="math display">\[
H_0: \mu_1 = x
\]</span></p>
<p><span class="math display">\[
H_A: \mu_1 \ne x
\]</span></p>
<p>Notice the <span class="math inline">\(=\)</span> and <span class="math inline">\(\ne\)</span> in the hypotheses. <span class="math inline">\(\mu_1\)</span> may be being compared to a specific
value or being compared to another mean (e.g. <span class="math inline">\(\mu_2\)</span>) but the hypotheses are always set
up as <span class="math inline">\(=\)</span> vs <span class="math inline">\(\ne\)</span>.</p>
<p>In constrast, a <strong>one tailed test</strong> will have hypotheses
like these below:</p>
<p><span class="math display">\[
H_0: \mu_1 \le x
\]</span></p>
<p><span class="math display">\[
H_A: \mu_1 &gt; x
\]</span></p>
<p>Or the other way around:</p>
<p><span class="math display">\[
H_0: \mu_1 \ge x
\]</span></p>
<p><span class="math display">\[
H_A: \mu_1 &lt; x
\]</span></p>
<p>Notice that in a one tailed test, the alternative is only interested
in one direction and the null includes everything else.</p>
<p><strong>In what types of situations might you want to set up a t-test
as one tailed? What about two tailed? Which do you think has more
statistical power to detect an effect?</strong></p>
</div>
<div class="section level2">
<h2 id="scenario-2-two-sample-t-tests">Scenario 2: Two sample t-tests<a class="anchor" aria-label="anchor" href="#scenario-2-two-sample-t-tests"></a>
</h2>
<ul>
<li><p>In this dataset, we have the average number of calls over 10
minutes during point count surveys for Song Thrushes (<em>Turdus
philomelos</em>), a species of song bird in eastern Europe. The
researcher is interested in understanding how wind may be affecting the
frequency of bird calls. Specifically, she would like to know whether
high wind conditions results in fewer average calls over 10 minutes than
low wind conditions.</p></li>
<li><p><strong>Question</strong>: Do the samples come from the same
population, or do they come from populations with different
means?</p></li>
<li><p><strong>Problem</strong>: We don’t know the true population means
(<span class="math inline">\(\mu_H\)</span>, <span class="math inline">\(\mu_L\)</span>)</p></li>
<li>
<p>Under the assumption that the variances of the two populations
are equal, the relevant hypotheses are:</p>
<ul>
<li><p><span class="math inline">\(H_0 : \mu_H \ge
\mu_L\)</span></p></li>
<li><p><span class="math inline">\(H_A : \mu_H &lt;
\mu_L\)</span></p></li>
</ul>
</li>
</ul>
<p><strong>How many tails are in this test? Why did we decide to do
that?</strong></p>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We will again see how this problem can be approached from the
perspective of a linear model as well as being considered as a test.
Below is the linear model for the two sample t-test. It should look
similar to the last one we used, but now we have added the complexity of
two categorical levels (i.e. high wind vs low wind):</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1x_i + \epsilon_i \ \ \ \ \ \text{where} \ \ \ \ \
\epsilon_i \sim \text{N}(0,\sigma)
\]</span></p>
<p><strong>How do we interpret <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>?</strong></p>
<div class="section level3">
<h3 id="exercise-2">Exercise 2<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h3>
<div class="section level4">
<h4 id="formulation-as-a-linear-model-1">Formulation as a linear model<a class="anchor" aria-label="anchor" href="#formulation-as-a-linear-model-1"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Load the <code>FANR6750</code> package and the
<code>thrushdata</code> object. Lets look at the structure and summary
of the dataset as well</li>
</ol>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"thrushdata"</span><span class="op">)</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">thrushdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    100 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ calls: num  9.1 5.7 7.7 14.9 12.3 16.7 17.8 11.6 7.5 14.3 ...</span></span>
<span><span class="co">#&gt;  $ wind : chr  "high" "high" "high" "high" ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">thrushdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;      calls          wind          </span></span>
<span><span class="co">#&gt;  Min.   : 5.7   Length:100        </span></span>
<span><span class="co">#&gt;  1st Qu.:11.3   Class :character  </span></span>
<span><span class="co">#&gt;  Median :14.1   Mode  :character  </span></span>
<span><span class="co">#&gt;  Mean   :14.1                     </span></span>
<span><span class="co">#&gt;  3rd Qu.:16.7                     </span></span>
<span><span class="co">#&gt;  Max.   :23.4</span></span>
<span></span>
<span><span class="co"># Notice from the str() and summary() functions that R is interpreting the 'wind' variable </span></span>
<span><span class="co"># as a character. Because we would like to treat 'wind' as a grouping variable, we can </span></span>
<span><span class="co"># convert it to a factor in R.</span></span>
<span></span>
<span><span class="va">thrushdata</span><span class="op">$</span><span class="va">wind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">thrushdata</span><span class="op">$</span><span class="va">wind</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Fit a linear model to the data which estimates call frequency as a
function of wind conditions.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">calls</span><span class="op">~</span> <span class="va">wind</span>, data<span class="op">=</span> <span class="va">thrushdata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = calls ~ wind, data = thrushdata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt;  -6.02  -2.42  -0.12   2.17   6.95 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   11.720      0.414   28.32  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; windlow        4.730      0.585    8.08  1.7e-12 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.93 on 98 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:   0.4,   Adjusted R-squared:  0.394 </span></span>
<span><span class="co">#&gt; F-statistic: 65.3 on 1 and 98 DF,  p-value: 1.69e-12</span></span></code></pre></div>
<p><strong>How would you interpret these results? Is there a difference
in call frequency as a function of wind conditions? Which of these
numbers represent <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in our linear model
above?</strong></p>
</div>
<div class="section level4">
<h4 id="formulation-as-a-t-test-by-hand-1">Formulation as a t-test by hand<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-by-hand-1"></a>
</h4>
<p>Similar to Exercise 1, we could calculate a test statistic by hand.
The formulas for creating this test statistic as well as the pooled
variance are shown below:</p>
<p><span class="math display">\[\large t = \frac{(\bar{y}_H − \bar{y}_L)
− (\mu_H − \mu_L)}{\sqrt{s^2_p/n_H + s^2_p/n_L}}\]</span></p>
<p>where <span class="math inline">\(s^2_p\)</span> is the pooled
variance</p>
<p><span class="math display">\[\large s^2_p = \frac{(n_H − 1)s^2_H +
(n_L − 1)s^2_L}{n_H + n_L − 2}\]</span></p>
<p>We will leave it as an exercise for you to perform. The general steps
are as follows:</p>
<ul>
<li><p>Calculate the test statistic by defining all the necessary terms
in R</p></li>
<li><p>Calculate the appropriate critical value/values</p></li>
<li><p>Compare the test statistic to the critical value/values and reach
a conclusion about the hypotheses in question</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="formulation-as-a-t-test-using-the-built-in-r-function-1">Formulation as a t-test using the built in R function<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-using-the-built-in-r-function-1"></a>
</h3>
<ol start="3" style="list-style-type: decimal">
<li>Create two objects which represent the calls vectors for high and
low wind conditions</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yL</span> <span class="op">&lt;-</span> <span class="va">thrushdata</span><span class="op">$</span><span class="va">calls</span><span class="op">[</span><span class="va">thrushdata</span><span class="op">$</span><span class="va">wind</span><span class="op">==</span> <span class="st">'low'</span><span class="op">]</span></span>
<span><span class="va">yH</span> <span class="op">&lt;-</span> <span class="va">thrushdata</span><span class="op">$</span><span class="va">calls</span><span class="op">[</span><span class="va">thrushdata</span><span class="op">$</span><span class="va">wind</span><span class="op">==</span> <span class="st">'high'</span><span class="op">]</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Use the <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code> function to perform the two sample
t-test</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">yH</span>, <span class="va">yL</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>, paired <span class="op">=</span> <span class="cn">FALSE</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  yH and yL</span></span>
<span><span class="co">#&gt; t = -8.1, df = 98, p-value = 8e-13</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is less than 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;    -Inf -3.758</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x mean of y </span></span>
<span><span class="co">#&gt;     11.72     16.45</span></span></code></pre></div>
<p>Make sure you set <code>var.equal=TRUE</code>. Otherwise,
<code>R</code> will assume that the variances of the two populations are
unequal. We can test this assumption using the code below.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/var.test.html" class="external-link">var.test</a></span><span class="op">(</span><span class="va">yH</span>, <span class="va">yL</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  F test to compare two variances</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  yH and yL</span></span>
<span><span class="co">#&gt; F = 1.2, num df = 49, denom df = 49, p-value = 0.5</span></span>
<span><span class="co">#&gt; alternative hypothesis: true ratio of variances is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.6874 2.1345</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; ratio of variances </span></span>
<span><span class="co">#&gt;              1.211</span></span></code></pre></div>
<p><strong>What do we conclude? Was it appropriate for us to assume
equality of variances? What could we have done if this assumption was
not met?</strong></p>
<p>We can also formulate our t-test using some different syntax. It will
give us exactly the same results though.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">calls</span> <span class="op">~</span> <span class="va">wind</span>, data <span class="op">=</span> <span class="va">thrushdata</span>, </span>
<span>       var.equal <span class="op">=</span> <span class="cn">TRUE</span>, paired <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>       alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  calls by wind</span></span>
<span><span class="co">#&gt; t = -8.1, df = 98, p-value = 8e-13</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is less than 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;    -Inf -3.758</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean in group high  mean in group low </span></span>
<span><span class="co">#&gt;              11.72              16.45</span></span></code></pre></div>
<p>We have performed the t-test for this dataset but it would be nice if
we could plot the data. This section below provides a brief introduction
to plotting in <code>R</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="graphics">Graphics<a class="anchor" aria-label="anchor" href="#graphics"></a>
</h2>
<p><code>R</code> has very powerful graphing capabilities that make it
possible to create data visualizations for reports or publications. As
with most tasks in <code>R</code>, there are many ways to create graphs
and you will find that people have very strong feelings about the best
approach.</p>
<p>The debate over graphics in <code>R</code> usually boils down to
using the built-in graphing functions (“base graphics”) vs the
<code>ggplot2</code> package. There are some advantages to both
approaches, but for the most part the newer generations of
<code>R</code> users prefer <code>ggplot2</code>. Therefore most of the
sample code provided in lab will reflect that preference. However,
<strong>I don’t care how you make your plots as long as they effectively
display the information you are trying to convey</strong>. If you prefer
base graphics, by all means use base graphics.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="section level4">
<h4 id="brief-introduction-to-ggplot2">Brief introduction to <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#brief-introduction-to-ggplot2"></a>
</h4>
<p>Because the code I provide will use <code>ggplot2</code>, it is worth
briefly learning/reviewing how this package approaches data
visualization.</p>
<p>The power and flexibility of <code>ggplot2</code> come from it’s
consistent structure. Although a bit confusing at first, once you get
the hang of it, the structure actually makes it quite easy to create
highly customized visualizations. All plots created using
<code>ggplot2</code> use the same underlying structure:</p>
<p><span class="math display">\[\underbrace{ggplot}_{initiate\;
plot}(\underbrace{data = df}_{data\;frame},\; \underbrace{aes(x =\; , y
= \;)}_{plot\; attributes}) +
\underbrace{geom\_line()}_{geometry}\]</span></p>
<p>The <code>ggplot()</code> function initiates a new plot. In this
function, you tell <code>ggplot2</code> what data frame you will be
using for the plot (<code>ggplot</code> only accepts data frames as
input) and you tell it how to map attributes of the data to the visual
properties of the figures. Attributes are mapped inside the
<code>aes()</code> argument. Attributes usually include location
(<code>x-axis</code> and <code>y-axis</code> placement), color, size,
shape, line type, and many others. In general, <strong>each attribute
will be mapped to one column of your data frame</strong>.</p>
<p>The <code>ggplot()</code> function simply initiates a graph - if you
run just that portion of the code you will get a blank graph. We can see
that by creating a new plot showing the relationship between
<code>wind</code> (the x-axis of the plot) and <code>calls</code> (the
y-axis):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-21-1.png" width="480" style="display: block; margin: auto;"></p>
<p>You can see that <code>ggplot</code> created a figure with the
correct axes and labels. But no data. That’s because we didn’t tell
<code>ggplot</code> what type of <em>geometry</em> to use to represent
the data. Once we add a geometry, we can see the data:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-22-1.png" width="480" style="display: block; margin: auto;"></p>
<p>In this case, a boxplot might make more sense:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-23-1.png" width="480" style="display: block; margin: auto;"></p>
<p>It’s also possible to use more than one geometry:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-24-1.png" width="480" style="display: block; margin: auto;"></p>
<p>This is reasonable figure showing call frequencies as a function of
wind. But <code>ggplot2</code> makes it very easy to tweak the way the
data is visualized (maybe too easy, you can spend <em>a lot</em> of time
tweaking minor details). For example, maybe we want to color the points
based on the wind. Because we want to map an <em>attribute</em> (color)
to a <em>variable</em> (wind), we make this change inside of
<code>aes</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span>, color <span class="op">=</span> <span class="va">wind</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-25-1.png" width="480" style="display: block; margin: auto;"></p>
<p>That’s not exactly what we wanted. Both the boxplot and the points
now colored a function of <code>wind</code>. To make just the points a
function of wind, we specify <code>color = wind</code> inside of the
<code>geom_point()</code> function (anything in the
<code>ggplot()</code> function will apply to all geoms):</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">wind</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-26-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We can also do things like the change the size of the geometries. In
this case, we are <strong>not</strong> mapping a variable to an
attribute (size is not a function of the data values). So these changes
happen <strong>outside</strong> of the <code>aes()</code> argument:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">wind</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-27-1.png" width="480" style="display: block; margin: auto;"></p>
<p>One last example. Because many of the points overlap, it can be hard
to tell how many individual points there are in each group. One way to
deal with overplotting like this is to make each point slightly
transparent. We can do that with the <code>alpha</code> parameter:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">thrushdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wind</span>, y <span class="op">=</span> <span class="va">calls</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">wind</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-28-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Again, because we aren’t mapping the alpha value to any data, we
include it outside of <code>aes()</code>.</p>
</div>
<div class="section level3">
<h3 id="exercise-3">Exercise 3<a class="anchor" aria-label="anchor" href="#exercise-3"></a>
</h3>
<p>The graph above is fine for a quick visualization of the data but
wouldn’t be appropriate for including in publications or reports. On
your own,</p>
<ol style="list-style-type: decimal">
<li><p>Improve the axis labels. This could include: title case, units,
font size, etc. Run <code>?scale_y_continuous</code> and
<code>?scale_x_discrete</code> if you need some help (and note the
difference between these two functions!). <code>?theme</code> may also
be useful</p></li>
<li><p>Manually change the color of the points
(<code>?scale_color_manual</code>)</p></li>
<li><p>Instead of displaying the data using a boxplot, create histograms
showing the distribution of call densities at each level of wind
(<code>?geom_histogram</code>)</p></li>
</ol>
<p>As you learn about graphics functions, whether base or
<code>ggplot2</code>, you will probably need to look up help for how to
do certain things. Google is usually your best bet but here are a few
other good references:</p>
<ul>
<li><p>The fantastic <a href="https://clauswilke.com/dataviz/" class="external-link">Fundamentals of Data
Visualization</a> book by Claus Wilke</p></li>
<li><p>The <code>ggplot2</code> package <a href="https://ggplot2.tidyverse.org/" class="external-link">website</a></p></li>
<li><p>And, yes, even the base <code>R</code> <a href="https://www.r-graph-gallery.com/base-R.html" class="external-link">graph
gallery</a></p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="scenario-3-paired-t-test">Scenario 3: Paired t-test<a class="anchor" aria-label="anchor" href="#scenario-3-paired-t-test"></a>
</h2>
<ul>
<li><p>In this dataset, the researcher is interested in studying the
effects of a pesticide on caterpillar populations. Twelve bushes are
examined and the number of caterpillars on each bush is recorded. The
pesticide is applied and after 3 days the number of caterpillars on each
bush is recorded again.</p></li>
<li><p><strong>Question</strong>: Does the pesticide have a negative
effect on the caterpillar population?</p></li>
<li><p><strong>Note</strong>: Paired t-tests can be thought of as a one
sample t-test on the differences.</p></li>
<li><p>The hypotheses for this test would be the following:</p></li>
</ul>
<p><span class="math display">\[
H_0: \mu_T \ge \mu_U
\]</span></p>
<p><span class="math display">\[
H_A: \mu_T &lt; \mu_U
\]</span></p>
<p>Another way we could think about this is to say that <span class="math inline">\(\mu_U - \mu_T = \mu_D\)</span>. From here, we can
formulate the hypotheses as:</p>
<p><span class="math display">\[
H_0: \mu_D \le 0
\]</span></p>
<p><span class="math display">\[
H_A: \mu_D &gt; 0
\]</span></p>
<div class="section level3">
<h3 id="exercise-4">Exercise 4<a class="anchor" aria-label="anchor" href="#exercise-4"></a>
</h3>
<div class="section level4">
<h4 id="formulation-as-a-linear-model-2">Formulation as a linear model<a class="anchor" aria-label="anchor" href="#formulation-as-a-linear-model-2"></a>
</h4>
<p>In this case, we already know that the paired t-test can be thought
of as a one sample t-test on the differences. As a result, the linear
model can be set up in the same way as Scenario 1 above. This will be
left as an exercise</p>
</div>
<div class="section level4">
<h4 id="formulation-as-a-t-test-by-hand-2">Formulation as a t-test by hand<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-by-hand-2"></a>
</h4>
<p>This will be left as an exercise for you but the general steps are as
follows:</p>
<ol style="list-style-type: decimal">
<li>Load the caterpillar dataset</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"caterpillardata"</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Calculate the difference between the untreated and treated
values</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caterpillardata</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="va">caterpillardata</span><span class="op">$</span><span class="va">untreated</span> <span class="op">-</span> <span class="va">caterpillardata</span><span class="op">$</span><span class="va">treated</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">caterpillardata</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span></code></pre></div>
<p>Is the mean different from zero?</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">caterpillardata</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_t-tests_files/figure-html/unnamed-chunk-31-1.png" width="480" style="display: block; margin: auto;"></p>
<ol start="3" style="list-style-type: decimal">
<li>Calculate the standard deviation of the differences</li>
</ol>
<p><span class="math display">\[\large s_d =
\sqrt{\frac{1}{n-1}\sum_{i=1}^n(y_i - \bar{y})^2}\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Calculate the test statistic</li>
</ol>
<p><span class="math display">\[\large t =
\frac{\bar{y}-0}{s_d/\sqrt{n}}\]</span></p>
<ol start="5" style="list-style-type: decimal">
<li>Compare to appropriate critical value and draw a conclusion</li>
</ol>
</div>
<div class="section level4">
<h4 id="formulation-as-a-t-test-using-the-built-in-r-function-2">Formulation as a t-test using the built in R function<a class="anchor" aria-label="anchor" href="#formulation-as-a-t-test-using-the-built-in-r-function-2"></a>
</h4>
<ol start="6" style="list-style-type: decimal">
<li>Use the <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code> function in R to perform the test</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">caterpillardata</span><span class="op">$</span><span class="va">diff</span>, mu<span class="op">=</span> <span class="fl">0</span>, alternative<span class="op">=</span> <span class="st">'greater'</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  One Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  caterpillardata$diff</span></span>
<span><span class="co">#&gt; t = 2.3, df = 11, p-value = 0.02</span></span>
<span><span class="co">#&gt; alternative hypothesis: true mean is greater than 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.3408    Inf</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x </span></span>
<span><span class="co">#&gt;       1.5</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="excercise">Excercise<a class="anchor" aria-label="anchor" href="#excercise"></a>
</h2>
<p>This dataset comes from fisheries landings data for Yellowfin tuna
(<em>Thunnus albacares</em>). The weight in pounds was recorded for each
fish as well as presence of the larval form of a Lacistorhynchidae
tapeworm (<em>Dasyrhynchus talismani</em>). The researcher believes that
the presence of the tapeworm likely results in a less healthy and
therefore lighter fish.</p>
<p>Create an R Markdown file to do the following:</p>
<ol style="list-style-type: decimal">
<li>Create an <code>R</code> chunk to load the tuna data using:</li>
</ol>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tunadata"</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Make a figure to show the weights of both infected and healthy
tuna. You should spend some time considering what type of figure would
best display this data (1 pt).</p></li>
<li><p>Create a header called “Hypotheses” and under this header, in
plain English indicate what the null and alternative hypotheses are for
the t-test. Also use R Markdown’s equation features to write these
hypotheses using mathematical notation. In order to do this, you will
need to consider what type of test would be appropriate for this data
and how many tails the test will have (1 pt).</p></li>
<li><p>Create a header called “t-test by hand”. Under this header, do a
t-test on the tuna data without using the <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>
function. Use only the functions <code>mean</code>, <code>sd</code>, and
possibly <code>length</code>. Be sure to <strong>annotate your
code</strong> (either within the <code>R</code> chunk using
<code>#</code> or as plain text within the R Markdown file) and
<strong>state the decision</strong> (reject or fail to reject the null)
based on your results (2 pt).</p></li>
<li>
<p>Create a header called “t-test in R”. Under this header, do the
t-test again, but this time using the <code>t.test</code> function (1
pt).</p>
<ul>
<li>Assume variances are equal</li>
</ul>
</li>
<li><p>Add a section at the end of your file called “Discussion” and
explain why you think the t-test failed to reject the null hypothesis
even though the sample means were ~60 pounds different (almost a 20%
difference in weight). What about the data may have caused this result?
(1 pt)</p></li>
</ol>
<p>A few things to remember when creating the document:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so that all code and output is visible in the knitted
document</p></li>
<li><p>Regularly knit the document as you work to check for
errors</p></li>
<li><p>See the R Markdown reference sheet for help with creating
<code>R</code> chunks, equations, tables, etc.</p></li>
</ul>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Keep in mind that although we will be using ggplot2, it
is a good idea to have some understanding of how base <code>R</code>
graphics work. Most packages in <code>R</code>, when they produce some
sort of output in the form of a plot, will still create that plot using
base <code>R</code> graphics rather than ggplot. In order to alter those
graphics without having to start from scratch, it will be useful to know
a little about base <code>R</code> graphics.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
