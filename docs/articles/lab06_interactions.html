<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 6: Interactions • FANR6750</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.0/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lab 6: Interactions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FANR6750</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../articles/syllabus.html"><span class="fa fas fa-book"></span> Syllabus</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/schedule.html"><span class="fa fas fa-calendar"></span> Schedule</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lectures" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-file-pdf-o"></span> Lectures</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lectures">
<li><a class="dropdown-item" href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/01_intro_to_stats/01_intro_to_stats.html">Lecture 1: Introduction to statistics</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/02_intro_to_lm/02_intro_to_lm.html">Lecture 2: Introduction to linear models</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/03_inference/03_inference.html">Lecture 3: Principles of inference</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/04_principles_of_expdesign/04_expdesign.html">Lecture 4: Principles of experimental design</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/05_t-test/05_t-test.html">Lecture 5: Linear models part 1: categorical predictor w/ 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/06_nht/06_nht.html">Lecture 6: Null hypothesis significance testings</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/07_power/07_power.html">Lecture 7: Statistical power</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/08_anova/08_anova.html">Lecture 8: Linear models part 2: categorical predictor &gt; 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/09_mult_comp/09_mult_comp.html">Lecture 9: Multiple Comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/10_regression/10_regression.html">Lecture 10: Multiple Regression</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-labs" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Labs</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-labs">
<li><a class="dropdown-item" href="../articles/lab01_intro_to_R.html">Lab 1: Introduction to R</a></li>
    <li><a class="dropdown-item" href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to projects and RMarkdown</a></li>
    <li><a class="dropdown-item" href="../articles/lab03_inference.html">Lab 3: Using R to explore sampling error</a></li>
    <li><a class="dropdown-item" href="../articles/lab04_t-tests.html">Lab 4: t-tests</a></li>
    <li><a class="dropdown-item" href="../articles/lab05_ANOVA.html">Lab 5: ANOVA</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-references" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-pencil-square-o"></span> References</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-references">
<li><a class="dropdown-item" href="../articles/homework.html">Assignment instructions</a></li>
    <li><a class="dropdown-item" href="../articles/projects_and_directories.html">Projects and directories</a></li>
    <li><a class="dropdown-item" href="../articles/RMarkdown.html">R Markdown reference</a></li>
    <li><a class="dropdown-item" href="../articles/graphics.html">Creating publication-quality graphics</a></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Lab 6: Interactions</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2024</h4>
            
      

      <div class="d-none name"><code>lab06_interactions.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="lab-5">Lab 5<a class="anchor" aria-label="anchor" href="#lab-5"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<p>Multiple Regression</p>
<ol style="list-style-type: lower-alpha">
<li><p>ANCOVA</p></li>
<li><p>Blocking</p></li>
</ol>
</li>
<li><p>Centering predictors</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="todays-topics">Today’s topics<a class="anchor" aria-label="anchor" href="#todays-topics"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<p>Interactions</p>
<ol style="list-style-type: lower-alpha">
<li><p>Definition</p></li>
<li><p>Identifying interactions visually</p></li>
<li><p>Types of interactions</p></li>
</ol>
</li>
<li>
<p>Factorial Designs</p>
<ol style="list-style-type: lower-alpha">
<li><p>2-way Factorial Designs using aov()</p></li>
<li><p>Post-hoc analyses</p></li>
<li><p>Visualizing a 2-way Factorial Design</p></li>
<li><p>2-way Factorial Designs using lm()</p></li>
</ol>
</li>
</ol>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="interactions">Interactions<a class="anchor" aria-label="anchor" href="#interactions"></a>
</h2>
<div class="section level3">
<h3 id="scenario">Scenario<a class="anchor" aria-label="anchor" href="#scenario"></a>
</h3>
<p>So far we have talked about models with one categorical predictor
(ANOVA), models with one continuous predictor (simple linear
regression), models with a categorical predictor while accounting for a
continuous predictor (ANCOVA), and models with two categorical
predictors where one is not of interest (Blocked design). Now we will
discuss scenarios where there are multiple predictors and they are all
of interest to the researcher. Additionally, and most importantly for
this lab, the relationship between/among these predictors is also of
interest. This relationship mentioned above is referred to as an
<strong>interaction</strong>.</p>
<p><br></p>
<p>An <strong>interaction</strong> in model design terms refers to the
phenomenon when the effect of one predictor variable depends on the
values of one or more other predictor variables.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="visualizing-an-interaction">Visualizing an Interaction<a class="anchor" aria-label="anchor" href="#visualizing-an-interaction"></a>
</h3>
<div class="figure" style="text-align: left">
<img src="lab06_interactions_files/figure-html/unnamed-chunk-3-1.png" alt="**Figure 1: Relationship between predictor variable (x) and response variable (y) across two levels of second predictor variable. Left figure represents no interaction while right figure represents presence of an interaction.**" width="768"><p class="caption">
<strong>Figure 1: Relationship between predictor variable (x) and
response variable (y) across two levels of second predictor variable.
Left figure represents no interaction while right figure represents
presence of an interaction.</strong>
</p>
</div>
<p><br></p>
<p>As we saw in lecture, interactions can take many forms but the
overall interpretation is the same. An interaction could be between two
continuous variables, a continuous and categorical variable, or between
two categorical variables. We will look at a few examples of these
below.</p>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="data-example-1">Data Example 1<a class="anchor" aria-label="anchor" href="#data-example-1"></a>
</h3>
<p>In this dataset, two continuous predictor variables (moon phase and
percent cloud cover) are being used to predict the call rate of
Chuck-will’s-widow. Although the researchers are interested in each of
these variables alone, they are also interested in determining how the
values of one predictor may alter the effects of the other.</p>
<p>Load the <code>chuckdata</code> dataset and examine the data</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'chuckdata'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">chuckdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    60 obs. of  4 variables:</span></span>
<span><span class="co">#&gt;  $ X        : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ call.rate: num  2.9 3.65 3.68 2.73 3.56 ...</span></span>
<span><span class="co">#&gt;  $ cloud    : num  0.1185 0.9156 0.0941 0.8536 0.14 ...</span></span>
<span><span class="co">#&gt;  $ moon     : num  0.241 0.56 0.56 0.855 0.24 ...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">chuckdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;        X          call.rate         cloud             moon       </span></span>
<span><span class="co">#&gt;  Min.   : 1.0   Min.   :0.736   Min.   :0.0394   Min.   :0.0006  </span></span>
<span><span class="co">#&gt;  1st Qu.:15.8   1st Qu.:2.840   1st Qu.:0.2242   1st Qu.:0.2200  </span></span>
<span><span class="co">#&gt;  Median :30.5   Median :3.441   Median :0.4965   Median :0.4399  </span></span>
<span><span class="co">#&gt;  Mean   :30.5   Mean   :3.361   Mean   :0.5171   Mean   :0.4464  </span></span>
<span><span class="co">#&gt;  3rd Qu.:45.2   3rd Qu.:3.840   3rd Qu.:0.8123   3rd Qu.:0.7131  </span></span>
<span><span class="co">#&gt;  Max.   :60.0   Max.   :5.594   Max.   :0.9697   Max.   :0.9930</span></span></code></pre></div>
<p><br></p>
<p>Notice that several of the variables in the dataset are recorded as
percentages. This fact will affect the way that we interpret the model
output. As they are defined now, our interpretation of a slope means
that call rate will change some amount for <strong>each unit</strong>
change in cloud cover or moon phase. Currently, one unit of these
variables represents the difference between 0% and 100%. It would be
more intuitive for us to talk about changes in call rate for each
percent change in the predictors. To do this, we can simply modify our
dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chuckdata</span><span class="op">$</span><span class="va">cloud</span> <span class="op">&lt;-</span> <span class="va">chuckdata</span><span class="op">$</span><span class="va">cloud</span><span class="op">*</span><span class="fl">100</span></span>
<span><span class="va">chuckdata</span><span class="op">$</span><span class="va">moon</span> <span class="op">&lt;-</span> <span class="va">chuckdata</span><span class="op">$</span><span class="va">moon</span><span class="op">*</span><span class="fl">100</span></span></code></pre></div>
<p>Now a one unit change in these predictors represents a one percent
change.</p>
<p><br><br></p>
<p>Next, it would be a good idea to plot the relationship between the
response variable and each predictor.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ```{r, fig.width=8, fig.height=4} R code chunk options for making this plot</span></span>
<span><span class="co"># install.packages('gridExtra') Check your package library to see if you already have this package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">chuckdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">cloud</span>, y<span class="op">=</span> <span class="va">call.rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">chuckdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">moon</span>, y<span class="op">=</span> <span class="va">call.rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span>, ncol<span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab06_interactions_files/figure-html/unnamed-chunk-6-1.png" alt="**Figure 2: Relationship between call rate of Chuck wills widow and two predictor variables, cloud cover and moon phase.**" width="768"><p class="caption">
<strong>Figure 2: Relationship between call rate of Chuck wills widow
and two predictor variables, cloud cover and moon phase.</strong>
</p>
</div>
<p><br></p>
<p><strong>Does there appear to be a relationship between call rate and
either of these predictor variables?</strong></p>
<p><br><br><br><br></p>
<p>Let’s use a linear model to look at the relationships. First, we need
to define our linear model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>x</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>x</mi><mrow><mn>2</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><msub><mi>x</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><msub><mi>x</mi><mrow><mn>2</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">
y_i = \beta_0 + \beta_1x_{1i} + \beta_2x_{2i} + \beta_3x_{1i}x_{2i} + \epsilon_i
</annotation></semantics></math></p>
<p><strong>How would you interpret each of these terms? Which ones
represent the main effects and which represents the
interaction?</strong></p>
<p><br><br></p>
<p>Now we are ready to specify our model in <code>R</code><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;There are two ways to denote interactions in the model
statement. The more broad method is shown above using an asterisk
between the two predictors. This tells &lt;code&gt;R&lt;/code&gt; to include all of
the main effects of these predictors as well as the interactions. In the
case of a 3-way Factorial Design we could have something like A*B*C
which would be interpreted as main effect of A, main effect of B, main
effect of C, interaction between A and B, interaction between A and C,
interaction between B and C, and interaction among A,B, and C. While the
notation above saves time and space, we are not always actually
interested in all of the possible interactions available to be
estimated. Instead, we may want to include several main effects but only
investigate a subset of interaction. For example, in a 3-way design if
we were only interested in the interactions between A and B, we could
write &lt;code&gt;response~ A + B + C + A:B&lt;/code&gt;. This would tell
&lt;code&gt;R&lt;/code&gt; to only include that specific interaction term.&lt;/p&gt;"><sup>1</sup></a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">call.rate</span><span class="op">~</span> <span class="va">moon</span><span class="op">*</span><span class="va">cloud</span>, data<span class="op">=</span> <span class="va">chuckdata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = call.rate ~ moon * cloud, data = chuckdata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -2.365 -0.392  0.158  0.560  1.497 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  2.582092   0.405007    6.38  3.7e-08 ***</span></span>
<span><span class="co">#&gt; moon         0.027339   0.008023    3.41   0.0012 ** </span></span>
<span><span class="co">#&gt; cloud        0.002281   0.006423    0.36   0.7238    </span></span>
<span><span class="co">#&gt; moon:cloud  -0.000239   0.000123   -1.94   0.0573 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.833 on 56 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.281,  Adjusted R-squared:  0.243 </span></span>
<span><span class="co">#&gt; F-statistic: 7.31 on 3 and 56 DF,  p-value: 0.000322</span></span></code></pre></div>
<p><strong>How would you interpret these parameter estimates? Were the
main effects significant? Was the interaction significant? Given the
results you see here, would it be appropriate for the researcher to
consider the main effects independently of each other?</strong></p>
<p><br><br></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nd1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>moon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">chuckdata</span><span class="op">$</span><span class="va">moon</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">chuckdata</span><span class="op">$</span><span class="va">moon</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                 cloud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nd2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>moon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">chuckdata</span><span class="op">$</span><span class="va">moon</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">chuckdata</span><span class="op">$</span><span class="va">moon</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                 cloud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">E1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod1</span>, newdata <span class="op">=</span> <span class="va">nd1</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span>, interval<span class="op">=</span><span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">predictionData1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">E1</span><span class="op">$</span><span class="va">fit</span>, <span class="va">nd1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">E2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod1</span>, newdata <span class="op">=</span> <span class="va">nd2</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span>, interval<span class="op">=</span><span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">predictionData2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">E2</span><span class="op">$</span><span class="va">fit</span>, <span class="va">nd2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'0'</span> <span class="op">=</span> <span class="st">'black'</span>, <span class="st">'100'</span> <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">chuckdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">moon</span>, y <span class="op">=</span> <span class="va">call.rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predictionData1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">moon</span>, ymin <span class="op">=</span> <span class="va">lwr</span>, ymax <span class="op">=</span> <span class="va">upr</span><span class="op">)</span>,</span>
<span>              color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"longdash"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predictionData1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">moon</span>, y <span class="op">=</span> <span class="va">fit</span>, color<span class="op">=</span> <span class="st">'0'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">predictionData2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">moon</span>, ymin <span class="op">=</span> <span class="va">lwr</span>, ymax <span class="op">=</span> <span class="va">upr</span><span class="op">)</span>,</span>
<span>              color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'longdash'</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predictionData2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">moon</span>, y <span class="op">=</span> <span class="va">fit</span>, color<span class="op">=</span> <span class="st">'100'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span> <span class="va">colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color<span class="op">=</span> <span class="st">'Cloud cover'</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab06_interactions_files/figure-html/unnamed-chunk-9-1.png" alt="**Figure 3: Predicted call rate of Chuck wills widow as a function of moon phase. Solid lines represent fitted values and dashed lines represent 95% confidence bands. Predictions shown for two values of cloud cover (0 = black, 100 = red).**" width="768"><p class="caption">
<strong>Figure 3: Predicted call rate of Chuck wills widow as a function
of moon phase. Solid lines represent fitted values and dashed lines
represent 95% confidence bands. Predictions shown for two values of
cloud cover (0 = black, 100 = red).</strong>
</p>
</div>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="data-example-2">Data example 2<a class="anchor" aria-label="anchor" href="#data-example-2"></a>
</h3>
<p>Below is a dataset which contains information about a species of
<em>microtus</em> vole. Voles are small rodents found throughout the
world which generally feed on grasses, grains, and seeds. In this
experiment, a population of voles has been introduced into 24
enclosures. Each enclosure is randomly assigned to two treatments- food
(three levels) and predator presence (two levels). After a specified
period of time the number of surviving voles in each enclosure is
counted. The researcher is particularly interested in understanding how
food availability affects the vole population while also taking into
account the presence or absence of predators.</p>
<p>The dataset described above can best be approached through a
particular kind of ANOVA which is referred to as a <strong>Factorial
Design</strong>.</p>
<p>A factorial design is commonly used when:</p>
<ol style="list-style-type: decimal">
<li>There are multiple categorical predictors</li>
<li>The interactions between/among predictors is of interest</li>
<li>There are replicates within each combination of treatment
levels</li>
</ol>
<p>Load the <code>microtusdata</code> dataset and examine the data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"microtusdata"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">microtusdata</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:center;">
voles
</th>
<th style="text-align:center;">
food
</th>
<th style="text-align:center;">
predators
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
Present
</td>
</tr>
<tr>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
Present
</td>
</tr>
<tr>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
Present
</td>
</tr>
<tr>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
Present
</td>
</tr>
<tr>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
Present
</td>
</tr>
<tr>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
Present
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">microtusdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    24 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ voles    : int  10 12 8 14 18 20 21 24 20 18 ...</span></span>
<span><span class="co">#&gt;  $ food     : Factor w/ 3 levels "0","1","2": 1 1 1 1 2 2 2 2 3 3 ...</span></span>
<span><span class="co">#&gt;  $ predators: chr  "Present" "Present" "Present" "Present" ...</span></span></code></pre></div>
<p>Before proceeding, we need to convert <code>food</code> and
<code>predators</code> to factors:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">microtusdata</span><span class="op">$</span><span class="va">food</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">microtusdata</span><span class="op">$</span><span class="va">food</span><span class="op">)</span></span>
<span><span class="va">microtusdata</span><span class="op">$</span><span class="va">predators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">microtusdata</span><span class="op">$</span><span class="va">predators</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">microtusdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    24 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ voles    : int  10 12 8 14 18 20 21 24 20 18 ...</span></span>
<span><span class="co">#&gt;  $ food     : Factor w/ 3 levels "0","1","2": 1 1 1 1 2 2 2 2 3 3 ...</span></span>
<span><span class="co">#&gt;  $ predators: Factor w/ 2 levels "Absent","Present": 2 2 2 2 2 2 2 2 2 2 ...</span></span></code></pre></div>
<p>How many replicates do we have?</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">microtusdata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"predators"</span>,<span class="st">"food"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          food</span></span>
<span><span class="co">#&gt; predators 0 1 2</span></span>
<span><span class="co">#&gt;   Absent  4 4 4</span></span>
<span><span class="co">#&gt;   Present 4 4 4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-the-data">Visualizing the data<a class="anchor" aria-label="anchor" href="#visualizing-the-data"></a>
</h3>
<p>Visualizing multiple factors at once can sometimes be tricky. We’ll
use the <code>fill</code> aestethic to make separate boxplots for each
predation level, within each food treatment:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">microtusdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">food</span>, y <span class="op">=</span> <span class="va">voles</span>, fill <span class="op">=</span> <span class="va">predators</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span><span class="st">"Food treatment"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Number of voles"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab06_interactions_files/figure-html/unnamed-chunk-15-1.png" alt="**Figure 4: Number of voles in each enclosure as a function of food treatment levels. Colors represent predator treatment.**" width="576"><p class="caption">
<strong>Figure 4: Number of voles in each enclosure as a function of
food treatment levels. Colors represent predator treatment.</strong>
</p>
</div>
<p><br></p>
<p>It’s clear from this figure that 1) food supplementation influences
vole abundance, and 2) the effects of food treatment depend on whether
predators are present or absent.</p>
</div>
<div class="section level3">
<h3 id="defining-the-model">Defining the model<a class="anchor" aria-label="anchor" href="#defining-the-model"></a>
</h3>
<p>Below is the equation we might use to define our linear model for a
2-way factorial design:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><mi>μ</mi><mo>+</mo><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msub><mi>β</mi><mi>j</mi></msub><mo>+</mo><mi>α</mi><msub><mi>β</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">where</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>ϵ</mi><mi>i</mi></msub><mo>∼</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
y_{ijk} = \mu + \alpha_i + \beta_j + \alpha\beta_{ij} + \epsilon_{ijk} \ \ \ \ \ \text{where} \ \ \ \ \ \epsilon_i \sim \text{N}(0,\sigma)
</annotation></semantics></math></p>
<p><strong>Notice the increased complexity of the subscripting. What
does each represent? What does the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><msub><mi>β</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha\beta_{ij}</annotation></semantics></math>
term represent?</strong></p>
<p><strong>Can you list all of the relevant null and alternative
hypotheses?</strong></p>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="factorial-design-using-aov">Factorial design using <code>aov()</code><a class="anchor" aria-label="anchor" href="#factorial-design-using-aov"></a>
</h3>
<p>We can analyze the <em>microtus</em> data using the
<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> function that we’re already familiar with.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aov1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">voles</span> <span class="op">~</span> <span class="va">food</span> <span class="op">*</span> <span class="va">predators</span>, data <span class="op">=</span> <span class="va">microtusdata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span><span class="co">#&gt;                Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; food            2   1337     669    40.6 2.1e-07 ***</span></span>
<span><span class="co">#&gt; predators       1    975     975    59.2 4.3e-07 ***</span></span>
<span><span class="co">#&gt; food:predators  2    518     259    15.7 0.00011 ***</span></span>
<span><span class="co">#&gt; Residuals      18    297      16                    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<hr>
<p>On your own, fit the model without the interaction
(<code>food + predators</code>). How do the results compare?</p>
<hr>
</div>
<div class="section level3">
<h3 id="follow-ups">Follow ups<a class="anchor" aria-label="anchor" href="#follow-ups"></a>
</h3>
<p>Often in your own analysis, you will not stop at a significant ANOVA
result. For example, maybe you want to further explore the effects of
one factor while holding the other factor constant. In this case, we can
further test whether food supplements influence vole abundance <em>when
predators are present</em> using the <code>subset</code> argument:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">voles</span> <span class="op">~</span> <span class="va">food</span>, </span>
<span>            data <span class="op">=</span> <span class="va">microtusdata</span>, </span>
<span>            subset <span class="op">=</span> <span class="va">predators</span> <span class="op">==</span> <span class="st">"Present"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; food         2  193.5    96.7    14.8 0.0014 **</span></span>
<span><span class="co">#&gt; Residuals    9   58.7     6.5                  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Or when predators are absent:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">voles</span> <span class="op">~</span> <span class="va">food</span>, </span>
<span>            data <span class="op">=</span> <span class="va">microtusdata</span>, </span>
<span>            subset <span class="op">=</span> <span class="va">predators</span> <span class="op">==</span> <span class="st">"Absent"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; food         2   1662     831    31.4 8.7e-05 ***</span></span>
<span><span class="co">#&gt; Residuals    9    238      26                    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Or maybe we want to test which levels are different using our old
friend the Tukey HSD test, which for the factorial design will return
both the “main” effect differences and the interaction<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Depending on the number of factors and levels, we may
not want to view all of the pairwise comparisons at once. Adding the
&lt;code&gt;which=&lt;/code&gt; argument to the &lt;code&gt;TukeyHSD&lt;/code&gt; function tells
&lt;code&gt;R&lt;/code&gt; which factors we are interested in having displayed.&lt;/p&gt;"><sup>2</sup></a>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Tukey multiple comparisons of means</span></span>
<span><span class="co">#&gt;     95% family-wise confidence level</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fit: aov(formula = voles ~ food * predators, data = microtusdata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $food</span></span>
<span><span class="co">#&gt;       diff    lwr    upr  p adj</span></span>
<span><span class="co">#&gt; 1-0 13.875  8.694 19.056 0.0000</span></span>
<span><span class="co">#&gt; 2-0 17.250 12.069 22.431 0.0000</span></span>
<span><span class="co">#&gt; 2-1  3.375 -1.806  8.556 0.2464</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $predators</span></span>
<span><span class="co">#&gt;                  diff    lwr    upr p adj</span></span>
<span><span class="co">#&gt; Present-Absent -12.75 -16.23 -9.267     0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`food:predators`</span></span>
<span><span class="co">#&gt;                       diff      lwr     upr  p adj</span></span>
<span><span class="co">#&gt; 1:Absent-0:Absent    18.00   8.8756  27.124 0.0001</span></span>
<span><span class="co">#&gt; 2:Absent-0:Absent    28.50  19.3756  37.624 0.0000</span></span>
<span><span class="co">#&gt; 0:Present-0:Absent   -2.50 -11.6244   6.624 0.9488</span></span>
<span><span class="co">#&gt; 1:Present-0:Absent    7.25  -1.8744  16.374 0.1684</span></span>
<span><span class="co">#&gt; 2:Present-0:Absent    3.50  -5.6244  12.624 0.8221</span></span>
<span><span class="co">#&gt; 2:Absent-1:Absent    10.50   1.3756  19.624 0.0189</span></span>
<span><span class="co">#&gt; 0:Present-1:Absent  -20.50 -29.6244 -11.376 0.0000</span></span>
<span><span class="co">#&gt; 1:Present-1:Absent  -10.75 -19.8744  -1.626 0.0158</span></span>
<span><span class="co">#&gt; 2:Present-1:Absent  -14.50 -23.6244  -5.376 0.0010</span></span>
<span><span class="co">#&gt; 0:Present-2:Absent  -31.00 -40.1244 -21.876 0.0000</span></span>
<span><span class="co">#&gt; 1:Present-2:Absent  -21.25 -30.3744 -12.126 0.0000</span></span>
<span><span class="co">#&gt; 2:Present-2:Absent  -25.00 -34.1244 -15.876 0.0000</span></span>
<span><span class="co">#&gt; 1:Present-0:Present   9.75   0.6256  18.874 0.0323</span></span>
<span><span class="co">#&gt; 2:Present-0:Present   6.00  -3.1244  15.124 0.3351</span></span>
<span><span class="co">#&gt; 2:Present-1:Present  -3.75 -12.8744   5.374 0.7781</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-the-results">Visualizing the results<a class="anchor" aria-label="anchor" href="#visualizing-the-results"></a>
</h3>
<p>Another follow up that will often be important is visualizing the
results of the ANOVA model. In the case of the factorial design, this
will generally involve making a graph of the predicted response (and
associated uncertainty!) for each combination of factors.</p>
<p>To create the data that will form the basis of this visualization,
we’ll first use the <code><a href="https://rdrr.io/r/stats/model.tables.html" class="external-link">model.tables()</a></code> function to compute the
relevant means (i.e., predicted values) and standard errors:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html" class="external-link">model.tables</a></span><span class="op">(</span><span class="va">aov1</span>, type<span class="op">=</span><span class="st">"means"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tables of means</span></span>
<span><span class="co">#&gt; Grand mean</span></span>
<span><span class="co">#&gt;       </span></span>
<span><span class="co">#&gt; 22.62 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  food </span></span>
<span><span class="co">#&gt; food</span></span>
<span><span class="co">#&gt;     0     1     2 </span></span>
<span><span class="co">#&gt; 12.25 26.12 29.50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  predators </span></span>
<span><span class="co">#&gt; predators</span></span>
<span><span class="co">#&gt;  Absent Present </span></span>
<span><span class="co">#&gt;   29.00   16.25 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  food:predators </span></span>
<span><span class="co">#&gt;     predators</span></span>
<span><span class="co">#&gt; food Absent Present</span></span>
<span><span class="co">#&gt;    0 13.50  11.00  </span></span>
<span><span class="co">#&gt;    1 31.50  20.75  </span></span>
<span><span class="co">#&gt;    2 42.00  17.00  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standard errors for differences of means</span></span>
<span><span class="co">#&gt;          food predators food:predators</span></span>
<span><span class="co">#&gt;         2.030     1.658          2.871</span></span>
<span><span class="co">#&gt; replic.     8        12              4</span></span></code></pre></div>
<p>Next, we’ll extract the group means</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ybar_ij.</span> <span class="op">&lt;-</span> <span class="va">tab</span><span class="op">$</span><span class="va">tables</span><span class="op">$</span><span class="st">"food:predators"</span><span class="op">)</span></span>
<span><span class="co">#&gt;     predators</span></span>
<span><span class="co">#&gt; food Absent Present</span></span>
<span><span class="co">#&gt;    0 13.50  11.00  </span></span>
<span><span class="co">#&gt;    1 31.50  20.75  </span></span>
<span><span class="co">#&gt;    2 42.00  17.00</span></span></code></pre></div>
<p>What about confidence intervals? Notice that
<code><a href="https://rdrr.io/r/stats/model.tables.html" class="external-link">model.tables()</a></code> returns “Standard errors for differences of
means”.</p>
<p>Extending the formulas to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \times B</annotation></semantics></math>
factorial case, the confidence interval for the difference in two
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \times B</annotation></semantics></math>
means is:</p>
<p><span class="math display">$$\Large CI_{1−\alpha} : \bar{y}_{ij.} −
\bar{y}_{ij.′} \pm t_{1−\alpha/2,ab(n−1)}\times
\sqrt{\frac{2MSE}{n}}$$</span></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">n = 4</annotation></semantics></math>
in the vole example.</p>
<p>To set up a plot of the group means, however, we need a confidence
interval for each mean. We take out the ‘2’ from the SE expression:</p>
<p><span class="math display">$$\Large CI_{1−\alpha} : \bar{y}_{ij.} \pm
t_{1−\alpha/2,ab(n−1)}\times \sqrt{\frac{MSE}{n}}$$</span></p>
<p>Where can we find MSE?</p>
<p>Answer: in the output of <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> of our
<code>aov1</code> object:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span><span class="co">#&gt;                Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; food            2   1337     669    40.6 2.1e-07 ***</span></span>
<span><span class="co">#&gt; predators       1    975     975    59.2 4.3e-07 ***</span></span>
<span><span class="co">#&gt; food:predators  2    518     259    15.7 0.00011 ***</span></span>
<span><span class="co">#&gt; Residuals      18    297      16                    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Calculate the width of the confidence intervals:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`Mean Sq`</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="co">## 16.5</span></span>
<span><span class="va">ybar_ij.SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">MSE</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">CI.half</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fl">0.975</span>, <span class="fl">18</span><span class="op">)</span> <span class="op">*</span> <span class="va">ybar_ij.SE</span></span>
<span><span class="op">(</span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">CI.half</span>, <span class="va">CI.half</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -4.265  4.265</span></span></code></pre></div>
<p>Now we can create a data frame and plot the group means and
confidence intervals. Remember to always check how you have defined the
order of your dataframe and make sure that it matches with the order
that the group means have been displayed in the
<code><a href="https://rdrr.io/r/stats/model.tables.html" class="external-link">model.tables()</a></code> function.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predicted.voles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Food <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                              Predators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Absent"</span>, <span class="st">"Present"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>                              voles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ybar_ij.</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Add lower and upper confidence intervals</span></span>
<span><span class="va">predicted.voles</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">predicted.voles</span>, </span>
<span>                                 LCI <span class="op">=</span> <span class="va">voles</span> <span class="op">+</span> <span class="va">CI</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                 UCI <span class="op">=</span> <span class="va">voles</span> <span class="op">+</span> <span class="va">CI</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">predicted.voles</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Food</span>, y <span class="op">=</span> <span class="va">voles</span>, </span>
<span>                            color <span class="op">=</span> <span class="va">Predators</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">Predators</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">LCI</span>, ymax <span class="op">=</span> <span class="va">UCI</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Predicted number of voles"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="lab06_interactions_files/figure-html/unnamed-chunk-25-1.png" alt="**Figure 5: Predicted number of voles in each enclosure as a function of food treatment level. Point estimates shown with 95% confidence intervals. Colors represent predator treatment levels.**" width="576"><p class="caption">
<strong>Figure 5: Predicted number of voles in each enclosure as a
function of food treatment level. Point estimates shown with 95%
confidence intervals. Colors represent predator treatment
levels.</strong>
</p>
</div>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="factorial-design-using-lm">Factorial Design using <code>lm()</code><a class="anchor" aria-label="anchor" href="#factorial-design-using-lm"></a>
</h3>
<p>Although we have already completed the analysis, lets also look at
how we could have built this model using the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>
function.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">voles</span><span class="op">~</span> <span class="va">food</span><span class="op">*</span><span class="va">predators</span>, data<span class="op">=</span> <span class="va">microtusdata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = voles ~ food * predators, data = microtusdata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt;  -9.50  -2.19   0.00   2.25   8.50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)               13.50       2.03    6.65  3.1e-06 ***</span></span>
<span><span class="co">#&gt; food1                     18.00       2.87    6.27  6.5e-06 ***</span></span>
<span><span class="co">#&gt; food2                     28.50       2.87    9.93  1.0e-08 ***</span></span>
<span><span class="co">#&gt; predatorsPresent          -2.50       2.87   -0.87    0.395    </span></span>
<span><span class="co">#&gt; food1:predatorsPresent    -8.25       4.06   -2.03    0.057 .  </span></span>
<span><span class="co">#&gt; food2:predatorsPresent   -22.50       4.06   -5.54  2.9e-05 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.06 on 18 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.905,  Adjusted R-squared:  0.879 </span></span>
<span><span class="co">#&gt; F-statistic: 34.3 on 5 and 18 DF,  p-value: 1.34e-08</span></span></code></pre></div>
<p><strong>There is a lot going on here. Can you interpret each of the
parameter estimates (especially the interaction term)? What do we
conclude about the original set of hypotheses related to our
model?</strong></p>
<p><br><br><br></p>
</div>
</div>
<div class="section level2">
<h2 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h2>
<p>In the field of fisheries, hard calcified structures such as otoliths
and fin spines are frequently used to age individual animals. Similar to
trees, these structures lay down annual growth rings which can be
counted to estimate age. The use of spines instead of the more
traditional aging structure in fish, otoliths, has the advantage that it
usually does not require killing the fish. Otoliths, however, typically
produce higher quality images since they are less susceptible to being
damaged during the life of the fish.</p>
<p>A graduate student at UGA is conducting studies on Lake Sturgeon
(<em>Acipenser fulvescens</em>), a large river dwelling fish which in
Georgia is only found in the northwestern corner of the state. The
student plans to use the calcified structures from these fish to better
understand the population age-distribution. Before examining growth
annuli, however, the student needs to cut the structures and mount them
on microscope slides.</p>
<p>In the dataset below, the student has processed 36 structures (some
spines and some otoliths) using 3 different mounting methods (A, B, and
C) and 3 different saw speeds (low, medium, and high). Once mounted, the
time required (seconds) to accurately age each structure was recorded
for each fish.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"agingdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">agingdata</span><span class="op">)</span></span></code></pre></div>
<p><strong>Questions/tasks</strong></p>
<ol style="list-style-type: decimal">
<li><p>Write out an equation for the linear model that would describe
this scenario. Define each term (1 pt).</p></li>
<li><p>Analyze this dataset using an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mi>B</mi><mo>×</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A \times B \times C</annotation></semantics></math>
factorial ANOVA implemented with <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>. Because the student
is not interested in the 3-way interaction, set up your model so that it
does not include that term (only include the main effects and 2-way
interactions of all variables) (1 pt).</p></li>
<li><p>Interpret the model output. Which main effects and which
interactions were significant? (2 pt)</p></li>
<li><p>Does the effect of the mounting method depend on the speed of the
saw? If so, how? (1 pt)</p></li>
<li><p>Which combination of mounting method, saw speed, and structure
type resulted in the lowest average aging time? (0.5 pt)</p></li>
<li><p>The student has decided that he is going to use fin spines in
future studies because he does not want to use the lethal method of
collecting otoliths. Given that, which combination of mounting method
and saw speed would result in the lowest average aging time? (0.5
pt)</p></li>
</ol>
<p>Put your answers in an R Markdown report. Your report should
include:</p>
<ol style="list-style-type: decimal">
<li><p>A well-formatted ANOVA table (with header); and</p></li>
<li><p>A publication-quality plot of the estimated effect of mounting
method on aging time for both types of hard structures, including 95%
confidence intervals. Rather than making 3 plots (one for each saw
speed), use the predictions for ‘high speed’ only. The figure should
also have a descriptive caption and any aesthetics (color, line type,
etc.) should be clearly defined.</p></li>
</ol>
<p>You may format the report however you like but it should be
well-organized, with relevant headers, plain text, and the elements
described above.</p>
<p>As always:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Be sure to include your first and last name in the
<code>author</code> section</p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so we can see both your code and the output</p></li>
<li><p>See the R Markdown reference sheet for help with creating
<code>R</code> chunks, equations, tables, etc.</p></li>
<li><p>See the “Creating publication-quality graphics” reference sheet
for tips on formatting figures</p></li>
</ul>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
