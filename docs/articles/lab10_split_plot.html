<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 10: Split plot designs • FANR6750</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.0/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lab 10: Split plot designs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FANR6750</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fa-home"></span></a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../articles/syllabus.html"><span class="fa fas fa-book"></span> Syllabus</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/schedule.html"><span class="fa fas fa-calendar"></span> Schedule</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lectures" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-file-pdf-o"></span> Lectures</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lectures">
<li><a class="dropdown-item" href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/01_intro_to_stats/01_intro_to_stats.html">Lecture 1: Introduction to statistics</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/02_intro_to_lm/02_intro_to_lm.html">Lecture 2: Introduction to linear models</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/03_inference/03_inference.html">Lecture 3: Principles of inference</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/04_principles_of_expdesign/04_expdesign.html">Lecture 4: Principles of experimental design</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/05_t-test/05_t-test.html">Lecture 5: Linear models part 1: categorical predictor w/ 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/06_nht/06_nht.html">Lecture 6: Null hypothesis significance testings</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/07_power/07_power.html">Lecture 7: Statistical power</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/08_anova/08_anova.html">Lecture 8: Linear models part 2: categorical predictor &gt; 2 levels</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/09_mult_comp/09_mult_comp.html">Lecture 9: Multiple Comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/10_regression/10_regression.html">Lecture 10: Multiple Regression</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/11_interactions/11_interactions.html">Lecture 11: Interactions</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/12_assumptions/12_assumptions.html">Lecture 12: Evaluating assumptions</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/13_model_selection/13_model_selection.html">Lecture 13: Model selection</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/14_random_effects/14_random_effects.html">Lecture 14: Random effects</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-labs" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Labs</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-labs">
<li><a class="dropdown-item" href="../articles/lab01_intro_to_R.html">Lab 1: Introduction to R</a></li>
    <li><a class="dropdown-item" href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to projects and RMarkdown</a></li>
    <li><a class="dropdown-item" href="../articles/lab03_inference.html">Lab 3: Using R to explore sampling error</a></li>
    <li><a class="dropdown-item" href="../articles/lab04_t-tests.html">Lab 4: t-tests</a></li>
    <li><a class="dropdown-item" href="../articles/lab05_ANOVA.html">Lab 5: ANOVA</a></li>
    <li><a class="dropdown-item" href="../articles/lab06_multiple_regression.html">Lab 6: Multiple Regression</a></li>
    <li><a class="dropdown-item" href="../articles/lab07_interactions.html">Lab 7: Interactions</a></li>
    <li><a class="dropdown-item" href="../articles/lab08_model_assumptions.html">Lab 8: Evaluating assumptions</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-references" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-pencil-square-o"></span> References</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-references">
<li><a class="dropdown-item" href="../articles/homework.html">Assignment instructions</a></li>
    <li><a class="dropdown-item" href="../articles/projects_and_directories.html">Projects and directories</a></li>
    <li><a class="dropdown-item" href="../articles/RMarkdown.html">R Markdown reference</a></li>
    <li><a class="dropdown-item" href="../articles/graphics.html">Creating publication-quality graphics</a></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Lab 10: Split plot designs</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2024</h4>
            
      

      <div class="d-none name"><code>lab10_split_plot.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="lab">Lab<a class="anchor" aria-label="anchor" href="#lab"></a>
</h3>
<ul>
<li>
<p>Nested ANOVA</p>
<ul>
<li><p>Random effects</p></li>
<li><p>Using lme() and aov()</p></li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="todays-topics">Today’s topics<a class="anchor" aria-label="anchor" href="#todays-topics"></a>
</h3>
<ul>
<li>
<p>Split Plot Design</p>
<ul>
<li><p>The additive model</p></li>
<li><p>Using aov() and lme()</p></li>
<li><p>Exploring interactions</p></li>
<li><p>Multiple comparisons</p></li>
</ul>
</li>
</ul>
<p><br></p>
</div>
<div class="section level2">
<h2 id="scenario">Scenario<a class="anchor" aria-label="anchor" href="#scenario"></a>
</h2>
<p>Remember from lecture that split-plot designs are used when we apply
treatments to two levels of experimental units: whole-units and
sub-units. We can conceptualize this as two blocked designs, one nested
inside the other.</p>
<p>For example</p>
<ul>
<li><p>Ag fields are sprayed with herbicides, and fertilizers are
applied to plots within fields</p></li>
<li><p>Tenderizer is applied to roasts, and cooking times are applied to
cores</p></li>
</ul>
<p>In these cases, we’re interested in treatment effects at
<strong>both</strong> levels</p>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="the-additive-model">The additive model<a class="anchor" aria-label="anchor" href="#the-additive-model"></a>
</h2>
<p>We can write the split plot model as:</p>
<p><span class="math display">$$\Large y_{ijk} = \mu + \alpha_i +
\beta_j + \alpha \beta_{ij} + \gamma_k + \delta_{ik} +
\epsilon_{ijk}$$</span> Where:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">i = 1,...,a</annotation></semantics></math>:
The whole unit treatment levels</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">j = 1,...,b</annotation></semantics></math>:
The sub unit treatment levels</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">k = 1,...,c</annotation></semantics></math>:
The number of blocks</p>
<p><br></p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>’s
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>’s
are fixed treatment effects where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math>
represents the treatment applied to the whole unit and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math>
represents the treatment applied to the sub unit. Note the
interaction.</p>
<p>Because we want our inferences to apply to all whole units (e.g.,
roasts),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\delta_{ik}</annotation></semantics></math>
is random. Specifically:</p>
<p><span class="math display">$$\Large \delta_{ik} \sim normal(0,
\sigma^2_R)$$</span></p>
<p>We might view block (e.g. carcass) as random too:</p>
<p><span class="math display">$$\Large \gamma_k \sim normal(0,
\sigma^2_C)$$</span></p>
<p>And as always,</p>
<p><span class="math display">$$\Large \epsilon_{ijk} \sim normal(0,
\sigma^2)$$</span></p>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="data-example">Data example<a class="anchor" aria-label="anchor" href="#data-example"></a>
</h2>
<p>Below is a classic dataset which comes from a food science study. Six
beef carcasses are obtained at random from a meat packaging plant. From
the same section on each carcass, three rolled roasts are prepared as
nearly alike as possible. Each of the roasts is assigned at random to
one of three tenderizing treatments of particular interest: control,
vinegar marinade, or papain marinade</p>
<p>After treatment, a coring device is used to make four cores of meat
near the center of each roast. The cores are left in place and the three
roasts from the same carcass are placed together in a oven and allowed
to cook. After 30 minutes, one of the cores is taken at random from each
roast, another drawn randomly after 36 minutes, a third at 42 minutes,
and the final at 48 minutes</p>
<p>After cooling, the cores are measured for tenderness using the
Warner-Bratzler device. The response variable is the WB score for each
core.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rushinglab.github.io/FANR6750">FANR6750</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"meatdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">meatdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    72 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;  $ Wbscore   : num  8.25 7.5 4.25 3.5 7.25 6.25 3.5 3.5 6.5 4.5 ...</span></span>
<span><span class="co">#&gt;  $ tenderizer: chr  "C" "C" "C" "C" ...</span></span>
<span><span class="co">#&gt;  $ time      : int  30 36 42 48 30 36 42 48 30 36 ...</span></span>
<span><span class="co">#&gt;  $ carcass   : int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ roast     : int  1 1 1 1 2 2 2 2 3 3 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">meatdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Wbscore      tenderizer             time         carcass        roast     </span></span>
<span><span class="co">#&gt;  Min.   :2.00   Length:72          Min.   :30.0   Min.   :1.0   Min.   : 1.0  </span></span>
<span><span class="co">#&gt;  1st Qu.:3.25   Class :character   1st Qu.:34.5   1st Qu.:2.0   1st Qu.: 5.0  </span></span>
<span><span class="co">#&gt;  Median :4.25   Mode  :character   Median :39.0   Median :3.5   Median : 9.5  </span></span>
<span><span class="co">#&gt;  Mean   :4.78                      Mean   :39.0   Mean   :3.5   Mean   : 9.5  </span></span>
<span><span class="co">#&gt;  3rd Qu.:6.25                      3rd Qu.:43.5   3rd Qu.:5.0   3rd Qu.:14.0  </span></span>
<span><span class="co">#&gt;  Max.   :8.25                      Max.   :48.0   Max.   :6.0   Max.   :18.0</span></span></code></pre></div>
<p>As we’ve done with other examples, we need to convert each predictor
to a factor (in this case, converting to factors is necessary to use the
<code><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">mcp()</a></code> function, later in the analysis):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meatdata</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">meatdata</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="va">meatdata</span><span class="op">$</span><span class="va">carcass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">meatdata</span><span class="op">$</span><span class="va">carcass</span><span class="op">)</span></span>
<span><span class="va">meatdata</span><span class="op">$</span><span class="va">roast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">meatdata</span><span class="op">$</span><span class="va">roast</span><span class="op">)</span></span>
<span><span class="va">meatdata</span><span class="op">$</span><span class="va">tenderizer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">meatdata</span><span class="op">$</span><span class="va">tenderizer</span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
<p><strong>What does it mean to treat time as a factor? How would you
interpret the results from a model that treated time as a continuous
predictor vs a factor?</strong></p>
<p><br><br></p>
<p>Notice that all the roast column does is enumerate the tenderizer ×
carcass combinations (which explains why the corresponding term in the
additive model is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\delta_{ik}</annotation></semantics></math>):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">meatdata</span>, n<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Wbscore tenderizer time carcass roast</span></span>
<span><span class="co">#&gt; 1     8.25          C   30       1     1</span></span>
<span><span class="co">#&gt; 2     7.50          C   36       1     1</span></span>
<span><span class="co">#&gt; 3     4.25          C   42       1     1</span></span>
<span><span class="co">#&gt; 4     3.50          C   48       1     1</span></span>
<span><span class="co">#&gt; 5     7.25          V   30       1     2</span></span>
<span><span class="co">#&gt; 6     6.25          V   36       1     2</span></span>
<span><span class="co">#&gt; 7     3.50          V   42       1     2</span></span>
<span><span class="co">#&gt; 8     3.50          V   48       1     2</span></span>
<span><span class="co">#&gt; 9     6.50          P   30       1     3</span></span>
<span><span class="co">#&gt; 10    4.50          P   36       1     3</span></span>
<span><span class="co">#&gt; 11    3.50          P   42       1     3</span></span>
<span><span class="co">#&gt; 12    2.50          P   48       1     3</span></span></code></pre></div>
<div class="section level3">
<h3 id="using-aov">Using <code>aov()</code><a class="anchor" aria-label="anchor" href="#using-aov"></a>
</h3>
<p>Because only one <code>Error()</code> term is allowed in
<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>, we can treat the block effect as fixed:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aov.meat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">Wbscore</span> <span class="op">~</span> <span class="va">tenderizer</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="va">tenderizer</span><span class="op">:</span><span class="va">time</span> <span class="op">+</span> <span class="va">carcass</span> <span class="op">+</span> <span class="fu">Error</span><span class="op">(</span><span class="va">roast</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">meatdata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov.meat</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Error: roast</span></span>
<span><span class="co">#&gt;            Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; tenderizer  2  20.72   10.36   190.0 1.1e-08 ***</span></span>
<span><span class="co">#&gt; carcass     5   3.90    0.78    14.3 0.00028 ***</span></span>
<span><span class="co">#&gt; Residuals  10   0.55    0.05                    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Error: Within</span></span>
<span><span class="co">#&gt;                 Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; time             3  170.1    56.7   656.6 &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; tenderizer:time  6    9.6     1.6    18.5 1.1e-10 ***</span></span>
<span><span class="co">#&gt; Residuals       45    3.9     0.1                    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p><strong>Notice how the ANOVA table is split up into the whole unit
error and the sub unit error. Which effects does this table tell us
about? Are there any that it does not explain?</strong></p>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="using-lme">Using <code>lme()</code><a class="anchor" aria-label="anchor" href="#using-lme"></a>
</h3>
<p>Using the <code><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme()</a></code> function, we are able to have multiple
random effects in our model. The notation looks slightly different but
we are able to essentially replicate our results from
<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>.</p>
<p><br></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span>
<span><span class="va">lme.meat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">Wbscore</span> <span class="op">~</span> <span class="va">tenderizer</span> <span class="op">*</span> <span class="va">time</span>,</span>
<span>                data <span class="op">=</span> <span class="va">meatdata</span>,</span>
<span>                correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corCompSymm.html" class="external-link">corCompSymm</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># To make results same as aov()</span></span>
<span>                random <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">carcass</span><span class="op">/</span><span class="va">roast</span><span class="op">)</span></span></code></pre></div>
<p>The first row of the ANOVA table is for the (Intercept) term, which
we can ignore here (hence the <code>[-1,]</code> indexing
operation):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">lme.meat</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;                 numDF denDF F-value p-value</span></span>
<span><span class="co">#&gt; tenderizer          2    10   190.0  &lt;.0001</span></span>
<span><span class="co">#&gt; time                3    45   656.6  &lt;.0001</span></span>
<span><span class="co">#&gt; tenderizer:time     6    45    18.5  &lt;.0001</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exploring-the-interaction">Exploring the interaction<a class="anchor" aria-label="anchor" href="#exploring-the-interaction"></a>
</h3>
<p>Is the time effect significant for each level of tenderizer?</p>
<p>Similar to a few labs ago, we can create subsetted ANOVAs to look at
the effect of one variable across multiple levels of another.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lme.meatP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">Wbscore</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">meatdata</span>,</span>
<span>                 random <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">carcass</span><span class="op">/</span><span class="va">roast</span>, </span>
<span>                 correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corCompSymm.html" class="external-link">corCompSymm</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 subset <span class="op">=</span> <span class="va">tenderizer</span><span class="op">==</span><span class="st">"P"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">lme.meatP</span>, Terms <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="co">#&gt; F-test for: time </span></span>
<span><span class="co">#&gt;   numDF denDF F-value p-value</span></span>
<span><span class="co">#&gt; 1     3    15   126.7  &lt;.0001</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lme.meatV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">Wbscore</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">meatdata</span>,</span>
<span>                 random <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">carcass</span><span class="op">/</span><span class="va">roast</span>, </span>
<span>                 correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corCompSymm.html" class="external-link">corCompSymm</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 subset <span class="op">=</span> <span class="va">tenderizer</span><span class="op">==</span><span class="st">"V"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">lme.meatV</span>, Terms <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="co">#&gt; F-test for: time </span></span>
<span><span class="co">#&gt;   numDF denDF F-value p-value</span></span>
<span><span class="co">#&gt; 1     3    15   274.7  &lt;.0001</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lme.meatC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">Wbscore</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">meatdata</span>, </span>
<span>                 random <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">carcass</span><span class="op">/</span><span class="va">roast</span>, </span>
<span>                 correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corCompSymm.html" class="external-link">corCompSymm</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 subset <span class="op">=</span> <span class="va">tenderizer</span><span class="op">==</span><span class="st">"C"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">lme.meatC</span>, Terms <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="co">#&gt; F-test for: time </span></span>
<span><span class="co">#&gt;   numDF denDF F-value p-value</span></span>
<span><span class="co">#&gt; 1     3    15   305.7  &lt;.0001</span></span></code></pre></div>
<p>Yes it is.</p>
</div>
<div class="section level3">
<h3 id="multiple-comparisons-using-glht-package-multcomp">Multiple comparisons using <code>glht()</code> (package
<code>multcomp</code>)<a class="anchor" aria-label="anchor" href="#multiple-comparisons-using-glht-package-multcomp"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org" class="external-link">multcomp</a></span><span class="op">)</span></span>
<span><span class="va">mcP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">glht</a></span><span class="op">(</span><span class="va">lme.meatP</span>, linfct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">mcp</a></span><span class="op">(</span>time<span class="op">=</span><span class="st">"Tukey"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mcP</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simultaneous Tests for General Linear Hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multiple Comparisons of Means: Tukey Contrasts</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fit: lme.formula(fixed = Wbscore ~ time, data = meatdata, random = ~1 | </span></span>
<span><span class="co">#&gt;     carcass/roast, correlation = corCompSymm(), subset = tenderizer == </span></span>
<span><span class="co">#&gt;     "P")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Hypotheses:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; 36 - 30 == 0    -1.25       0.18   -6.94   &lt;1e-07 ***</span></span>
<span><span class="co">#&gt; 42 - 30 == 0    -2.33       0.18  -12.96   &lt;1e-07 ***</span></span>
<span><span class="co">#&gt; 48 - 30 == 0    -3.33       0.18  -18.52   &lt;1e-07 ***</span></span>
<span><span class="co">#&gt; 42 - 36 == 0    -1.08       0.18   -6.02   &lt;1e-07 ***</span></span>
<span><span class="co">#&gt; 48 - 36 == 0    -2.08       0.18  -11.57   &lt;1e-07 ***</span></span>
<span><span class="co">#&gt; 48 - 42 == 0    -1.00       0.18   -5.55   &lt;1e-07 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; (Adjusted p values reported -- single-step method)</span></span></code></pre></div>
<p>We can also easily plot the differences between cooking times for “P”
tenderizer (and for the other 2 levels of tenderizer as well)</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mcP</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab10_split_plot_files/figure-html/unnamed-chunk-11-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h2>
<p>A Nested-and-Crossed Design is similar to a Split-Plot but without
the block. Here we have a study where sweet potato yield is measured in
response to
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">a=3</annotation></semantics></math>)
types of herbicide. Each herbicide is applied to 5 fields. Each field is
divided into 4 plots where each plot is treated with one of
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">b=4</annotation></semantics></math>)
fertilizers.</p>
<p>The data can be accessed using:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rushinglab.github.io/FANR6750">FANR6750</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"yielddata"</span><span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Conduct the appropriate ANOVA using both the <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>
and <code><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme()</a></code> functions (1 pt).</p></li>
<li><p>Give the appropriate additive model (this will be slightly
different than the one for the split-plot design, since there is no
blocking) and define each term. What are the associated null and
alternative hypotheses? (1 pt)</p></li>
<li><p>Does the effect of herbicide depend on fertilizer? (1
pt)</p></li>
<li><p>Use Tukey’s test to determine which fertilizers differ (1
pt)</p></li>
</ol>
<p>Put your answers in an R Markdown report. Your report should
include:</p>
<ol style="list-style-type: decimal">
<li><p>A well-formatted ANOVA table (with header) (1 pt); and</p></li>
<li><p>A publication-quality plot (or plots) of the estimated effect of
herbicide and fertilizer on yield. Because we have not talked in class
about estimating SE for this type of study, you can simply create a plot
of the point estimates without error bars. The figure should also have a
descriptive caption and any aesthetics (color, line type, etc.) should
be clearly defined (1 pt)</p></li>
</ol>
<p>You may format the report however you like but it should be
well-organized, with relevant headers, plain text, and the elements
described above.</p>
<p>As always:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Be sure to include your first and last name in the
<code>author</code> section</p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so we can see both your code and the output</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
